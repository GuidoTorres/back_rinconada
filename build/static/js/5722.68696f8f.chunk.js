"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[5722],{69967:function(e,a,n){n(72791);var t=n(49998),o=n(80184);a.Z=function(e){var a=e.className,n=e.title,r=e.open,i=e.width,c=e.closeModal,s=e.children;return(0,o.jsx)(t.Z,{destroyOnClose:!0,className:a,title:n,open:r,centered:!0,onCancel:c,footer:null,width:i,children:s})}},34287:function(e,a,n){n.r(a),n.d(a,{default:function(){return V}});var t=n(74165),o=n(15861),r=n(29439),i=n(66106),c=n(30914),s=n(34664),d=n(72791),l=n(78820),u=n(38411),f=n(53939),p=n(99763),m=n(64941),h=n(76487),b=n(83188),v=n(1413),_=n(59274),g=n(43513),Z=(n(51279),n(80184)),j=function(e){var a=e.columns,n=e.table,t=e.filas,o=a.map((function(e){return{title:e.name,dataIndex:"incentivo"===e.id?"teletrans":e.id,key:"incentivo"===e.id?"teletrans":e.id}})),r=n.map((function(e){var a=!1;return e.trabajadores.length<2&&(a=!0),(0,v.Z)((0,v.Z)({},e),{},{disabled:a})}));return(0,Z.jsx)("div",{className:"table-container",children:(0,Z.jsx)(g.ZP,{size:"small",columns:a,data:r,pagination:!0,striped:!0,highlightOnHover:!0,responsive:!0,paginationComponentOptions:{rowsPerPageText:"Filas por p\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!1,selectAllRowsItemText:"Todos"},paginationPerPage:t||8,paginationRowsPerPageOptions:[8,16,24,32,40],expandableRows:!0,expandableRowsComponent:function(e){var a=e.data;return(0,Z.jsx)(_.Z,{style:{border:"1px solid #B7EB8F"},size:"small",columns:o.filter((function(e){return"fecha_pago"!==e.key&&"observacion"!==e.key})),dataSource:a.trabajadores.map((function(e,a){return{key:a,Nro:a+1,incentivo:e.teletrans||"---",nombres:e.nombre||"---",teletrans:e.teletrans||"---",telefono:e.telefono||"---",dni:e.dni||"---",cargo:e.cargo||"---",area:e.area||"---"}})),pagination:!1})},expandableRowDisabled:function(e){return e.disabled}})})},x=n(4942),w=n(17615),y=n(83099),T=n(87309),D=n(16026),F=n(69967),E=n(63998),S=n(97892),C=n.n(S),M=n(93433),k=n(53655),Y=n(77128),z=n(80458),I=n(49389),P=n(58848),N=n(68588),q=n(36473),R=n(78792),O=n(2964),L=n(35790);var A=function(e){var a=e.open,n=e.closeModal,s=e.trabajadores,f=e.actualizarTabla,m=e.closeModalSubmit,h=void 0===m?function(){}:m,b=e.dataToEdit,_=e.setDataToEdit,g=void 0===_?function(){}:_,j=w.Z.useForm(),E=(0,r.Z)(j,1)[0],S=k.Z.Text,A=(0,d.useContext)(u.s),B=A.updateData,V=A.createData,J=(0,d.useState)(!1),G=(0,r.Z)(J,2),H=G[0],K=G[1],X=s.map((function(e){return{value:e.id,label:e.nombre}})),Q=(0,d.useState)([]),U=(0,r.Z)(Q,2),W=U[0],$=U[1],ee=(0,d.useState)([]),ae=(0,r.Z)(ee,2),ne=ae[0],te=ae[1];(0,d.useEffect)((function(){var e=s.filter((function(e){return W.includes(e.id)}));te(e)}),[W]);var oe=(0,d.useState)(D.XK),re=(0,r.Z)(oe,2),ie=re[0],ce=re[1],se=function(e,a){if(!a&&e.target){var n=e.target,t=n.name,o=n.value;E.setFieldsValue((0,x.Z)({},t,o)),ce((function(e){return(0,v.Z)((0,v.Z)({},e),{},(0,x.Z)({},t,o))}))}else E.setFieldsValue((0,x.Z)({},a,e)),ce((function(n){return(0,v.Z)((0,v.Z)({},n),{},(0,x.Z)({},a,e))}))},de=(0,d.useState)([]),le=(0,r.Z)(de,2),ue=le[0],fe=le[1];(0,d.useEffect)((function(){var e=ne.map((function(e){return{nombre:e.nombre,contrato_id:e.contrato_id,teletrans:e.teletrans||"",trabajador_dni:e.dni}}));fe(b?ie.trabajadores.map((function(e){return(0,v.Z)((0,v.Z)({},e),{},{teletrans:parseFloat(e.teletrans)})})):e)}),[ne]);var pe=function(){var e=0;return ue.forEach((function(a){e+=a.teletrans})),e},me=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var a,n,o,r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="pago/programacion/multiple",K(!0),n={observacion:ie.observacion,fecha_pago:C()(ie.fecha_pago).format("YYYY-MM-DD")||"",teletrans:pe(),tipo:"incentivo",trabajadores:ue.map((function(e){return{contrato_id:e.contrato_id,teletrans:e.teletrans,trabajador_dni:e.trabajador_dni}}))},!b){e.next=10;break}return e.next=6,B(n,ie.pago_id,"pago/multiple");case 6:(o=e.sent)&&((0,p.q)(o.status,o.msg),f(),he()),e.next=14;break;case 10:return e.next=12,V(n,a);case 12:(r=e.sent)&&((0,p.q)(r.status,r.msg),f(),he());case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){b&&(ce((0,v.Z)((0,v.Z)({},b),{},{fecha_pago:C()(b.fecha_pago).format("YYYY-MM-DD")})),$(b.trabajadores.map((function(e){return e.nombre}))),fe(b.trabajadores))}),[b]);var he=function(){g(null),n(),h()};return(0,Z.jsx)(F.Z,{open:a,closeModal:b?he:n,title:"Juntar Teletrans",width:800,children:(0,Z.jsxs)(w.Z,{form:E,className:"modal-body",onFinish:me,layout:"vertical",children:[(0,Z.jsx)(Y.Z,{orientation:"left",children:"Datos"}),(0,Z.jsxs)(y.Z,{direction:"vertical",style:{width:"100%"},children:[(0,Z.jsx)(w.Z.Item,{label:"Seleccione trabajadores",children:(0,Z.jsx)(z.Z,{showSearch:!0,mode:"multiple",placeholder:"Seleccione trabajadores",style:{width:"100%"},allowClear:!0,value:W,onChange:function(e){$(e)},options:X,disabled:!!b,filterOption:function(e,a){return a.label.toLowerCase().indexOf(e.toLowerCase())>=0}})}),(0,Z.jsx)(w.Z.Item,{label:"Observaci\xf3n",children:(0,Z.jsx)(I.Z.TextArea,{autoSize:!0,name:"observacion",value:ie.observacion,placeholder:"Observaci\xf3n",onChange:function(e){return se(e)}})}),(0,Z.jsx)(w.Z.Item,{label:"Fecha",children:(0,Z.jsx)(P.ZP,{locale:L.Z,children:(0,Z.jsx)(N.Z,{allowClear:!1,value:C()(ie.fecha_pago),name:"fecha_pago",placeholder:"Fecha de Pago",picker:"day",onChange:function(e){return se(e,"fecha_pago")},style:{width:"100%"},format:"YYYY-MM-DD"})})})]}),(0,Z.jsx)(Y.Z,{orientation:"left",children:"Trabajadores"}),(0,Z.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:(0,Z.jsxs)(q.Z,{style:{width:"100%"},children:[(0,Z.jsx)(R.ZP,{itemLayout:"horizontal",dataSource:ue,renderItem:function(e){return(0,Z.jsx)(R.ZP.Item,{children:(0,Z.jsxs)(i.Z,{style:{width:"100%"},children:[(0,Z.jsx)(c.Z,{span:18,children:(0,Z.jsx)(y.Z,{direction:"vertical",children:e.nombre})}),(0,Z.jsx)(c.Z,{span:6,children:(0,Z.jsx)(y.Z,{direction:"vertical",children:(0,Z.jsx)(I.Z,{value:e.teletrans,placeholder:"Teletrans",type:"number",min:0,onChange:function(a){return function(e,a){var n=ue.findIndex((function(e){return e.contrato_id===a}));ue[n]=(0,v.Z)((0,v.Z)({},ue[n]),{},{teletrans:parseFloat(e.target.value)}),fe((0,M.Z)(ue))}(a,e.contrato_id)},required:!0})})})]},e.contrato_id)})}}),(0,Z.jsxs)(y.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end",alignItems:"center",padding:24},children:[(0,Z.jsx)(S,{type:pe()%4===0?"success":"danger",children:"TOTAL DE TELETRANS"}),(0,Z.jsx)(O.Z,{message:pe(),type:pe()%4===0?"success":"error"})]})]})}),(0,Z.jsxs)(y.Z,{direction:"horizontal",style:{width:"100%",marginTop:20,justifyContent:"end"},children:[(0,Z.jsx)(T.ZP,{onClick:n,children:"Cancelar"}),(0,Z.jsx)(T.ZP,{type:"primary",htmlType:"submit",icon:(0,Z.jsx)(l.lFz,{}),loading:!!H,disabled:0===ue.length,children:"Registrar"})]})]})})};var B=function(e){var a=e.actualizarTabla,n=e.modal,i=e.setModal,c=w.Z.useForm(),s=(0,r.Z)(c,1)[0],f=(0,d.useContext)(u.s),h=f.createData,b=f.getData,_=f.setDataToEdit,g=f.dataToEdit,j=f.updateData,S=(0,d.useState)(D.Tc),M=(0,r.Z)(S,2),k=M[0],Y=M[1],z=(0,d.useState)(!1),I=(0,r.Z)(z,2),P=I[0],N=I[1],q=(0,d.useState)([]),R=(0,r.Z)(q,2),O=R[0],L=R[1],B=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("incentivo/trabajadores");case 2:a=e.sent,L(a.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){B()}),[]),(0,d.useEffect)((function(){g?(Y((0,v.Z)((0,v.Z)({},g),{},{nombre:g.trabajadores[0].nombre,teletrans:parseFloat(g.trabajadores[0].teletrans),observacion:g.observacion,fecha_pago:C()(g.fecha_pago).format("YYYY-MM-DD")})),s.setFieldsValue((0,v.Z)((0,v.Z)({},g),{},{nombre:g.trabajadores[0].nombre,teletrans:parseFloat(g.trabajadores[0].teletrans),observacion:g.observacion,fecha_pago:C()(g.fecha_pago).format("YYYY-MM-DD")}))):Y(D.Tc)}),[g]);var V=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var n,o,r,i,c;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="pago/programacion/multiple",N(!0),o=[{contrato_id:k.contrato_id||"",teletrans:parseFloat(k.teletrans)||0,trabajador_dni:k.trabajador_dni}],r={observacion:k.observacion||"",fecha_pago:C()(k.fecha_pago).format("YYYY-MM-DD")||"",tipo:k.tipo||"incentivo",teletrans:parseFloat(k.teletrans)||0,trabajadores:o},!g){e.next=11;break}return e.next=7,j(r,g.pago_id,"pago");case 7:(i=e.sent)&&((0,p.q)(i.status,i.msg),a(),J()),e.next=15;break;case 11:return e.next=13,h(r,n);case 13:(c=e.sent)&&((0,p.q)(c.status,c.msg),a(),J());case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){i(!1),_(null),N(!1),Y(D.Tc)},G=(0,E.gG)(k,(function(e,a){if(!a&&e.target){var n=e.target,t=n.name,o=n.value;s.setFieldsValue((0,x.Z)({},t,o)),Y((function(e){return(0,v.Z)((0,v.Z)({},e),{},(0,x.Z)({},t,o))}))}else s.setFieldsValue((0,x.Z)({},a,e)),Y((function(n){return(0,v.Z)((0,v.Z)({},n),{},(0,x.Z)({},a,e))}))}),O,g),H=(0,d.useState)(!1),K=(0,r.Z)(H,2),X=K[0],Q=K[1];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(F.Z,{className:"modal-usuario",title:g?"Editar incentivo":"Registrar incentivo",open:n,width:400,closeModal:J,children:[!g&&(0,Z.jsx)(y.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end"},children:(0,Z.jsx)(m.Z,{title:"Juntar Teletrans",onClick:function(){Q(!0)},icon:(0,Z.jsx)(l.FDz,{})})}),(0,Z.jsxs)(w.Z,{form:s,className:"modal-body",onFinish:V,layout:"horizontal",children:[G.map((function(e,a){return(0,Z.jsx)(w.Z.Item,{className:e.className,name:e.name,rules:e.rules,style:{marginBottom:"8px"},children:(0,Z.jsxs)(Z.Fragment,{children:[e.label,e.type]})},a)})),(0,Z.jsx)(w.Z.Item,{className:"button-container",children:(0,Z.jsx)(T.ZP,{htmlType:"submit",icon:(0,Z.jsx)(l.lFz,{}),loading:!!P,children:g?"Editar":"Registrar"})})]})]}),X&&(0,Z.jsx)(A,{open:X,closeModal:function(){Q(!1)},trabajadores:O,actualizarTabla:a,closeModalSubmit:J})]})},V=function(){var e=(0,d.useContext)(u.s),a=e.getData,n=e.dataToEdit,v=e.setDataToEdit,_=e.deleteData,g=(0,d.useState)(!1),x=(0,r.Z)(g,2),w=x[0],y=x[1],T=(0,d.useState)(!1),D=(0,r.Z)(T,2),F=D[0],E=D[1],S=(0,d.useState)([]),C=(0,r.Z)(S,2),M=C[0],k=C[1],Y=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var n,o;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("incentivo");case 2:(n=e.sent)&&(o=n.data.filter((function(e){return null!==e})),k(o),y(!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=(0,d.useState)([]),I=(0,r.Z)(z,2),P=I[0],N=I[1],q=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("incentivo/trabajadores");case 2:n=e.sent,N(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){Y(),q()}),[]);var R=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(a){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("pago",a);case 2:(n=e.sent)&&((0,p.q)(n.status,n.msg),Y());case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),O=(0,f.Oh)((function(e){e.trabajadores.length>1?H(!0):E(!0),v(e)}),R),L=(0,d.useState)(!1),V=(0,r.Z)(L,2),J=V[0],G=V[1],H=function(){G(!0)};return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(b.Z,{text:"Incentivos",ruta:"/planilla"}),(0,Z.jsxs)("div",{className:"margenes",children:[(0,Z.jsxs)(i.Z,{align:"middle",children:[(0,Z.jsx)(c.Z,{span:18}),(0,Z.jsx)(c.Z,{span:6,align:"end",children:(0,Z.jsx)(m.Z,{title:"Crear incentivo",onClick:function(){return E(!0)},icon:(0,Z.jsx)(l.lFz,{})})})]}),(null===M||void 0===M?void 0:M.length)>0?(0,Z.jsx)(j,{columns:O,table:M}):(0,Z.jsx)(Z.Fragment,{children:w?(0,Z.jsx)(h.Z,{}):(0,Z.jsx)(s.Z,{image:s.Z.PRESENTED_IMAGE_SIMPLE,description:(0,Z.jsx)("span",{children:"No hay registros para mostrar."})})})]}),F&&(0,Z.jsx)(B,{actualizarTabla:Y,modal:F,setModal:E}),J&&(0,Z.jsx)(A,{closeModal:function(){G(!1)},open:J,actualizarTabla:Y,dataToEdit:n,setDataToEdit:v,trabajadores:P})]})}},16026:function(e,a,n){n.d(a,{Bq:function(){return m},FH:function(){return o},FN:function(){return t},JL:function(){return r},LR:function(){return d},Md:function(){return u},Oj:function(){return i},TT:function(){return b},Tc:function(){return v},XK:function(){return _},bf:function(){return x},cB:function(){return Z},d_:function(){return l},eJ:function(){return s},eT:function(){return g},g5:function(){return c},kb:function(){return p},n4:function(){return j},s:function(){return f},v2:function(){return h}});var t={nombre:"",usuario:"",contrasenia:"",estado:""},o={nombre:""},r={nombre:"",direccion:""},i=function(){return{dni:"",codigo_trabajador:"",fecha_nacimiento:"",telefono:"",nombre:"",apellido_paterno:"",apellido_materno:"",email:"",estado_civil:"",genero:"",direccion:"",asociacion_id:null,eliminar:!1}},c=function(e){return{fecha_evaluacion:"",capacitacion_sso:"",capacitacion_gema:"",evaluacion_laboral:"",presion_arterial:"",temperatura:"",saturacion:"",imc:"",pulso:"",diabetes:"",antecedentes:"",emo:"",trabajador_id:e.dni,aprobado:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",fiscalizador:"",fiscalizador_aprobado:"no",control:"no",topico:"no",seguridad:"no",medio_ambiente:"no",recursos_humanos:"no",topico_observacion:"",control_observacion:"",seguridad_observacion:"",medio_ambiente_observacion:"",recursos_humanos_observacion:"",finalizado:!1,gerencia_id:"",area_id:"",puesto_id:"",campamento_id:""}},s=function(e,a){var n;return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",asociacion_id:e&&(null===e||void 0===e?void 0:e.id),estado:!1,evaluacion_id:a,trabajadores:null===e||void 0===e||null===(n=e.trabajador)||void 0===n?void 0:n.map((function(e){return e.dni})),tareo:""}},d=function(e){return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia:"",area:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto:"",estado:!1,empresa_id:e}},l=function(e){return{sucursal_id:e,fecha:"",movimiento:"",forma_pago:"",encargado:"",area:"",cantidad:"",medida:"",descripcion:"",monto:"",proveedor:"",comprobante:"",dni:"",sucursal_transferencia:"",precio:""}},u={nombre:""},f={nombre:"",codigo:"",descripcion:"",saldo_inicial:""},p={nombre:"",codigo:"",descripcion:""},m=function(e,a){return{codigo:parseInt(a)+1,nombre:"",codigo_interno:"",codigo_barras:"",descripcion:"",categoria_id:"",unidad_id:"",precio:"",fecha:"",observacion:"",almacen_id:"",stock:"0",costo_total:""}},h=function(e){return{codigo:"",motivo:"",fecha:"",encargado:"",codigo_compra:"",boleta:"",codigo_requerimiento:"",producto_id:"",categoria:"",cantidad:"",unidad:"",tipo:e,producto:"",almacen_id:"",codigo_pedido:"",costo:"",dni:"",costo_total:"",area_id:"",personal:"",retornable:""}},b=function(e,a){return{codigo:"",fecha_pedido:"",fecha_entrega:"",solicitante:"",area:"",celular:"",proyecto:"",producto_id:"",cantidad:"",unidad:"",estado:"",producto:"",personal:"",dni:""}},v=function(){return{id:"",nombre:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajador_dni:""}},_=function(){return{id:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajadores:[]}},g=function(){return{id:"",razon_social:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"casa"}},Z=function(){return{id:"",nombre:"",trabajador_dni:"",observacion:"",fecha_pago:new Date,hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:"",tipo:"extraordinario"}},j=function(){return{id:"",hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:""}},x=function(){return{id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"asociacion",contrato_id:"",asociacion:[]}}}}]);
//# sourceMappingURL=5722.68696f8f.chunk.js.map