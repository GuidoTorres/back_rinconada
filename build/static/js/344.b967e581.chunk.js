"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[344],{79344:function(e,t,a){a.r(t),a.d(t,{default:function(){return L}});var n=a(74165),r=a(15861),o=a(29439),s=a(66106),i=a(30914),c=a(34664),l=a(72791),u=a(78820),d=a(38411),f=a(53939),p=a(99763),Z=a(64941),h=a(76487),m=a(83188),x=a(98355),g=a(93433),j=a(1413),v=a(4942),b=a(17615),y=a(53655),T=a(77128),_=a(83099),D=a(80458),w=a(49389),E=a(58848),F=a(68588),Y=a(36473),M=a(78792),C=a(2964),S=a(87309),k=a(97892),z=a.n(k),P=a(35790),I=a(16026),N=a(69967),q=a(80184);var R=function(e){var t=e.open,a=e.closeModal,c=e.trabajadores,f=e.actualizarTabla,Z=e.closeModalSubmit,h=void 0===Z?function(){}:Z,m=e.dataToEdit,x=e.setDataToEdit,k=void 0===x?function(){}:x,R=b.Z.useForm(),V=(0,o.Z)(R,1)[0],A=y.Z.Text,L=(0,l.useContext)(d.s),O=L.updateData,J=L.createData,B=L.cargando,G=L.setCargando,K=c.map((function(e){return{value:e.contrato_id,label:e.nombre}})),X=(0,l.useState)([]),H=(0,o.Z)(X,2),Q=H[0],U=H[1],W=(0,l.useState)([]),$=(0,o.Z)(W,2),ee=$[0],te=$[1];(0,l.useEffect)((function(){if(Q.length>0){var e=c.filter((function(e){return Q.includes(e.contrato_id)}));te(e)}}),[Q]);var ae=(0,l.useState)(I.XK),ne=(0,o.Z)(ae,2),re=ne[0],oe=ne[1],se=function(e,t){if(!t&&e.target){var a=e.target,n=a.name,r=a.value;V.setFieldsValue((0,v.Z)({},n,r)),oe((function(e){return(0,j.Z)((0,j.Z)({},e),{},(0,v.Z)({},n,r))}))}else V.setFieldsValue((0,v.Z)({},t,e)),oe((function(a){return(0,j.Z)((0,j.Z)({},a),{},(0,v.Z)({},t,e))}))},ie=(0,l.useState)([]),ce=(0,o.Z)(ie,2),le=ce[0],ue=ce[1];(0,l.useEffect)((function(){if(ee.length>0){var e=ee.map((function(e){return{nombre:e.nombre,contrato_id:e.contrato_id,teletrans:e.teletrans||""}}));ue(m?re.trabajadores.map((function(e){return(0,j.Z)((0,j.Z)({},e),{},{teletrans:parseFloat(e.teletrans)})})):e)}}),[ee]);var de=function(){var e=0;return le.forEach((function(t){e+=t.teletrans})),e},fe=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,a,r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="pago/programacion/multiple",G(!0),a={observacion:re.observacion,fecha_pago:z()(re.fecha_pago).format("YYYY-MM-DD")||"",teletrans:de(),tipo:"pago",trabajadores:le.map((function(e){return{contrato_id:e.contrato_id,teletrans:e.teletrans}}))},!m){e.next=10;break}return e.next=6,O(a,re.pago_id,"pago/multiple");case 6:(r=e.sent)&&((0,p.q)(r.status,r.msg),f(),pe()),e.next=14;break;case 10:return e.next=12,J(a,t);case 12:(o=e.sent)&&((0,p.q)(o.status,o.msg),f(),pe());case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){m&&(oe((0,j.Z)((0,j.Z)({},m),{},{fecha_pago:z()(m.fecha_pago).format("YYYY-MM-DD")})),U(m.trabajadores.map((function(e){return e.contrato_id}))),ue(m.trabajadores))}),[m]);var pe=function(){k(null),a(),h()};return(0,q.jsx)(N.Z,{open:t,closeModal:m?pe:a,title:"Juntar Teletrans",width:800,children:(0,q.jsxs)(b.Z,{form:V,className:"modal-body",onFinish:fe,layout:"vertical",children:[(0,q.jsx)(T.Z,{orientation:"left",children:"Datos"}),(0,q.jsxs)(_.Z,{direction:"vertical",style:{width:"100%"},children:[(0,q.jsx)(b.Z.Item,{label:"Seleccione trabajadores",children:(0,q.jsx)(D.Z,{mode:"multiple",placeholder:"Seleccione trabajadores",style:{width:"100%"},allowClear:!0,onChange:function(e){U(e)},options:K,disabled:!!m})}),(0,q.jsx)(b.Z.Item,{label:"Observaci\xf3n",children:(0,q.jsx)(w.Z,{name:"observacion",value:re.observacion,placeholder:"Observaci\xf3n",onChange:function(e){return se(e)}})}),(0,q.jsx)(b.Z.Item,{label:"Fecha",children:(0,q.jsx)(E.ZP,{locale:P.Z,children:(0,q.jsx)(F.Z,{allowClear:!1,value:z()(re.fecha_pago),name:"fecha_pago",placeholder:"Fecha de Pago",picker:"day",onChange:function(e){return se(e,"fecha_pago")},style:{width:"100%"},format:"YYYY-MM-DD"})})})]}),(0,q.jsx)(T.Z,{orientation:"left",children:"Trabajadores"}),(0,q.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:(0,q.jsxs)(Y.Z,{style:{width:"100%"},children:[(0,q.jsx)(M.ZP,{itemLayout:"horizontal",dataSource:le,renderItem:function(e){return(0,q.jsx)(M.ZP.Item,{children:(0,q.jsxs)(s.Z,{style:{width:"100%"},children:[(0,q.jsx)(i.Z,{span:18,children:(0,q.jsx)(_.Z,{direction:"vertical",children:e.nombre})}),(0,q.jsx)(i.Z,{span:6,children:(0,q.jsx)(_.Z,{direction:"vertical",children:(0,q.jsx)(w.Z,{value:e.teletrans,placeholder:"Teletrans",type:"number",min:0,onChange:function(t){return function(e,t){var a=le.findIndex((function(e){return e.contrato_id===t}));le[a]=(0,j.Z)((0,j.Z)({},le[a]),{},{teletrans:parseFloat(e.target.value)}),ue((0,g.Z)(le))}(t,e.contrato_id)},required:!0})})})]},e.contrato_id)})}}),(0,q.jsxs)(_.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end",alignItems:"center",padding:24},children:[(0,q.jsx)(A,{type:de()%4===0?"success":"danger",children:"TOTAL DE TELETRANS"}),(0,q.jsx)(C.Z,{message:de(),type:de()%4===0?"success":"error"})]})]})}),(0,q.jsxs)(_.Z,{direction:"horizontal",style:{width:"100%",marginTop:20,justifyContent:"end"},children:[(0,q.jsx)(S.ZP,{onClick:a,children:"Cancelar"}),(0,q.jsx)(S.ZP,{type:"primary",htmlType:"submit",icon:(0,q.jsx)(u.lFz,{}),loading:!!B,children:"Registrar"})]})]})})},V=a(63998);var A=function(e){var t=e.actualizarTabla,a=e.modal,s=e.setModal,i=b.Z.useForm(),c=(0,o.Z)(i,1)[0],f=(0,l.useContext)(d.s),h=f.createData,m=f.getData,x=f.cargando,g=f.setCargando,y=f.setDataToEdit,T=f.dataToEdit,D=f.updateData,w=(0,l.useState)(I.Tc),E=(0,o.Z)(w,2),F=E[0],Y=E[1],M=(0,l.useState)([]),C=(0,o.Z)(M,2),k=C[0],P=C[1],A=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("trabajador/aprobado");case 2:t=e.sent,P(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){A()}),[]),(0,l.useEffect)((function(){T?(Y((0,j.Z)((0,j.Z)({},T),{},{nombre:T.trabajadores[0].nombre,teletrans:parseFloat(T.trabajadores[0].teletrans),observacion:T.observacion,fecha_pago:z()(T.fecha_pago).format("YYYY-MM-DD")})),c.setFieldsValue((0,j.Z)((0,j.Z)({},T),{},{nombre:T.trabajadores[0].nombre,teletrans:parseFloat(T.trabajadores[0].teletrans),observacion:T.observacion,fecha_pago:z()(T.fecha_pago).format("YYYY-MM-DD")}))):Y(I.Tc)}),[T]);var L=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var a,r,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="pago/programacion",g(!0),r={contrato_id:F.contrato_id||"",observacion:F.observacion||"",fecha_pago:z()(F.fecha_pago).format("YYYY-MM-DD")||"",teletrans:parseFloat(F.teletrans)||0,tipo:"pago"},!T){e.next=10;break}return e.next=6,D(r,T.pago_id,"pago");case 6:(o=e.sent)&&((0,p.q)(o.status,o.msg),t(),O()),e.next=14;break;case 10:return e.next=12,h(r,a);case 12:(s=e.sent)&&((0,p.q)(s.status,s.msg),t(),O());case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){s(!1),y(null),g(!1),Y(I.Tc)},J=(0,V.PA)(F,(function(e,t){if(!t&&e.target){var a=e.target,n=a.name,r=a.value;c.setFieldsValue((0,v.Z)({},n,r)),Y((function(e){return(0,j.Z)((0,j.Z)({},e),{},(0,v.Z)({},n,r))}))}else c.setFieldsValue((0,v.Z)({},t,e)),Y((function(a){return(0,j.Z)((0,j.Z)({},a),{},(0,v.Z)({},t,e))}))}),k,T),B=(0,l.useState)(!1),G=(0,o.Z)(B,2),K=G[0],X=G[1];return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(N.Z,{className:"modal-usuario",title:T?"Editar programaci\xf3n":"Registrar programaci\xf3n",open:a,width:400,closeModal:O,children:[!T&&(0,q.jsx)(_.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end"},children:(0,q.jsx)(Z.Z,{title:"Juntar Teletrans",onClick:function(){X(!0)},icon:(0,q.jsx)(u.FDz,{})})}),(0,q.jsxs)(b.Z,{form:c,className:"modal-body",onFinish:L,layout:"horizontal",children:[J.map((function(e,t){return(0,q.jsx)(b.Z.Item,{className:e.className,name:e.name,rules:e.rules,style:{marginBottom:"8px"},children:(0,q.jsxs)(q.Fragment,{children:[e.label,e.type]})},t)})),(0,q.jsx)(b.Z.Item,{className:"button-container",children:(0,q.jsx)(S.ZP,{htmlType:"submit",icon:(0,q.jsx)(u.lFz,{}),loading:!!x,children:T?"Editar":"Registrar"})})]})]}),K&&(0,q.jsx)(R,{open:K,closeModal:function(){X(!1)},trabajadores:k,actualizarTabla:t,closeModalSubmit:O})]})},L=function(){var e=(0,l.useContext)(d.s),t=e.getData,a=e.dataToEdit,g=e.setDataToEdit,j=e.deleteData,v=(0,l.useState)(!1),b=(0,o.Z)(v,2),y=b[0],T=b[1],_=(0,l.useState)(!1),D=(0,o.Z)(_,2),w=D[0],E=D[1],F=(0,l.useState)([]),Y=(0,o.Z)(F,2),M=Y[0],C=Y[1],S=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var a,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("pago/individual/lista");case 2:(a=e.sent)&&(r=a.data.filter((function(e){return null!==e})),C(r),T(!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=(0,l.useState)([]),z=(0,o.Z)(k,2),P=z[0],I=z[1],N=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("incentivo/trabajadores");case 2:a=e.sent,I(a.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){S(),N()}),[]);var V=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("pago",t);case 2:(a=e.sent)&&((0,p.q)(a.status,a.msg),S());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=(0,f.Oh)((function(e){e.trabajadores.length>1?K(!0):E(!0),g(e)}),V),O=(0,l.useState)(!1),J=(0,o.Z)(O,2),B=J[0],G=J[1],K=function(){G(!0)};return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(m.Z,{text:"Programacion de pagos",ruta:"/pago"}),(0,q.jsxs)("div",{className:"margenes",children:[(0,q.jsxs)(s.Z,{align:"middle",children:[(0,q.jsx)(i.Z,{span:18}),(0,q.jsx)(i.Z,{span:6,align:"end",children:(0,q.jsx)(Z.Z,{title:"Programar pago",onClick:function(){return E(!0)},icon:(0,q.jsx)(u.lFz,{})})})]}),(null===M||void 0===M?void 0:M.length)>0?(0,q.jsx)(x.Z,{columns:L,table:M}):(0,q.jsx)(q.Fragment,{children:y?(0,q.jsx)(h.Z,{}):(0,q.jsx)(c.Z,{image:c.Z.PRESENTED_IMAGE_SIMPLE,description:(0,q.jsx)("span",{children:"No hay registros para mostrar."})})})]}),w&&(0,q.jsx)(A,{actualizarTabla:S,modal:w,setModal:E}),B&&(0,q.jsx)(R,{closeModal:function(){G(!1)},open:B,actualizarTabla:S,dataToEdit:a,setDataToEdit:g,trabajadores:P})]})}}}]);
//# sourceMappingURL=344.b967e581.chunk.js.map