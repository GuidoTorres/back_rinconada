"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[9433],{3396:function(t,a,e){e.r(a),e.d(a,{default:function(){return D}});var n=e(74165),r=e(15861),o=e(29439),i=e(72791),s=e(38411),c=e(83188),u=e(4808),l=e(22552),d=e(45180),f=e(4942),v=e(1413),p=e(69967),m=e(99763),Z=e(17615),x=e(87309),h=e(78820),j=e(63998),b=e(86281),g=(e(138),e(80184)),_=function(t){var a=t.actualizarTrabajadores,e=t.actualizarTabla,c=t.selected,u=t.trabajadorDni,l=t.data,d=Z.Z.useForm(),_=(0,o.Z)(d,1)[0],w="contrato",C=(0,i.useContext)(s.s),T=C.createData,E=C.updateData,S=C.getData,y=C.setDataToEdit,L=C.dataToEdit,D=C.modal3,k=C.setModal3,M=C.cargando,F=C.setCargando,N=(0,i.useState)([]),z=(0,o.Z)(N,2),q=z[0],I=z[1],P=(0,i.useState)([]),R=(0,o.Z)(P,2),B=R[0],V=R[1],A=(0,i.useState)([]),G=(0,o.Z)(A,2),H=G[0],O=G[1],U=(0,i.useState)([]),J=(0,o.Z)(U,2),K=J[0],Q=J[1],W=(0,i.useState)([]),X=(0,o.Z)(W,2),Y=(X[0],X[1],(0,i.useState)([])),$=(0,o.Z)(Y,2),tt=($[0],$[1]),at=(0,i.useState)(""),et=(0,o.Z)(at,2),nt=et[0],rt=et[1],ot=function(){var t=(0,r.Z)((0,n.Z)().mark((function t(){var a,e,r,o,i,s,c;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=S("cargo"),e=S("campamento"),r=S("gerencia"),o=S("area"),i=S("socio"),s=S("contrato/last/".concat(u)),t.next=8,Promise.all([a,e,r,o,i,s]);case 8:c=t.sent,I(c[0].data),V(c[1].data),O(c[2].data),Q(c[3].data),tt(c[4].data),rt(c[5].data);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),it={fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto_id:"",estado:!1,volquete:"",teletran:"",suspendido:!1,finalizado:!1,tareo:"",trabajador_id:u},st=(0,i.useState)(it),ct=(0,o.Z)(st,2),ut=ct[0],lt=ct[1];(0,i.useEffect)((function(){null===L&&lt((function(t){return(0,v.Z)((0,v.Z)({},t),{},{codigo_contrato:nt})}))}),[nt,L]),(0,i.useEffect)((function(){L?(lt(L),_.setFieldsValue(L)):lt(it)}),[L]),(0,i.useEffect)((function(){null===L&&l.evaluacion.length>0&&lt((function(t){return(0,v.Z)((0,v.Z)({},t),{},{gerencia_id:l.evaluacion.at(0).gerencia_id,area_id:l.evaluacion.at(0).area_id,puesto_id:l.evaluacion.at(0).puesto_id,campamento_id:l.evaluacion.at(0).campamento_id})}))}),[l,L]),(0,i.useEffect)((function(){ot()}),[]),(0,i.useEffect)((function(){if(""!==ut.fecha_inicio&&""!==ut.periodo_trabajo){var t=ut.fecha_inicio,a=(0,b.E)(t,ut.periodo_trabajo,ut.tareo);lt((function(t){return(0,v.Z)((0,v.Z)({},t),{},{fecha_fin:a})}))}else lt((function(t){return(0,v.Z)((0,v.Z)({},t),{},{fecha_fin:""})}))}),[ut.fecha_inicio,ut.periodo_trabajo,ut.tareo]);var dt=function(){var t=(0,r.Z)((0,n.Z)().mark((function t(){var r,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==L){t.next=6;break}return F(!0),t.next=4,T(ut,w);case 4:(r=t.sent)&&((0,m.q)(r.status,r.msg),ft(),e(),a(),F(!1));case 6:if(!L){t.next=12;break}return F(!0),t.next=10,E(ut,c.id,w);case 10:(o=t.sent)&&((0,m.q)(o.status,o.msg),ft(),e(),a(),F(!1));case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ft=function(){k(!1),y(null),lt(it),F(!1)},vt=(0,j.fp)(ut,(function(t,a){if(!a&&t.target){var e=t.target,n=e.name,r=e.value;_.setFieldsValue((0,f.Z)({},n,r)),lt((function(t){return(0,v.Z)((0,v.Z)({},t),{},(0,f.Z)({},n,r))}))}else _.setFieldsValue((0,f.Z)({},a,t)),lt((function(e){return(0,v.Z)((0,v.Z)({},e),{},(0,f.Z)({},a,t))}))}),q,B,H,K,nt,L);return(0,g.jsx)(p.Z,{className:"modal-contrato-empresa",title:L?"Editar contrato":"Registrar contrato",open:D,width:920,closeModal:ft,children:(0,g.jsxs)(Z.Z,{form:_,className:"modal-body",onFinish:dt,layout:"horizontal",children:[(0,g.jsx)("div",{className:"contrato",children:vt.splice(0,13).map((function(t,a){return(0,g.jsx)(Z.Z.Item,{className:"item",name:t.name,rules:t.rules,style:{marginBottom:"8px"},children:(0,g.jsxs)(g.Fragment,{children:[t.label,t.type]})},a)}))}),(0,g.jsx)("div",{className:"finalizacion",children:vt.map((function(t,a){return(0,g.jsx)(Z.Z.Item,{name:t.name,rules:t.rules,style:{marginBottom:"8px"},children:(0,g.jsxs)(g.Fragment,{children:[t.label,t.type]})},a)}))}),(0,g.jsx)(Z.Z.Item,{className:"button-container",children:(0,g.jsx)(x.ZP,{htmlType:"submit",icon:(0,g.jsx)(h.lFz,{}),loading:!!M,children:L?" Editar":" Registrar"})})]})})},w=e(53939),C=e(49389),T=(e(97434),C.Z.Search),E=function(t){var a=t.abrirModal,e=(t.registrar,t.data,t.setFilterText);return(0,g.jsxs)("div",{className:"personal-buscador",children:[(0,g.jsx)(T,{placeholder:"Ingresa un termino aqui...",onChange:function(t){return e(t.target.value)},style:{width:300}}),(0,g.jsx)("div",{className:"button-container",children:(0,g.jsx)(x.ZP,{onClick:function(){return a(!0)},children:"+ Registrar"})})]})},S=(e(95579),e(34664)),y=(e(81837),e(76487),function(t){var a=t.selected,e=t.actualizarTrabajadores,c=t.trabajador,l=t.data,d=(0,i.useContext)(s.s),f=d.getDataById,v=d.deleteData,Z=d.data1,x=d.setData1,h=d.setDataToEdit,j=d.modal2,b=d.setModal2,C=d.modal3,T=d.setModal3,y=(d.cargando,d.setCargando,(0,i.useState)([])),L=(0,o.Z)(y,2),D=L[0],k=L[1],M=(0,i.useState)(""),F=(0,o.Z)(M,2),N=F[0],z=F[1],q=(0,i.useState)(""),I=(0,o.Z)(q,2),P=I[0],R=I[1];console.log("===================================="),console.log(l),console.log("====================================");var B=function(){var t=(0,r.Z)((0,n.Z)().mark((function t(){var e,r,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"contrato",t.next=3,f("contrato",a);case 3:(e=t.sent)&&(o=null===(r=e.data)||void 0===r?void 0:r.map((function(t){return t.contratos})).flat(),x(o));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,i.useEffect)((function(){var t=Z&&Z.filter((function(t){var a,e,n,r,o,i,s,c;return(null===t||void 0===t||null===(a=t.fecha_inicio)||void 0===a||null===(e=a.split("T")[0])||void 0===e||null===(n=e.toLowerCase())||void 0===n?void 0:n.includes(N.toLowerCase()))||(null===t||void 0===t||null===(r=t.fecha_fin)||void 0===r||null===(o=r.split("T")[0])||void 0===o||null===(i=o.toLowerCase())||void 0===i?void 0:i.includes(N.toLowerCase()))||(null===t||void 0===t||null===(s=t.tipo_contrato)||void 0===s||null===(c=s.toLowerCase())||void 0===c?void 0:c.includes(N.toLowerCase()))})).flat();k(t)}),[N,Z]);var V=function(){var t=(0,r.Z)((0,n.Z)().mark((function t(a){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v("contrato",a.id);case 2:(r=t.sent)&&((0,m.q)(r.status,r.msg),A(),e());case 4:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}(),A=function(){b(!1),x([])};(0,i.useEffect)((function(){B()}),[]);var G=(0,w.lc)((function(t){h(t),T(!0),R(t)}),V);return(0,g.jsxs)(p.Z,{className:"modal-historial-evaluacion",title:"Historial de contratos",open:j,width:900,closeModal:A,children:[(0,g.jsx)("section",{className:"buscador",children:(0,g.jsx)(E,{abrirModal:T,registrar:!0,tipo:"contrato",data:l,setFilterText:z})}),Z.length>0?(0,g.jsx)(u.Z,{columns:G,table:D}):(0,g.jsx)(S.Z,{image:S.Z.PRESENTED_IMAGE_SIMPLE,description:(0,g.jsx)("span",{children:"No hay registros para mostrar."})}),C&&(0,g.jsx)(_,{actualizarTabla:B,selected:P,trabajadorDni:l.dni,actualizarTrabajadores:e,trabajador:c,idContrato:Z,data:l})]})}),L=e(1333),D=function(){var t=(0,i.useContext)(s.s),a=t.getData,e=t.deleteData,f=t.updateData,v=t.setDataToEdit,p=t.modal2,Z=t.setModal2,x=t.filterText,h=t.setFilterText,j=(0,i.useState)(""),b=(0,o.Z)(j,2),_=b[0],C=b[1],T=(0,i.useState)([]),E=(0,o.Z)(T,2),S=E[0],D=E[1],k=(0,i.useState)([]),M=(0,o.Z)(k,2),F=M[0],N=M[1],z=(0,i.useState)([]),q=(0,o.Z)(z,2),I=q[0],P=q[1],R=(0,i.useState)([]),B=(0,o.Z)(R,2),V=B[0],A=B[1],G=(0,i.useState)(!1),H=(0,o.Z)(G,2),O=H[0],U=H[1],J=(0,i.useState)(!1),K=(0,o.Z)(J,2),Q=K[0],W=K[1],X=function(){var t=(0,r.Z)((0,n.Z)().mark((function t(){var e;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a("trabajador");case 2:(e=t.sent)&&P(e.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Y=function(){var t=(0,r.Z)((0,n.Z)().mark((function t(a){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"trabajador",t.next=3,e("trabajador",a);case 3:(r=t.sent)&&((0,m.q)(r.status,r.msg),X());case 5:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}();(0,i.useEffect)((function(){var t=I&&I.filter((function(t){var a,e,n,r,o,i,s,c;return(null===t||void 0===t||null===(a=t.codigo_trabajador)||void 0===a||null===(e=a.toLowerCase())||void 0===e?void 0:e.includes(x.toLowerCase()))||(null===(n="".concat(null===t||void 0===t?void 0:t.nombre," ").concat(null===t||void 0===t?void 0:t.apellido_paterno," ").concat(null===t||void 0===t?void 0:t.apellido_materno))||void 0===n||null===(r=n.toLowerCase())||void 0===r?void 0:r.includes(x.toLowerCase()))||(null===t||void 0===t||null===(o=t.dni)||void 0===o||null===(i=o.toLowerCase())||void 0===i?void 0:i.includes(x.toLowerCase()))||(null===t||void 0===t||null===(s=t.campamento)||void 0===s||null===(c=s.toLowerCase())||void 0===c?void 0:c.includes(x.toLowerCase()))}));A(t)}),[x,I]),(0,i.useEffect)((function(){return function(){A([]),h("")}}),[]);var $=function(){var t=(0,r.Z)((0,n.Z)().mark((function t(a){var e;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"trabajador",t.next=3,f({deshabilitado:a.deshabilitado},a.dni,"trabajador");case 3:(e=t.sent)&&((0,m.q)(e.status,e.msg),X());case 5:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}();(0,i.useEffect)((function(){X()}),[]);var tt=(0,w.qC)((function(t){W(!0),C(t),D(t.evaluacion)}),(function(t){Z(!0),C(t.dni),N(t)}),$,(function(t){v(t),U(!0)}),Y);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.Z,{text:"Trabajadores",user:"Usuario",ruta:"/personal"}),(0,g.jsxs)("div",{className:"margenes",children:[(0,g.jsx)(l.Z,{abrirModal:U,importar:!0,registrar:!0,setFilterText:h}),(0,g.jsx)(u.Z,{columns:tt,table:V})]}),O&&(0,g.jsx)(d.Z,{actualizarTabla:X,data:I,modal:O,setModal:U}),Q&&(0,g.jsx)(L.Z,{selected:_,actualizarTrabajador:X,data:S,modal1:Q,setModal1:W}),p&&(0,g.jsx)(y,{selected:_,actualizarTrabajadores:X,data:F})]})}},95579:function(t,a,e){var n=e(72791),r=e(38411);a.Z=function(t){var a=(0,n.useContext)(r.s),e=a.filterText,o=(a.filterTextModal,a.result),i=a.setResult;return(0,n.useEffect)((function(){if(""!==e){var a=t.filter((function(t){return Object.values(t).join("").toLowerCase().includes(e.toLowerCase())}));i(a)}else i(t)}),[e,t]),{result:o}}}}]);
//# sourceMappingURL=9433.fccd0753.chunk.js.map