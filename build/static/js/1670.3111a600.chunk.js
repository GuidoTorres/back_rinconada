"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[1670],{69967:function(e,n,a){a(72791);var o=a(49998),t=a(80184);n.Z=function(e){var n=e.className,a=e.title,r=e.open,i=e.width,c=e.closeModal,s=e.children;return(0,t.jsx)(o.Z,{destroyOnClose:!0,className:n,title:a,open:r,centered:!0,onCancel:c,footer:null,width:i,children:s})}},28181:function(e,n,a){var o=a(74165),t=a(15861),r=a(29439),i=a(49389),c=a(87309),s=a(72791),d=a(38411),u=a(99763),l=a(69967),p=a(80184);n.Z=function(e){var n=e.modal,a=e.setModal,f=(e.getPlanilla,e.data),v=e.observacion,m=e.boton,h=(0,s.useContext)(d.s).updateData,_=(0,s.useState)(""),b=(0,r.Z)(_,2),g=b[0],Z=b[1],x=function(){a(!1)},j=function(){var e=(0,t.Z)((0,o.Z)().mark((function e(){var n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={observaciones:g},e.next=3,h(n,f.aprobacion_id,"aprobacion/observacion");case 3:(a=e.sent)&&((0,u.q)(a.status,a.msg),x());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,p.jsxs)(l.Z,{className:"modal-usuario",title:m?"Agregar Observaci\xf3n":"Observaci\xf3n RRHH",open:n,width:400,closeModal:x,children:[(0,p.jsx)(i.Z.TextArea,{showCount:!0,maxLength:255,defaultValue:null!==f&&void 0!==f&&f.observaciones?null===f||void 0===f?void 0:f.observaciones:v||"",style:{height:120,marginBottom:24,marginTop:15},onChange:function(e){Z(e.target.value)},placeholder:"Observaci\xf3n"}),(0,p.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingTop:"10px"},children:m&&(0,p.jsx)(c.ZP,{onClick:j,children:"Guardar"})})]})}},42871:function(e,n,a){a.r(n),a.d(n,{default:function(){return Y}});var o=a(4942),t=a(74165),r=a(1413),i=a(15861),c=a(29439),s=a(97892),d=a.n(s),u=a(72791),l=a(38411),p=(a(71368),a(53939)),f=a(99763),v=(a(64941),a(83188)),m=a(4808),h=a(28181),_=a(87309),b=a(49389),g=a(80184),Z=b.Z.Search,x=function(e){var n=e.setFilterText,a=e.setModal;return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,g.jsx)("div",{style:{width:"300px"},children:(0,g.jsx)(Z,{placeholder:"Ingresa un termino aqui...",onChange:function(e){return n(e.target.value)}})}),(0,g.jsx)("div",{children:(0,g.jsx)(_.ZP,{onClick:function(){a(!0)},style:{width:"150px"},children:"Pago Multiple"})})]})},j=a(93433),w=a(17615),C=a(53655),y=a(77128),S=a(83099),T=a(80458),q=a(58848),A=a(68588),D=a(36473),F=a(78792),M=a(66106),E=a(30914),O=a(2964),P=a(35790),N=a(16026),k=a(69967),I=a(78820);var R=function(e){var n=e.open,a=e.setModal,s=e.trabajadores,p=e.actualizarTabla,v=e.closeModalSubmit,m=void 0===v?function(){}:v,h=e.dataToEdit,Z=e.setDataToEdit,x=void 0===Z?function(){}:Z,R=w.Z.useForm(),Y=(0,c.Z)(R,1)[0],L=C.Z.Text,z=(0,u.useContext)(l.s),V=z.updateData,H=z.createData,B=z.cargando,J=z.setCargando,G=null===s||void 0===s?void 0:s.map((function(e){return{value:e.id,label:e.nombre}})),K=function(){a(!1)},X=(0,u.useState)([]),U=(0,c.Z)(X,2),W=U[0],Q=U[1],$=(0,u.useState)([]),ee=(0,c.Z)($,2),ne=ee[0],ae=ee[1];(0,u.useEffect)((function(){if(W.length>0){var e=s.filter((function(e){return W.includes(e.id)}));ae(e)}}),[W]);var oe=(0,u.useState)(N.XK),te=(0,c.Z)(oe,2),re=te[0],ie=te[1],ce=function(e,n){if(!n&&e.target){var a=e.target,t=a.name,i=a.value;Y.setFieldsValue((0,o.Z)({},t,i)),ie((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,o.Z)({},t,i))}))}else Y.setFieldsValue((0,o.Z)({},n,e)),ie((function(a){return(0,r.Z)((0,r.Z)({},a),{},(0,o.Z)({},n,e))}))},se=(0,u.useState)([]),de=(0,c.Z)(se,2),ue=de[0],le=de[1];(0,u.useEffect)((function(){if(ne.length>0){var e=ne.map((function(e){return{id:e.id,nombre:e.nombre,contrato_id:e.contrato_id,teletrans:e.teletrans||"",trabajador_dni:e.dni,quincena:e.quincena,saldoFinal:e.saldoFinal}}));le(h?re.trabajadores.map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{teletrans:parseFloat(e.teletrans)})})):e)}}),[ne]);var pe=function(){var e=0;return ue.forEach((function(n){e=parseFloat(e)+parseFloat(n.teletrans)})),e},fe=function(){var e=(0,i.Z)((0,t.Z)().mark((function e(){var n,a,o,r,i,c;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="pago/programacion/multiple",a={unidad_produccion:re.unidad_produccion,observacion:re.observacion,fecha_pago:d()(re.fecha_pago).format("YYYY-MM-DD")||"",teletrans:pe(),tipo:"pago",trabajadores:ue.map((function(e){return{contrato_id:e.contrato_id,volquetes:e.voqluetes,teletrans:e.teletrans,quincena:e.quincena,trabajador_dni:e.trabajador_dni,saldoFinal:e.saldoFinal}}))},o=!0,r=0,a.trabajadores.forEach((function(e){var n=Number(e.teletrans)||0;n>(Number(e.saldoFinal)||0)&&(o=!1),r+=n})),o){e.next=8;break}return(0,f.q)(500,"El pago a uno de los trabajadores es mayor a lo adeudado"),e.abrupt("return");case 8:if(4===r){e.next=11;break}return(0,f.q)(500,"La cantidad de teletrans debe ser equivalente a un volquete."),e.abrupt("return");case 11:if(!h){e.next=19;break}return J(!0),e.next=15,V(a,re.pago_id,"pago/multiple");case 15:(i=e.sent)&&((0,f.q)(i.status,i.msg),p(),ve()),e.next=23;break;case 19:return e.next=21,H(a,n);case 21:(c=e.sent)&&((0,f.q)(c.status,c.msg),p(),ve());case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){h&&(ie((0,r.Z)((0,r.Z)({},h),{},{fecha_pago:d()(h.fecha_pago).format("YYYY-MM-DD")})),Q(h.trabajadores.map((function(e){return e.id}))),le(h.trabajadores))}),[h]);var ve=function(){x(null),K(),m()};return(0,g.jsx)(k.Z,{open:n,closeModal:h?ve:K,title:"Juntar Teletrans",width:800,children:(0,g.jsxs)(w.Z,{form:Y,className:"modal-body",onFinish:fe,layout:"vertical",children:[(0,g.jsx)(y.Z,{orientation:"left",children:"Datos"}),(0,g.jsxs)(S.Z,{direction:"vertical",style:{width:"100%"},children:[(0,g.jsx)(w.Z.Item,{label:"Seleccione trabajadores",children:(0,g.jsx)(T.Z,{showSearch:!0,mode:"multiple",placeholder:"Seleccione trabajadores",style:{width:"100%"},allowClear:!0,value:W,onChange:function(e){Q(e)},options:G,disabled:!!h,filterOption:function(e,n){return n.label.toLowerCase().indexOf(e.toLowerCase())>=0}})}),(0,g.jsx)(w.Z.Item,{label:"Unidad de producci\xf3n",children:(0,g.jsx)(T.Z,{autoSize:!0,name:"unidad_produccion",dropdownMatchSelectWidth:!1,onChange:function(e){return ce(e,"unidad_produccion")},options:[{label:"ANA MAR\xcdAS",value:"ANA MAR\xcdAS"},{label:"SANTA MARIA",value:"SANTA MARIA"},{label:"CORAZ\xd3N DE SAN FRANCISCO",value:"CORAZ\xd3N DE SAN FRANCISCO"},{label:"SAPO DE ORO",value:"SAPO DE ORO"}]})}),(0,g.jsx)(w.Z.Item,{label:"Observaci\xf3n",children:(0,g.jsx)(b.Z,{name:"observacion",style:{width:"100%"},onChange:ce})}),(0,g.jsx)(w.Z.Item,{label:"Fecha",children:(0,g.jsx)(q.ZP,{locale:P.Z,children:(0,g.jsx)(A.Z,{allowClear:!1,value:d()(re.fecha_pago),name:"fecha_pago",placeholder:"Fecha de Pago",picker:"day",onChange:function(e){return ce(e,"fecha_pago")},style:{width:"100%"},format:"YYYY-MM-DD"})})})]}),(0,g.jsx)(y.Z,{orientation:"left",children:"Trabajadores"}),(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:(0,g.jsxs)(D.Z,{style:{width:"100%"},children:[(0,g.jsx)(F.ZP,{itemLayout:"horizontal",dataSource:ue,renderItem:function(e){return(0,g.jsx)(F.ZP.Item,{children:(0,g.jsxs)(M.Z,{style:{width:"100%"},children:[(0,g.jsx)(E.Z,{span:18,children:(0,g.jsx)(S.Z,{direction:"vertical",children:e.nombre})}),(0,g.jsx)(E.Z,{span:6,children:(0,g.jsx)(S.Z,{direction:"vertical",children:(0,g.jsx)(b.Z,{value:e.teletrans,placeholder:"Teletrans",type:"number",min:0,onChange:function(n){return function(e,n){var a=ue.findIndex((function(e){return e.id===n}));ue[a]=(0,r.Z)((0,r.Z)({},ue[a]),{},{teletrans:parseFloat(e.target.value)}),le((0,j.Z)(ue))}(n,e.id)},required:!0})})})]},e.id)})}}),(0,g.jsxs)(S.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end",alignItems:"center",padding:24},children:[(0,g.jsx)(L,{type:pe()%4===0?"success":"danger",children:"TOTAL DE TELETRANS"}),(0,g.jsx)(O.Z,{message:pe(),type:pe()%4===0?"success":"error"})]})]})}),(0,g.jsxs)(S.Z,{direction:"horizontal",style:{width:"100%",marginTop:20,justifyContent:"end"},children:[(0,g.jsx)(_.ZP,{onClick:K,children:"Cancelar"}),(0,g.jsx)(_.ZP,{type:"primary",htmlType:"submit",icon:(0,g.jsx)(I.lFz,{}),loading:!!B,disabled:0===ue.length,children:"Registrar"})]})]})})},Y=function(){var e=(0,u.useContext)(l.s),n=e.getData,a=(e.createData,(0,u.useState)([])),s=(0,c.Z)(a,2),f=s[0],_=s[1],b=(0,u.useState)(!1),Z=(0,c.Z)(b,2),j=Z[0],w=Z[1],C=(0,u.useState)(!1),y=(0,c.Z)(C,2),S=y[0],T=y[1],q=(0,u.useState)(""),A=(0,c.Z)(q,2),D=A[0],F=A[1],M=(0,u.useState)(!1),E=(0,c.Z)(M,2),O=(E[0],E[1]),P=(0,u.useState)([]),N=(0,c.Z)(P,2),k=(N[0],N[1],(0,u.useState)("")),I=(0,c.Z)(k,2),Y=I[0],L=I[1],z=(0,u.useState)([]),V=(0,c.Z)(z,2),H=V[0],B=V[1],J=(0,u.useState)([]),G=(0,c.Z)(J,2),K=G[0],X=G[1],U=function(){var e=(0,i.Z)((0,t.Z)().mark((function e(){var a,o,i;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n("programacion");case 2:(a=e.sent)&&(o=a.data.filter((function(e){return null!==e})),_(o),i=o.map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{initialTeletrans:e.teletrans,initialVolquetes:e.volquetes,fecha_pago:d()(new Date).format("YYYY-MM-DD")})})),_(i));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){U()}),[]);var W=function(){var e=(0,i.Z)((0,t.Z)().mark((function e(n){var a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={observacion:n.observacion,fecha_pago:n.fecha_pago,volquetes:n.initialVolquetes,teletrans:n.initialTeletrans,tipo:"pago",quincena:n.quincena,unidad_produccion:n.unidad_produccion,trabajadores:[{volquetes:n.initialVolquetes,teletrans:n.initialTeletrans,contrato_id:n.contrato_id,trabajador_dni:n.dni,quincena:n.quincena}]},console.log("===================================="),console.log(a),console.log("====================================");case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){var e=f&&f.filter((function(e){var n,a,o,t;return(null===e||void 0===e||null===(n=e.nombre)||void 0===n||null===(a=n.toLowerCase())||void 0===a?void 0:a.includes(Y.toLowerCase()))||(null===e||void 0===e||null===(o=e.cargo)||void 0===o||null===(t=o.toLowerCase())||void 0===t?void 0:t.includes(Y.toLowerCase()))}));B(e)}),[Y,f]);var Q=(0,p.lF)((function(e,n,a,t){var i;i=e.target&&e.target.value?e.target.value:e,_((function(e){return e.map((function(e,c){if(c===a){var s,d,u,l=(0,r.Z)((0,r.Z)({},e),{},{contrato_id:null===n||void 0===n?void 0:n.contrato_id,id:(null===n||void 0===n||null===(s=n.pagos)||void 0===s||null===(d=s.pagos)||void 0===d||null===(u=d.at(-1))||void 0===u?void 0:u.id)||""});if("initialTeletrans"===t||"fecha_pago"===t)return(0,r.Z)((0,r.Z)({},l),{},(0,o.Z)({},t,i));if("unidad_produccion"===t)return(0,r.Z)((0,r.Z)({},l),{},{unidad_produccion:i});if("observacion"===t)return(0,r.Z)((0,r.Z)({},l),{},{observacion:i})}return e}))}))}),W,(function(e){T(!0),F(e.observaciones)}));return(0,u.useEffect)((function(){var e=f.map((function(e){return{id:e.id,contrato_id:e.contrato_id,dni:e.dni,nombre:e.nombre+" - "+e.quincena,quincena:e.quincena,saldoFinal:e.saldoFinal}}));e.length>0&&X(e)}),[f]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(v.Z,{text:"Programaci\xf3n de pagos",ruta:"/planilla"}),(0,g.jsxs)("div",{className:"margenes",children:[(0,g.jsx)(x,{setModal:w,setFilterText:L}),(0,g.jsx)(m.Z,{columns:Q,table:H})]}),j&&(0,g.jsx)(R,{open:j,setModal:w,closeModal:function(){O(!1)},actualizarTabla:U,trabajadores:K}),S&&(0,g.jsx)(h.Z,{modal:S,setModal:T,observacion:D,boton:!1})]})}},4808:function(e,n,a){var o=a(29439),t=a(72791),r=a(43513),i=a(34664),c=(a(51279),a(76487),a(80184));n.Z=function(e){var n=e.columns,a=e.table,s=e.filas,d=t.useState(!0),u=(0,o.Z)(d,2),l=(u[0],u[1]),p=t.useState([]),f=(0,o.Z)(p,2),v=(f[0],f[1]);t.useEffect((function(){var e=setTimeout((function(){v(a),l(!1)}),2e3);return function(){return clearTimeout(e)}}),[]);var m=s?[s,2*s,3*s,4*s,5*s]:[10,20,30,40,50];return(0,c.jsx)("div",{className:"table-container",children:(0,c.jsx)(r.ZP,{columns:n,data:a,pagination:!0,striped:!0,highlightOnHover:!0,responsive:!0,keyField:function(e,n){return n.toString()},paginationComponentOptions:{rowsPerPageText:"Filas por p\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!1,selectAllRowsItemText:"Todos",preserveSelectedOnPageChange:!0},paginationPerPage:s||10,paginationRowsPerPageOptions:m,noDataComponent:(0,c.jsx)(i.Z,{image:i.Z.PRESENTED_IMAGE_SIMPLE,description:(0,c.jsx)("span",{children:"No hay registros para mostrar."})})})})}},16026:function(e,n,a){a.d(n,{Bq:function(){return v},FH:function(){return t},FN:function(){return o},JL:function(){return r},LR:function(){return d},Md:function(){return l},Oj:function(){return i},TT:function(){return h},Tc:function(){return _},XK:function(){return b},bf:function(){return j},cB:function(){return Z},d_:function(){return u},eJ:function(){return s},eT:function(){return g},g5:function(){return c},kb:function(){return f},n4:function(){return x},s:function(){return p},v2:function(){return m}});var o={nombre:"",usuario:"",contrasenia:"",estado:""},t={nombre:""},r={nombre:"",direccion:""},i=function(){return{dni:"",codigo_trabajador:"",fecha_nacimiento:"",telefono:"",nombre:"",apellido_paterno:"",apellido_materno:"",email:"",estado_civil:"",genero:"",direccion:"",asociacion_id:null,eliminar:!1}},c=function(e){return{fecha_evaluacion:"",capacitacion_sso:"",capacitacion_gema:"",evaluacion_laboral:"",presion_arterial:"",temperatura:"",saturacion:"",imc:"",pulso:"",diabetes:"",antecedentes:"",emo:"",trabajador_id:e.dni,aprobado:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",fiscalizador:"",fiscalizador_aprobado:"no",control:"no",topico:"no",seguridad:"no",medio_ambiente:"no",recursos_humanos:"no",topico_observacion:"",control_observacion:"",seguridad_observacion:"",medio_ambiente_observacion:"",recursos_humanos_observacion:"",finalizado:!1,gerencia_id:"",area_id:"",puesto_id:"",campamento_id:""}},s=function(e,n){var a;return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",asociacion_id:e&&(null===e||void 0===e?void 0:e.id),estado:!1,evaluacion_id:n,trabajadores:null===e||void 0===e||null===(a=e.trabajador)||void 0===a?void 0:a.map((function(e){return e.dni})),tareo:""}},d=function(e){return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia:"",area:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto:"",estado:!1,empresa_id:e}},u=function(e){return{sucursal_id:e,fecha:"",movimiento:"",forma_pago:"",encargado:"",area:"",cantidad:"",medida:"",descripcion:"",monto:"",proveedor:"",comprobante:"",dni:"",sucursal_transferencia:"",precio:""}},l={nombre:""},p={nombre:"",codigo:"",descripcion:"",saldo_inicial:""},f={nombre:"",codigo:"",descripcion:""},v=function(e,n){return{codigo:parseInt(n)+1,nombre:"",codigo_interno:"",codigo_barras:"",descripcion:"",categoria_id:"",unidad_id:"",precio:"",fecha:"",observacion:"",almacen_id:"",stock:"0",costo_total:""}},m=function(e){return{codigo:"",motivo:"",fecha:"",encargado:"",codigo_compra:"",boleta:"",codigo_requerimiento:"",producto_id:"",categoria:"",cantidad:"",unidad:"",tipo:e,producto:"",almacen_id:"",codigo_pedido:"",costo:"",dni:"",costo_total:"",area_id:"",personal:"",retornable:""}},h=function(e,n){return{codigo:"",fecha_pedido:"",fecha_entrega:"",solicitante:"",area:"",celular:"",proyecto:"",producto_id:"",cantidad:"",unidad:"",estado:"",producto:"",personal:"",dni:""}},_=function(){return{id:"",nombre:"",contrato_id:"",observacion:"",unidad_produccion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajador_dni:""}},b=function(){return{id:"",unidad_produccion:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajadores:[]}},g=function(){return{id:"",unidad_produccion:"",razon_social:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"casa"}},Z=function(){return{id:"",nombre:"",trabajador_dni:"",observacion:"",fecha_pago:new Date,hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:"",tipo:"extraordinario"}},x=function(){return{id:"",hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:""}},j=function(){return{id:"",unidad_produccion:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"asociacion",contrato_id:"",asociacion:[]}}}}]);
//# sourceMappingURL=1670.3111a600.chunk.js.map