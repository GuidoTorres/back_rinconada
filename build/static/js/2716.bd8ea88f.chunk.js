"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[2716],{24271:function(e,a,t){t.r(a),t.d(a,{default:function(){return S}});var n=t(74165),s=t(15861),r=t(29439),o=t(72791),i=t(38411),u=t(1413),c=t(4942),l=t(16026),d=t(69967),m=t(17615),f=t(87309),v=t(63998),p=t(99763),x=t(78820),Z=t(8034),g=t(80184),h=function(e){var a=e.actualizarTabla,t=m.Z.useForm(),h=(0,r.Z)(t,1)[0],j=(0,o.useContext)(i.s),b=(j.createData,j.updateData,j.modal),w=j.setModal,y=j.setDataToEdit,F=j.dataToEdit,N=j.getData,k=j.cargando,C=j.setCargando,D=(0,o.useState)(l.FN),E=(0,r.Z)(D,2),S=E[0],T=E[1],P=(0,o.useState)([]),_=(0,r.Z)(P,2),q=_[0],I=_[1],M=(0,o.useState)([]),z=(0,r.Z)(M,2),R=z[0],A=z[1],U=(0,o.useState)(null),L=(0,r.Z)(U,2),O=L[0],V=L[1],B=(0,o.useState)([]),J=(0,r.Z)(B,2),G=J[0],K=J[1],H=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var a,t,s,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N("rol");case 2:return a=e.sent,e.next=5,N("cargo");case 5:return t=e.sent,e.next=8,N("sucursal");case 8:return s=e.sent,e.next=11,Promise.all([a,t,s]);case 11:r=e.sent,I(r[0].data),A(r[1].data),K(r[2].data);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){H()}),[]),(0,o.useEffect)((function(){F?(T(F),h.setFieldsValue(F)):T(l.FN)}),[F]);console.log("===================================="),console.log(S),console.log("====================================");var Q=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var s,r,o,i,u,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==F){e.next=19;break}return C(!0),(s=new FormData).set("nombre",S.nombre||""),s.set("usuario",S.usuario||""),s.set("contrasenia",S.contrasenia||""),s.set("estado",S.estado||""),s.set("rol_id",S.rol_id||""),s.set("cargo_id",S.cargo_id||""),s.set("foto",S.foto||""),s.set("caja",JSON.stringify(S.caja)||""),(null===O||void 0===O?void 0:O.file)&&s.set("image",O.file||""),e.next=14,fetch("".concat("http://13.58.131.42:3000/api/v1","/usuario"),{method:"POST",body:s});case 14:return r=e.sent,e.next=17,r.json();case 17:(o=e.sent)&&((0,p.q)(o.status,o.msg),a(),W(),C(!1));case 19:if(!F){e.next=37;break}return(i=new FormData).set("nombre",S.nombre||""),i.set("usuario",S.usuario||""),i.set("contrasenia",S.contrasenia||""),i.set("estado",S.estado||""),i.set("rol_id",S.rol_id||""),i.set("cargo_id",S.cargo_id||""),i.set("foto",S.foto||""),i.set("caja",JSON.stringify(S.caja)||""),(null===O||void 0===O?void 0:O.file)&&i.set("image",O.file||""),e.next=32,fetch("".concat("http://13.58.131.42:3000/api/v1","/usuario/").concat(F.id),{method:"PUT",body:i});case 32:return u=e.sent,e.next=35,u.json();case 35:(c=e.sent)&&((0,p.q)(c.status,c.msg),a(),W(),C(!1));case 37:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();function W(){w(!1),y(null),T(l.FN),C(!1)}var X=(0,v.pc)(S,(function(e,a){if(!a&&e.target){var t=e.target,n=t.name,s=t.value;h.setFieldsValue((0,c.Z)({},n,s)),T((function(e){return(0,u.Z)((0,u.Z)({},e),{},(0,c.Z)({},n,s))}))}else h.setFieldsValue((0,c.Z)({},a,e)),T((function(t){return(0,u.Z)((0,u.Z)({},t),{},(0,c.Z)({},a,e))}))}),q,R,F,G);return(0,g.jsx)(d.Z,{className:"modal-usuario",title:F?"Editar usuario":"Registrar usuario",open:b,width:400,closeModal:W,children:(0,g.jsxs)(m.Z,{form:h,className:"modal-body",onFinish:Q,layout:"horizontal",children:[X.map((function(e,a){return(0,g.jsx)(m.Z.Item,{className:e.className,name:e.name,rules:e.rules,style:{marginBottom:"8px"},children:(0,g.jsxs)(g.Fragment,{children:[e.label,e.type]})},a)})),(0,g.jsx)("p",{children:"Firma"}),(0,g.jsx)("div",{className:"avatar",children:(0,g.jsx)(Z.Z,{avatar:O,setAvatar:V,selected:F})}),(0,g.jsx)(m.Z.Item,{className:"button-container",children:(0,g.jsx)(f.ZP,{htmlType:"submit",icon:(0,g.jsx)(x.lFz,{}),loading:!!k,children:F?" Editar":" Registrar"})})]})})},j=t(83188),b=t(4808),w=t(3066),y=t(53939),F=t(95579),N=t(85126),k=t(34664),C=t(76487),D=t(49389),E=function(e){var a=e.modal,t=e.setModal,l=m.Z.useForm(),v=(0,r.Z)(l,1)[0],Z=(0,o.useContext)(i.s),h=Z.dataToEdit,j=Z.updateData,b=Z.setDataToEdit,w=(0,o.useState)({nueva:"",nueva2:""}),y=(0,r.Z)(w,2),F=y[0],N=y[1],k=function(){t(!1),b(null)},C=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var a,t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F.nueva!==F.nueva2){e.next=9;break}return a={contrasenia:F.nueva},"usuario/contrasenia",e.next=5,j(a,h.id,"usuario/contrasenia");case 5:(t=e.sent)&&((0,p.q)(t.status,t.msg),k()),e.next=10;break;case 9:(0,p.q)(500,"Las contrase\xf1as no coinciden.");case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(e){var a=e.target,t=a.name,n=a.value;v.setFieldsValue((0,c.Z)({},t,n)),N((function(e){return(0,u.Z)((0,u.Z)({},e),{},(0,c.Z)({},t,n))}))};return(0,g.jsx)(d.Z,{className:"modal-usuario",title:"Cambiar contrase\xf1a",open:a,width:400,closeModal:k,children:(0,g.jsxs)(m.Z,{form:v,className:"modal-body",onFinish:C,layout:"horizontal",children:[(0,g.jsxs)(m.Z.Item,{style:{marginBottom:"8px"},name:"nueva",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,g.jsx)("label",{htmlFor:"",children:"Nueva contrase\xf1a"}),(0,g.jsx)(D.Z.Password,{value:F.nueva,name:"nueva",onChange:E})]}),(0,g.jsxs)(m.Z.Item,{style:{marginBottom:"8px"},name:"nueva2",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,g.jsx)("label",{htmlFor:"",children:"Confirme nueva contrase\xf1a"}),(0,g.jsx)(D.Z.Password,{value:F.nueva2,name:"nueva2",onChange:E})]}),(0,g.jsx)(m.Z.Item,{className:"button-container",children:(0,g.jsx)(f.ZP,{htmlType:"submit",icon:(0,g.jsx)(x.lFz,{}),children:"Actualizar"})})]})})},S=function(){var e=(0,o.useContext)(i.s),a=e.getData,t=e.deleteData,u=e.modal,c=e.setModal,l=e.setDataToEdit,d=e.modal1,m=e.cargando,f=e.setCargando,v=(0,o.useState)([]),x=(0,r.Z)(v,2),Z=x[0],D=x[1],S=(0,F.Z)(Z).result,T=(0,o.useState)(!1),P=(0,r.Z)(T,2),_=P[0],q=P[1],I=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.next=3,a("usuario");case 3:(t=e.sent)&&(f(!1),D(t.data));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(a){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("usuario",a);case 2:(s=e.sent)&&((0,p.q)(s.status,s.msg),I());case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){I()}),[]);var z=(0,y.UR)((function(e){l(e),c(!0)}),M,(function(e){l(e),q(!0)}));return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(j.Z,{text:"Usuarios",user:"Usuario",ruta:"/administracion"}),(0,g.jsxs)("div",{className:"margenes",children:[(0,g.jsx)(w.Z,{abrirModal:c}),Z.length>0?(0,g.jsx)(b.Z,{columns:z,table:S}):(0,g.jsx)("div",{className:"noData",children:m?(0,g.jsx)(C.Z,{}):(0,g.jsx)(k.Z,{image:k.Z.PRESENTED_IMAGE_SIMPLE,description:(0,g.jsx)("span",{children:"No hay registros para mostrar."})})})]}),_&&(0,g.jsx)(E,{modal:_,setModal:q}),u&&(0,g.jsx)(h,{actualizarTabla:I}),d&&(0,g.jsx)(N.Z,{actualizar:I})]})}},8034:function(e,a,t){var n=t(1413),s=t(72791),r=t(18267),o=(t(77457),t(80184));a.Z=function(e){var a=e.setAvatar,t=e.avatar,i=e.selected,u=(0,s.useCallback)((function(e){var t=e[0];a({file:t,preview:URL.createObjectURL(t)})}),[a]),c=(0,r.uI)({accept:{"image/png":[".png"],"image/jpg":[".jpg"],"image/jpeg":[".jpeg"]},noKeyboard:!0,onDrop:u}),l=c.getRootProps,d=c.getInputProps,m=c.isDragActive;return(0,o.jsxs)("div",(0,n.Z)((0,n.Z)({},l()),{},{className:"drag",children:[(0,o.jsx)("input",(0,n.Z)({},d())),m?(0,o.jsx)("p",{children:"Coloca la imagen aqui..."}):null!==i&&void 0!==i&&i.foto||null!==t&&void 0!==t&&t.preview?(0,o.jsx)("img",{src:(null===t||void 0===t?void 0:t.preview)||(null===i||void 0===i?void 0:i.foto),alt:""}):(0,o.jsx)("p",{children:"Arrastra la imagen aqui, o has click para seleccionar la imagen."})]}))}},77457:function(){}}]);
//# sourceMappingURL=2716.bd8ea88f.chunk.js.map