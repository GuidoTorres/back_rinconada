"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[1462],{69967:function(e,n,o){o(72791);var a=o(49998),t=o(80184);n.Z=function(e){var n=e.className,o=e.title,r=e.open,i=e.width,c=e.closeModal,s=e.children;return(0,t.jsx)(a.Z,{destroyOnClose:!0,className:n,title:o,open:r,centered:!0,onCancel:c,footer:null,width:i,children:s})}},28181:function(e,n,o){var a=o(74165),t=o(15861),r=o(29439),i=o(49389),c=o(87309),s=o(72791),d=o(38411),l=o(99763),u=o(69967),f=o(80184);n.Z=function(e){var n=e.modal,o=e.setModal,p=(e.getPlanilla,e.data),m=e.observacion,v=e.boton,h=(0,s.useContext)(d.s).updateData,b=(0,s.useState)(""),_=(0,r.Z)(b,2),g=_[0],Z=_[1],x=function(){o(!1)},j=function(){var e=(0,t.Z)((0,a.Z)().mark((function e(){var n,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={observaciones:g},e.next=3,h(n,p.aprobacion_id,"aprobacion/observacion");case 3:(o=e.sent)&&((0,l.q)(o.status,o.msg),x());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(u.Z,{className:"modal-usuario",title:v?"Agregar Observaci\xf3n":"Observaci\xf3n RRHH",open:n,width:400,closeModal:x,children:[(0,f.jsx)(i.Z.TextArea,{showCount:!0,maxLength:255,defaultValue:null!==p&&void 0!==p&&p.observaciones?null===p||void 0===p?void 0:p.observaciones:m||"",style:{height:120,marginBottom:24,marginTop:15},onChange:function(e){Z(e.target.value)},placeholder:"Observaci\xf3n"}),(0,f.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingTop:"10px"},children:v&&(0,f.jsx)(c.ZP,{onClick:j,children:"Guardar"})})]})}},48615:function(e,n,o){o.r(n),o.d(n,{default:function(){return H}});var a=o(74165),t=o(15861),r=o(29439),i=o(34664),c=o(72791),s=o(38411),d=o(53939),l=o(99763),u=(o(64941),o(76487)),f=o(83188),p=o(1413),m=o(59274),v=o(82339),h=o(43513),b=(o(51279),o(80184)),_=function(e){var n=e.columns,o=e.table,a=e.filas,t=n.filter((function(e){return"Nro"===e.id||"asociacion"===e.id||"fecha_inicio"===e.id||"fecha_fin"===e.id||"pago"===e.id||"saldo"===e.id||"tipo_asociacion"===e.id||"observacion"===e.id||"acciones"===e.id})),r=n.map((function(e){return{title:e.name,dataIndex:e.id,key:e.id}}));return(0,b.jsx)("div",{className:"table-container",children:(0,b.jsx)(h.ZP,{size:"small",columns:t,data:o,pagination:!0,striped:!0,highlightOnHover:!0,responsive:!0,paginationComponentOptions:{rowsPerPageText:"Filas por p\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!1,selectAllRowsItemText:"Todos"},paginationPerPage:a||8,paginationRowsPerPageOptions:[8,16,24,32,40],expandableRows:!0,expandableRowsComponent:function(e){var n,o,a=e.data;return(0,b.jsx)(m.Z,{size:"small",columns:r.filter((function(e){return"Nro"===e.key||"nombre"===e.key||"dni"===e.key||"telefono"===e.key||"teletrans"===e.key||"estado"===e.key})),pagination:!1,dataSource:null===(n=a.pagos)||void 0===n||null===(o=n.trabajadores)||void 0===o?void 0:o.map((function(e,n){return(0,p.Z)({key:n,Nro:n+1,nombres:e.nombre,dni:e.dni,telefono:e.telefono,teletrans:e.teletrans||0,estado:e.programado?(0,b.jsx)(v.Z,{color:"green",children:"Programado"}):(0,b.jsx)(v.Z,{color:"red",children:"No programado"})},e)}))})}})})},g=o(28181),Z=o(93433),x=o(4942),j=o(17615),y=o(53655),w=o(49389),T=o(58848),q=o(68588),C=o(77128),D=o(83099),S=o(80458),k=o(36473),E=o(78792),M=o(66106),P=o(30914),Y=o(2964),F=o(87309),I=o(97892),N=o.n(I),z=o(35790),O=o(16026),R=o(69967),A=o(78820);var L=function(e){var n=e.asociacionTemp,o=e.open,i=e.closeModal,d=e.actualizarTabla,u=e.closeModalSubmit,f=void 0===u?function(){}:u,m=e.dataToEdit,v=void 0===m?{}:m,h=e.setDataToEdit,_=void 0===h?function(){}:h,g=j.Z.useForm(),I=(0,r.Z)(g,1)[0],L=y.Z.Text,H=(0,c.useContext)(s.s),V=H.updateData,B=H.createData,G=(0,c.useState)(!1),J=(0,r.Z)(G,2),K=J[0],X=(J[1],(0,c.useState)([])),Q=(0,r.Z)(X,2),U=Q[0],W=Q[1];(0,c.useEffect)((function(){W(null===n||void 0===n?void 0:n.pagos.trabajadores.filter((function(e){return!e.programado})))}),[n]),console.log("===================================="),console.log(n),console.log("====================================");var $=null===U||void 0===U?void 0:U.map((function(e){return{value:e.dni,label:e.nombre}})),ee=(0,c.useState)([]),ne=(0,r.Z)(ee,2),oe=ne[0],ae=ne[1],te=(0,c.useState)([]),re=(0,r.Z)(te,2),ie=re[0],ce=re[1];(0,c.useEffect)((function(){if(oe.length>0){var e=U.filter((function(e){return oe.includes(e.dni)}));ce(e)}}),[oe]);var se=(0,c.useState)(O.bf),de=(0,r.Z)(se,2),le=de[0],ue=de[1],fe=function(e,n){if(!n&&e.target){var o=e.target,a=o.name,t=o.value;I.setFieldsValue((0,x.Z)({},a,t)),ue((function(e){return(0,p.Z)((0,p.Z)({},e),{},(0,x.Z)({},a,t))}))}else I.setFieldsValue((0,x.Z)({},n,e)),ue((function(o){return(0,p.Z)((0,p.Z)({},o),{},(0,x.Z)({},n,e))}))},pe=(0,c.useState)([]),me=(0,r.Z)(pe,2),ve=me[0],he=me[1];(0,c.useEffect)((function(){if(ie.length>0){var e=ie.map((function(e){return{nombre:e.nombre,dni:e.dni,teletrans:e.teletrans||""}}));he(v?le.trabajadores.map((function(e){return(0,p.Z)((0,p.Z)({},e),{},{teletrans:parseFloat(e.teletrans)})})):e)}}),[ie]);var be=function(){var e=0;return ve.forEach((function(n){e+=n.teletrans})),e},_e=function(){return le.volquetes?le.volquetes:be()/4},ge=function(){var e=(0,t.Z)((0,a.Z)().mark((function e(){var o,t,r,i,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="pago/programacion/multiple",!(4*_e()>n.total_modificado)){e.next=5;break}return(0,l.q)(500,"El monto a pagar es mayor a lo adeudado."),e.abrupt("return");case 5:if(t={observacion:le.observacion,contrato_id:n.contrato_id,fecha_pago:N()(le.fecha_pago).format("YYYY-MM-DD")||"",volquetes:_e(),teletrans:be(),tipo:"asociacion",quincena:n.quincena,asociacion:ve.map((function(e){return{volquetes:_e(),trabajador_dni:e.dni,teletrans:e.teletrans||0,contrato_id:n.contrato_id||"",quincena:n.quincena||""}}))},r={observacion:le.observacion,contrato_id:n.contrato_id,fecha_pago:N()(le.fecha_pago).format("YYYY-MM-DD")||"",volquetes:_e(),teletrans:be(),trabajadores:ve.map((function(e){return{volquetes:_e(),trabajador_dni:e.dni,teletrans:e.teletrans,contrato_id:n.contrato_id||"",quincena:n.quincena||""}}))},!v){e.next=14;break}return e.next=10,V(r,v.id,"planilla/asociacion");case 10:(i=e.sent)&&((0,l.q)(i.status,i.msg),d(),ye()),e.next=18;break;case 14:return e.next=16,B(t,o);case 16:(c=e.sent)&&((0,l.q)(c.status,c.msg),d(),ye());case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ze=(0,c.useState)([]),xe=(0,r.Z)(Ze,2),je=(xe[0],xe[1]);(0,c.useEffect)((function(){v&&(ue((0,p.Z)((0,p.Z)({},v),{},{fecha_pago:N()(v.fecha_pago).format("YYYY-MM-DD")})),ae(v.trabajadores.map((function(e){return e.dni}))),je(v.trabajadores.map((function(e){return e.nombre}))),he(v.trabajadores))}),[v]);var ye=function(){_(null),i(),f(),ae([]),W([]),ce([]),he([]),ue(O.bf)};return(0,b.jsx)(R.Z,{open:o,closeModal:ye,title:"Registrar pago Asociaci\xf3n: "+(null===n||void 0===n?void 0:n.nombre),width:800,children:(0,b.jsxs)(j.Z,{form:I,className:"modal-body",onFinish:ge,layout:"vertical",children:[(0,b.jsx)(j.Z.Item,{label:"Observaci\xf3n",children:(0,b.jsx)(w.Z.TextArea,{autoSize:!0,name:"observacion",value:le.observacion,placeholder:"Observaci\xf3n",onChange:function(e){return fe(e)}})}),(0,b.jsx)(j.Z.Item,{label:"Fecha",children:(0,b.jsx)(T.ZP,{locale:z.Z,children:(0,b.jsx)(q.Z,{allowClear:!1,value:N()(le.fecha_pago),name:"fecha_pago",placeholder:"Fecha de Pago",picker:"day",onChange:function(e){return fe(e,"fecha_pago")},style:{width:"100%"},format:"YYYY-MM-DD"})})}),(0,b.jsx)(C.Z,{orientation:"left",children:"Trabajadores"}),(0,b.jsxs)(D.Z,{direction:"vertical",style:{width:"100%"},children:[(0,b.jsx)(j.Z.Item,{label:"Seleccione trabajadores",children:(0,b.jsx)(S.Z,{showSearch:!0,mode:"multiple",placeholder:"Seleccione trabajadores",style:{width:"100%"},allowClear:!0,value:oe,onChange:function(e){ae(e)},options:$,disabled:!!v,filterOption:function(e,n){return n.label.toLowerCase().indexOf(e.toLowerCase())>=0}})}),(0,b.jsx)(j.Z.Item,{label:"Volquetes",children:(0,b.jsx)(w.Z,{value:le.volquetes,placeholder:"Volquetes",name:"volquetes",type:"number",min:0,onChange:function(e){return fe(e)}})})]}),(0,b.jsx)(C.Z,{orientation:"left",children:"Teletrans por trabajador"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,b.jsxs)(k.Z,{style:{width:"100%"},children:[(0,b.jsx)(E.ZP,{itemLayout:"horizontal",dataSource:ve,renderItem:function(e){return(0,b.jsx)(E.ZP.Item,{children:(0,b.jsxs)(M.Z,{style:{width:"100%"},children:[(0,b.jsx)(P.Z,{span:18,children:(0,b.jsx)(D.Z,{direction:"vertical",children:e.nombre})}),(0,b.jsx)(P.Z,{span:6,children:(0,b.jsx)(D.Z,{direction:"vertical",children:(0,b.jsx)(w.Z,{value:e.teletrans,placeholder:"Teletrans",type:"number",min:0,onChange:function(n){return function(e,n){var o=ve.findIndex((function(e){return e.dni===n}));ve[o]=(0,p.Z)((0,p.Z)({},ve[o]),{},{teletrans:parseFloat(e.target.value)}),he((0,Z.Z)(ve))}(n,e.dni)}})})})]},e.dni)})}}),(0,b.jsxs)(D.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end",alignItems:"center",padding:24},children:[(0,b.jsx)(L,{type:be()%4===0?"success":"danger",children:"TOTAL DE TELETRANS"}),(0,b.jsx)(Y.Z,{message:be(),type:be()%4===0?"success":"error"})]})]}),be()>4&&(0,b.jsx)(Y.Z,{message:"Total de pago no debe exceder a 4 teletrans",type:"error"})]}),(0,b.jsxs)(D.Z,{direction:"horizontal",style:{width:"100%",marginTop:20,justifyContent:"end"},children:[(0,b.jsx)(F.ZP,{onClick:i,children:"Cancelar"}),(0,b.jsx)(F.ZP,{type:"primary",htmlType:"submit",icon:(0,b.jsx)(A.lFz,{}),loading:!!K,children:"Registrar"})]})]})})},H=function(){var e=(0,c.useContext)(s.s),n=e.getData,o=e.dataToEdit,l=e.setDataToEdit,p=(e.deleteData,(0,c.useState)(!1)),m=(0,r.Z)(p,2),v=m[0],h=m[1],Z=(0,c.useState)(!1),x=(0,r.Z)(Z,2),j=x[0],y=x[1],w=(0,c.useState)({}),T=(0,r.Z)(w,2),q=T[0],C=T[1],D=(0,c.useState)(!1),S=(0,r.Z)(D,2),k=S[0],E=S[1],M=(0,c.useState)(""),P=(0,r.Z)(M,2),Y=P[0],F=P[1],I=(0,c.useState)([]),N=(0,r.Z)(I,2),z=N[0],O=N[1],R=function(){var e=(0,t.Z)((0,a.Z)().mark((function e(){var o,t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n("planilla/pagos/lista");case 2:(o=e.sent)&&(t=o.data.filter((function(e){return null!==e})),O(t),h(!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){R()}),[]);var A=(0,d.Hg)((function(e){y(!0),C(e)}),(function(e){F(null===e||void 0===e?void 0:e.aprobacion),E(!0)}));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Z,{text:"Asociacion",ruta:"/planilla"}),(0,b.jsx)("div",{className:"margenes",children:(null===z||void 0===z?void 0:z.length)>0?(0,b.jsx)(_,{columns:A,table:z}):(0,b.jsx)(b.Fragment,{children:v?(0,b.jsx)(u.Z,{}):(0,b.jsx)(i.Z,{image:i.Z.PRESENTED_IMAGE_SIMPLE,description:(0,b.jsx)("span",{children:"No hay registros para mostrar."})})})}),j&&(0,b.jsx)(L,{asociacionTemp:q,actualizarTabla:R,open:j,closeModal:function(){y(!1),l(null)},dataToEdit:o}),k&&(0,b.jsx)(g.Z,{setModal:E,modal:k,data:Y,observacion:"",boton:!0})]})}},16026:function(e,n,o){o.d(n,{Bq:function(){return m},FH:function(){return t},FN:function(){return a},JL:function(){return r},LR:function(){return d},Md:function(){return u},Oj:function(){return i},TT:function(){return h},Tc:function(){return b},XK:function(){return _},bf:function(){return j},cB:function(){return Z},d_:function(){return l},eJ:function(){return s},eT:function(){return g},g5:function(){return c},kb:function(){return p},n4:function(){return x},s:function(){return f},v2:function(){return v}});var a={nombre:"",usuario:"",contrasenia:"",estado:""},t={nombre:""},r={nombre:"",direccion:""},i=function(){return{dni:"",codigo_trabajador:"",fecha_nacimiento:"",telefono:"",nombre:"",apellido_paterno:"",apellido_materno:"",email:"",estado_civil:"",genero:"",direccion:"",asociacion_id:null,eliminar:!1}},c=function(e){return{fecha_evaluacion:"",capacitacion_sso:"",capacitacion_gema:"",evaluacion_laboral:"",presion_arterial:"",temperatura:"",saturacion:"",imc:"",pulso:"",diabetes:"",antecedentes:"",emo:"",trabajador_id:e.dni,aprobado:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",fiscalizador:"",fiscalizador_aprobado:"no",control:"no",topico:"no",seguridad:"no",medio_ambiente:"no",recursos_humanos:"no",topico_observacion:"",control_observacion:"",seguridad_observacion:"",medio_ambiente_observacion:"",recursos_humanos_observacion:"",finalizado:!1,gerencia_id:"",area_id:"",puesto_id:"",campamento_id:""}},s=function(e,n){var o;return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",asociacion_id:e&&(null===e||void 0===e?void 0:e.id),estado:!1,evaluacion_id:n,trabajadores:null===e||void 0===e||null===(o=e.trabajador)||void 0===o?void 0:o.map((function(e){return e.dni})),tareo:""}},d=function(e){return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia:"",area:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto:"",estado:!1,empresa_id:e}},l=function(e){return{sucursal_id:e,fecha:"",movimiento:"",forma_pago:"",encargado:"",area:"",cantidad:"",medida:"",descripcion:"",monto:"",proveedor:"",comprobante:"",dni:"",sucursal_transferencia:"",precio:""}},u={nombre:""},f={nombre:"",codigo:"",descripcion:"",saldo_inicial:""},p={nombre:"",codigo:"",descripcion:""},m=function(e,n){return{codigo:parseInt(n)+1,nombre:"",codigo_interno:"",codigo_barras:"",descripcion:"",categoria_id:"",unidad_id:"",precio:"",fecha:"",observacion:"",almacen_id:"",stock:"0",costo_total:""}},v=function(e){return{codigo:"",motivo:"",fecha:"",encargado:"",codigo_compra:"",boleta:"",codigo_requerimiento:"",producto_id:"",categoria:"",cantidad:"",unidad:"",tipo:e,producto:"",almacen_id:"",codigo_pedido:"",costo:"",dni:"",costo_total:"",area_id:"",personal:"",retornable:""}},h=function(e,n){return{codigo:"",fecha_pedido:"",fecha_entrega:"",solicitante:"",area:"",celular:"",proyecto:"",producto_id:"",cantidad:"",unidad:"",estado:"",producto:"",personal:"",dni:""}},b=function(){return{id:"",nombre:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajador_dni:""}},_=function(){return{id:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajadores:[]}},g=function(){return{id:"",razon_social:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"casa"}},Z=function(){return{id:"",nombre:"",trabajador_dni:"",observacion:"",fecha_pago:new Date,hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:"",tipo:"extraordinario"}},x=function(){return{id:"",hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:""}},j=function(){return{id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"asociacion",contrato_id:"",asociacion:[]}}}}]);
//# sourceMappingURL=1462.e57ea164.chunk.js.map