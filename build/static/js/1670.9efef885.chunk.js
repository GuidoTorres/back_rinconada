"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[1670],{69967:function(e,n,a){a(72791);var t=a(49998),o=a(80184);n.Z=function(e){var n=e.className,a=e.title,r=e.open,i=e.width,c=e.closeModal,s=e.children;return(0,o.jsx)(t.Z,{destroyOnClose:!0,className:n,title:a,open:r,centered:!0,onCancel:c,footer:null,width:i,children:s})}},28181:function(e,n,a){var t=a(74165),o=a(15861),r=a(29439),i=a(49389),c=a(87309),s=a(72791),l=a(38411),u=a(99763),d=a(69967),f=a(80184);n.Z=function(e){var n=e.modal,a=e.setModal,p=(e.getPlanilla,e.data),v=e.observacion,m=e.boton,h=(0,s.useContext)(l.s).updateData,b=(0,s.useState)(""),g=(0,r.Z)(b,2),_=g[0],Z=g[1],x=function(){a(!1)},j=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var n,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={observaciones:_},e.next=3,h(n,p.aprobacion_id,"aprobacion/observacion");case 3:(a=e.sent)&&((0,u.q)(a.status,a.msg),x());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(d.Z,{className:"modal-usuario",title:m?"Agregar Observaci\xf3n":"Observaci\xf3n RRHH",open:n,width:400,closeModal:x,children:[(0,f.jsx)(i.Z.TextArea,{showCount:!0,maxLength:255,defaultValue:null!==p&&void 0!==p&&p.observaciones?null===p||void 0===p?void 0:p.observaciones:v||"",style:{height:120,marginBottom:24,marginTop:15},onChange:function(e){Z(e.target.value)},placeholder:"Observaci\xf3n"}),(0,f.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingTop:"10px"},children:m&&(0,f.jsx)(c.ZP,{onClick:j,children:"Guardar"})})]})}},42871:function(e,n,a){a.r(n),a.d(n,{default:function(){return Y}});var t=a(4942),o=a(74165),r=a(1413),i=a(15861),c=a(29439),s=a(97892),l=a.n(s),u=a(72791),d=a(38411),f=(a(71368),a(53939)),p=a(99763),v=(a(64941),a(83188)),m=a(4808),h=a(28181),b=a(87309),g=a(49389),_=a(80184),Z=g.Z.Search,x=function(e){var n=e.setFilterText,a=e.setModal;return(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,_.jsx)("div",{style:{width:"300px"},children:(0,_.jsx)(Z,{placeholder:"Ingresa un termino aqui...",onChange:function(e){return n(e.target.value)}})}),(0,_.jsx)("div",{children:(0,_.jsx)(b.ZP,{onClick:function(){a(!0)},style:{width:"150px"},children:"Pago Multiple"})})]})},j=a(93433),w=a(17615),q=a(53655),C=a(77128),y=a(83099),S=a(80458),T=a(58848),A=a(68588),D=a(36473),F=a(78792),M=a(66106),E=a(30914),O=a(2964),P=a(35790),k=a(16026),N=a(69967),R=a(78820);var I=function(e){var n=e.open,a=e.setModal,s=e.trabajadores,f=e.actualizarTabla,v=e.closeModalSubmit,m=void 0===v?function(){}:v,h=e.dataToEdit,Z=e.setDataToEdit,x=void 0===Z?function(){}:Z,I=w.Z.useForm(),Y=(0,c.Z)(I,1)[0],L=q.Z.Text,z=(0,u.useContext)(d.s),V=z.updateData,H=z.createData,B=z.cargando,J=z.setCargando,G=null===s||void 0===s?void 0:s.map((function(e){return{value:e.id,label:e.nombre}})),K=function(){a(!1)},X=(0,u.useState)([]),W=(0,c.Z)(X,2),Q=W[0],U=W[1],$=(0,u.useState)([]),ee=(0,c.Z)($,2),ne=ee[0],ae=ee[1];(0,u.useEffect)((function(){if(Q.length>0){var e=s.filter((function(e){return Q.includes(e.id)}));ae(e)}}),[Q]);var te=(0,u.useState)(k.XK),oe=(0,c.Z)(te,2),re=oe[0],ie=oe[1],ce=function(e,n){if(!n&&e.target){var a=e.target,o=a.name,i=a.value;Y.setFieldsValue((0,t.Z)({},o,i)),ie((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,t.Z)({},o,i))}))}else Y.setFieldsValue((0,t.Z)({},n,e)),ie((function(a){return(0,r.Z)((0,r.Z)({},a),{},(0,t.Z)({},n,e))}))},se=(0,u.useState)([]),le=(0,c.Z)(se,2),ue=le[0],de=le[1];(0,u.useEffect)((function(){if(ne.length>0){var e=ne.map((function(e){return{id:e.id,nombre:e.nombre,contrato_id:e.contrato_id,teletrans:e.teletrans||"",trabajador_dni:e.dni,quincena:e.quincena,saldoFinal:e.saldoFinal}}));de(h?re.trabajadores.map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{teletrans:parseFloat(e.teletrans)})})):e)}}),[ne]);var fe=function(){var e=0;return ue.forEach((function(n){e=parseFloat(e)+parseFloat(n.teletrans)})),e},pe=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var n,a,t,r,i,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="pago/programacion/multiple",a={observacion:re.observacion,fecha_pago:l()(re.fecha_pago).format("YYYY-MM-DD")||"",teletrans:fe(),tipo:"pago",trabajadores:ue.map((function(e){return{contrato_id:e.contrato_id,volquetes:e.voqluetes,teletrans:e.teletrans,quincena:e.quincena,trabajador_dni:e.trabajador_dni,saldoFinal:e.saldoFinal}}))},t=!0,r=0,a.trabajadores.forEach((function(e){var n=Number(e.teletrans)||0;n>(Number(e.saldoFinal)||0)&&(t=!1),r+=n})),t){e.next=8;break}return(0,p.q)(500,"El pago a uno de los trabajadores es mayor a lo adeudado"),e.abrupt("return");case 8:if(4===r){e.next=11;break}return(0,p.q)(500,"La cantidad de teletrans debe ser equivalente a un volquete."),e.abrupt("return");case 11:if(!h){e.next=19;break}return J(!0),e.next=15,V(a,re.pago_id,"pago/multiple");case 15:(i=e.sent)&&((0,p.q)(i.status,i.msg),f(),ve()),e.next=23;break;case 19:return e.next=21,H(a,n);case 21:(c=e.sent)&&((0,p.q)(c.status,c.msg),f(),ve());case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){h&&(ie((0,r.Z)((0,r.Z)({},h),{},{fecha_pago:l()(h.fecha_pago).format("YYYY-MM-DD")})),U(h.trabajadores.map((function(e){return e.id}))),de(h.trabajadores))}),[h]);var ve=function(){x(null),K(),m()};return(0,_.jsx)(N.Z,{open:n,closeModal:h?ve:K,title:"Juntar Teletrans",width:800,children:(0,_.jsxs)(w.Z,{form:Y,className:"modal-body",onFinish:pe,layout:"vertical",children:[(0,_.jsx)(C.Z,{orientation:"left",children:"Datos"}),(0,_.jsxs)(y.Z,{direction:"vertical",style:{width:"100%"},children:[(0,_.jsx)(w.Z.Item,{label:"Seleccione trabajadores",children:(0,_.jsx)(S.Z,{showSearch:!0,mode:"multiple",placeholder:"Seleccione trabajadores",style:{width:"100%"},allowClear:!0,value:Q,onChange:function(e){U(e)},options:G,disabled:!!h,filterOption:function(e,n){return n.label.toLowerCase().indexOf(e.toLowerCase())>=0}})}),(0,_.jsx)(w.Z.Item,{label:"Observaci\xf3n",children:(0,_.jsx)(S.Z,{autoSize:!0,name:"observacion",dropdownMatchSelectWidth:!1,onChange:function(e){return ce(e,"observacion")},options:[{label:"ANA MAR\xcdAS",value:"ANA MAR\xcdAS"},{label:"SANTA MARIA",value:"SANTA MARIA"},{label:"CORAZ\xd3N DE SAN FRANCISCO",value:"CORAZ\xd3N DE SAN FRANCISCO"},{label:"SAPO DE ORO",value:"SAPO DE ORO"}]})}),(0,_.jsx)(w.Z.Item,{label:"Fecha",children:(0,_.jsx)(T.ZP,{locale:P.Z,children:(0,_.jsx)(A.Z,{allowClear:!1,value:l()(re.fecha_pago),name:"fecha_pago",placeholder:"Fecha de Pago",picker:"day",onChange:function(e){return ce(e,"fecha_pago")},style:{width:"100%"},format:"YYYY-MM-DD"})})})]}),(0,_.jsx)(C.Z,{orientation:"left",children:"Trabajadores"}),(0,_.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:(0,_.jsxs)(D.Z,{style:{width:"100%"},children:[(0,_.jsx)(F.ZP,{itemLayout:"horizontal",dataSource:ue,renderItem:function(e){return(0,_.jsx)(F.ZP.Item,{children:(0,_.jsxs)(M.Z,{style:{width:"100%"},children:[(0,_.jsx)(E.Z,{span:18,children:(0,_.jsx)(y.Z,{direction:"vertical",children:e.nombre})}),(0,_.jsx)(E.Z,{span:6,children:(0,_.jsx)(y.Z,{direction:"vertical",children:(0,_.jsx)(g.Z,{value:e.teletrans,placeholder:"Teletrans",type:"number",min:0,onChange:function(n){return function(e,n){var a=ue.findIndex((function(e){return e.id===n}));ue[a]=(0,r.Z)((0,r.Z)({},ue[a]),{},{teletrans:parseFloat(e.target.value)}),de((0,j.Z)(ue))}(n,e.id)},required:!0})})})]},e.id)})}}),(0,_.jsxs)(y.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end",alignItems:"center",padding:24},children:[(0,_.jsx)(L,{type:fe()%4===0?"success":"danger",children:"TOTAL DE TELETRANS"}),(0,_.jsx)(O.Z,{message:fe(),type:fe()%4===0?"success":"error"})]})]})}),(0,_.jsxs)(y.Z,{direction:"horizontal",style:{width:"100%",marginTop:20,justifyContent:"end"},children:[(0,_.jsx)(b.ZP,{onClick:K,children:"Cancelar"}),(0,_.jsx)(b.ZP,{type:"primary",htmlType:"submit",icon:(0,_.jsx)(R.lFz,{}),loading:!!B,disabled:0===ue.length,children:"Registrar"})]})]})})},Y=function(){var e=(0,u.useContext)(d.s),n=e.getData,a=e.createData,s=(0,u.useState)([]),b=(0,c.Z)(s,2),g=b[0],Z=b[1],j=(0,u.useState)(!1),w=(0,c.Z)(j,2),q=w[0],C=w[1],y=(0,u.useState)(!1),S=(0,c.Z)(y,2),T=S[0],A=S[1],D=(0,u.useState)(""),F=(0,c.Z)(D,2),M=F[0],E=F[1],O=(0,u.useState)(!1),P=(0,c.Z)(O,2),k=(P[0],P[1]),N=(0,u.useState)([]),R=(0,c.Z)(N,2),Y=(R[0],R[1],(0,u.useState)("")),L=(0,c.Z)(Y,2),z=L[0],V=L[1],H=(0,u.useState)([]),B=(0,c.Z)(H,2),J=B[0],G=B[1],K=(0,u.useState)([]),X=(0,c.Z)(K,2),W=X[0],Q=X[1],U=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var a,t,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n("programacion");case 2:(a=e.sent)&&(t=a.data.filter((function(e){return null!==e})),Z(t),i=t.map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{initialTeletrans:e.teletrans,initialVolquetes:e.volquetes,fecha_pago:l()(new Date).format("YYYY-MM-DD")})})),Z(i));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){U()}),[]);var $=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){var t,r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={observacion:n.observacion,fecha_pago:n.fecha_pago,volquetes:n.initialVolquetes,teletrans:n.initialTeletrans,tipo:"pago",quincena:n.quincena,trabajadores:[{volquetes:n.initialVolquetes,teletrans:n.initialTeletrans,contrato_id:n.contrato_id,trabajador_dni:n.dni,quincena:n.quincena}]},!((r=4*parseFloat(n.initialVolquetes||0)+parseFloat(n.initialTeletrans||0))>n.saldo)){e.next=6;break}(0,p.q)(500,"El monto a pagar es mayor a lo adeudado."),e.next=14;break;case 6:if(r%4===0){e.next=10;break}(0,p.q)(500,"La cantidad debe ser equivalente a un volquete."),e.next=14;break;case 10:return e.next=12,a(t,"pago/programacion/multiple");case 12:(i=e.sent)&&((0,p.q)(i.status,i.msg),U());case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){var e=g&&g.filter((function(e){var n,a,t,o;return(null===e||void 0===e||null===(n=e.nombre)||void 0===n||null===(a=n.toLowerCase())||void 0===a?void 0:a.includes(z.toLowerCase()))||(null===e||void 0===e||null===(t=e.cargo)||void 0===t||null===(o=t.toLowerCase())||void 0===o?void 0:o.includes(z.toLowerCase()))}));G(e)}),[z,g]);var ee=(0,f.lF)((function(e,n,a){if(e.target){var o=e.target,i=o.name,c=o.value;Z((function(e){return e.map((function(e,o){var s,l,u,d;return o===a?(0,r.Z)((0,r.Z)({},e),{},(d={},(0,t.Z)(d,i,c),(0,t.Z)(d,"contrato_id",null===n||void 0===n?void 0:n.contrato_id),(0,t.Z)(d,"id",(null===n||void 0===n||null===(s=n.pagos)||void 0===s||null===(l=s.pagos)||void 0===l||null===(u=l.at(-1))||void 0===u?void 0:u.id)||""),d)):e}))}))}else Z((function(t){return t.map((function(t,o){var i,c,s;return o===a?(0,r.Z)((0,r.Z)({},t),{},{observacion:e,contrato_id:null===n||void 0===n?void 0:n.contrato_id,id:(null===n||void 0===n||null===(i=n.pagos)||void 0===i||null===(c=i.pagos)||void 0===c||null===(s=c.at(-1))||void 0===s?void 0:s.id)||""}):t}))}))}),$,(function(e){A(!0),E(e.observaciones)}));return(0,u.useEffect)((function(){var e=g.map((function(e){return{id:e.id,contrato_id:e.contrato_id,dni:e.dni,nombre:e.nombre+" - "+e.quincena,quincena:e.quincena,saldoFinal:e.saldoFinal}}));e.length>0&&Q(e)}),[g]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(v.Z,{text:"Programaci\xf3n de pagos",ruta:"/planilla"}),(0,_.jsxs)("div",{className:"margenes",children:[(0,_.jsx)(x,{setModal:C,setFilterText:V}),(0,_.jsx)(m.Z,{columns:ee,table:J})]}),q&&(0,_.jsx)(I,{open:q,setModal:C,closeModal:function(){k(!1)},actualizarTabla:U,trabajadores:W}),T&&(0,_.jsx)(h.Z,{modal:T,setModal:A,observacion:M,boton:!1})]})}},4808:function(e,n,a){var t=a(29439),o=a(72791),r=a(43513),i=a(34664),c=(a(51279),a(76487),a(80184));n.Z=function(e){var n=e.columns,a=e.table,s=e.filas,l=o.useState(!0),u=(0,t.Z)(l,2),d=(u[0],u[1]),f=o.useState([]),p=(0,t.Z)(f,2),v=(p[0],p[1]);o.useEffect((function(){var e=setTimeout((function(){v(a),d(!1)}),2e3);return function(){return clearTimeout(e)}}),[]);var m=s?[s,2*s,3*s,4*s,5*s]:[10,20,30,40,50];return(0,c.jsx)("div",{className:"table-container",children:(0,c.jsx)(r.ZP,{columns:n,data:a,pagination:!0,striped:!0,highlightOnHover:!0,responsive:!0,paginationComponentOptions:{rowsPerPageText:"Filas por p\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!1,selectAllRowsItemText:"Todos",preserveSelectedOnPageChange:!0},paginationPerPage:s||10,paginationRowsPerPageOptions:m,noDataComponent:(0,c.jsx)(i.Z,{image:i.Z.PRESENTED_IMAGE_SIMPLE,description:(0,c.jsx)("span",{children:"No hay registros para mostrar."})})})})}},16026:function(e,n,a){a.d(n,{Bq:function(){return v},FH:function(){return o},FN:function(){return t},JL:function(){return r},LR:function(){return l},Md:function(){return d},Oj:function(){return i},TT:function(){return h},Tc:function(){return b},XK:function(){return g},bf:function(){return j},cB:function(){return Z},d_:function(){return u},eJ:function(){return s},eT:function(){return _},g5:function(){return c},kb:function(){return p},n4:function(){return x},s:function(){return f},v2:function(){return m}});var t={nombre:"",usuario:"",contrasenia:"",estado:""},o={nombre:""},r={nombre:"",direccion:""},i=function(){return{dni:"",codigo_trabajador:"",fecha_nacimiento:"",telefono:"",nombre:"",apellido_paterno:"",apellido_materno:"",email:"",estado_civil:"",genero:"",direccion:"",asociacion_id:null,eliminar:!1}},c=function(e){return{fecha_evaluacion:"",capacitacion_sso:"",capacitacion_gema:"",evaluacion_laboral:"",presion_arterial:"",temperatura:"",saturacion:"",imc:"",pulso:"",diabetes:"",antecedentes:"",emo:"",trabajador_id:e.dni,aprobado:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",fiscalizador:"",fiscalizador_aprobado:"no",control:"no",topico:"no",seguridad:"no",medio_ambiente:"no",recursos_humanos:"no",topico_observacion:"",control_observacion:"",seguridad_observacion:"",medio_ambiente_observacion:"",recursos_humanos_observacion:"",finalizado:!1,gerencia_id:"",area_id:"",puesto_id:"",campamento_id:""}},s=function(e,n){var a;return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",asociacion_id:e&&(null===e||void 0===e?void 0:e.id),estado:!1,evaluacion_id:n,trabajadores:null===e||void 0===e||null===(a=e.trabajador)||void 0===a?void 0:a.map((function(e){return e.dni})),tareo:""}},l=function(e){return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia:"",area:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto:"",estado:!1,empresa_id:e}},u=function(e){return{sucursal_id:e,fecha:"",movimiento:"",forma_pago:"",encargado:"",area:"",cantidad:"",medida:"",descripcion:"",monto:"",proveedor:"",comprobante:"",dni:"",sucursal_transferencia:"",precio:""}},d={nombre:""},f={nombre:"",codigo:"",descripcion:"",saldo_inicial:""},p={nombre:"",codigo:"",descripcion:""},v=function(e,n){return{codigo:parseInt(n)+1,nombre:"",codigo_interno:"",codigo_barras:"",descripcion:"",categoria_id:"",unidad_id:"",precio:"",fecha:"",observacion:"",almacen_id:"",stock:"0",costo_total:""}},m=function(e){return{codigo:"",motivo:"",fecha:"",encargado:"",codigo_compra:"",boleta:"",codigo_requerimiento:"",producto_id:"",categoria:"",cantidad:"",unidad:"",tipo:e,producto:"",almacen_id:"",codigo_pedido:"",costo:"",dni:"",costo_total:"",area_id:"",personal:"",retornable:""}},h=function(e,n){return{codigo:"",fecha_pedido:"",fecha_entrega:"",solicitante:"",area:"",celular:"",proyecto:"",producto_id:"",cantidad:"",unidad:"",estado:"",producto:"",personal:"",dni:""}},b=function(){return{id:"",nombre:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajador_dni:""}},g=function(){return{id:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajadores:[]}},_=function(){return{id:"",razon_social:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"casa"}},Z=function(){return{id:"",nombre:"",trabajador_dni:"",observacion:"",fecha_pago:new Date,hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:"",tipo:"extraordinario"}},x=function(){return{id:"",hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:""}},j=function(){return{id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"asociacion",contrato_id:"",asociacion:[]}}}}]);
//# sourceMappingURL=1670.9efef885.chunk.js.map