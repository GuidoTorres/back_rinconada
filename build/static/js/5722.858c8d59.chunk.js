"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[5722],{69967:function(e,a,n){n(72791);var t=n(49998),o=n(80184);a.Z=function(e){var a=e.className,n=e.title,r=e.open,i=e.width,c=e.closeModal,s=e.children;return(0,o.jsx)(t.Z,{destroyOnClose:!0,className:a,title:n,open:r,centered:!0,onCancel:c,footer:null,width:i,children:s})}},34287:function(e,a,n){n.r(a),n.d(a,{default:function(){return V}});var t=n(74165),o=n(15861),r=n(29439),i=n(66106),c=n(30914),s=n(34664),d=n(72791),u=n(78820),l=n(38411),p=n(53939),f=n(99763),m=n(64941),b=n(76487),h=n(83188),_=n(1413),v=n(70263),Z=n(43513),g=(n(51279),n(80184)),j=function(e){var a=e.columns,n=e.table,t=e.filas,o=a.map((function(e){return{title:e.name,dataIndex:"incentivo"===e.id?"teletrans":e.id,key:"incentivo"===e.id?"teletrans":e.id}})),r=n.map((function(e){var a=!1;return e.trabajadores.length<2&&(a=!0),(0,_.Z)((0,_.Z)({},e),{},{disabled:a})}));return(0,g.jsx)("div",{className:"table-container",children:(0,g.jsx)(Z.ZP,{size:"small",columns:a,data:r,pagination:!0,striped:!0,highlightOnHover:!0,responsive:!0,paginationComponentOptions:{rowsPerPageText:"Filas por p\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!1,selectAllRowsItemText:"Todos"},paginationPerPage:t||8,paginationRowsPerPageOptions:[8,16,24,32,40],expandableRows:!0,expandableRowsComponent:function(e){var a=e.data;return(0,g.jsx)(v.Z,{style:{border:"1px solid #B7EB8F"},size:"small",columns:o.filter((function(e){return"fecha_pago"!==e.key&&"observacion"!==e.key})),dataSource:a.trabajadores.map((function(e,a){return{key:a,Nro:a+1,incentivo:e.teletrans||"---",nombres:e.nombre||"---",teletrans:e.teletrans||"---",telefono:e.telefono||"---",dni:e.dni||"---",cargo:e.cargo||"---",area:e.area||"---"}})),pagination:!1})},expandableRowDisabled:function(e){return e.disabled}})})},x=n(4942),w=n(17615),y=n(83099),D=n(87309),T=n(16026),S=n(69967),C=n(63998),F=n(97892),A=n.n(F),E=n(93433),M=n(53655),N=n(77128),k=n(80458),Y=n(49389),z=n(58848),R=n(68588),I=n(36473),O=n(78792),P=n(2964),q=n(35790);var L=function(e){var a=e.open,n=e.closeModal,s=e.trabajadores,p=e.actualizarTabla,m=e.closeModalSubmit,b=void 0===m?function(){}:m,h=e.dataToEdit,v=e.setDataToEdit,Z=void 0===v?function(){}:v,j=w.Z.useForm(),C=(0,r.Z)(j,1)[0],F=M.Z.Text,L=(0,d.useContext)(l.s),B=L.updateData,V=L.createData,J=(0,d.useState)(!1),G=(0,r.Z)(J,2),H=G[0],K=G[1],X=s.map((function(e){return{value:e.id,label:e.nombre}})),U=(0,d.useState)([]),W=(0,r.Z)(U,2),Q=W[0],$=W[1],ee=(0,d.useState)([]),ae=(0,r.Z)(ee,2),ne=ae[0],te=ae[1];(0,d.useEffect)((function(){var e=s.filter((function(e){return Q.includes(e.id)}));te(e)}),[Q]);var oe=(0,d.useState)(T.XK),re=(0,r.Z)(oe,2),ie=re[0],ce=re[1],se=function(e,a){if(!a&&e.target){var n=e.target,t=n.name,o=n.value;C.setFieldsValue((0,x.Z)({},t,o)),ce((function(e){return(0,_.Z)((0,_.Z)({},e),{},(0,x.Z)({},t,o))}))}else C.setFieldsValue((0,x.Z)({},a,e)),ce((function(n){return(0,_.Z)((0,_.Z)({},n),{},(0,x.Z)({},a,e))}))},de=(0,d.useState)([]),ue=(0,r.Z)(de,2),le=ue[0],pe=ue[1];(0,d.useEffect)((function(){var e=ne.map((function(e){return{nombre:e.nombre,contrato_id:e.contrato_id,teletrans:e.teletrans||"",trabajador_dni:e.dni}}));pe(h?ie.trabajadores.map((function(e){return(0,_.Z)((0,_.Z)({},e),{},{teletrans:parseFloat(e.teletrans)})})):e)}),[ne]);var fe=function(){var e=0;return le.forEach((function(a){e+=a.teletrans})),e},me=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var a,n,o,r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="pago/programacion/multiple",K(!0),n={unidad_produccion:ie.unidad_produccion,observacion:ie.observacion,fecha_pago:A()(ie.fecha_pago).format("YYYY-MM-DD")||"",teletrans:fe(),tipo:"incentivo",trabajadores:le.map((function(e){return{contrato_id:e.contrato_id,teletrans:e.teletrans,trabajador_dni:e.trabajador_dni}}))},!h){e.next=10;break}return e.next=6,B(n,ie.pago_id,"pago/multiple");case 6:(o=e.sent)&&((0,f.q)(o.status,o.msg),p(),be()),e.next=14;break;case 10:return e.next=12,V(n,a);case 12:(r=e.sent)&&((0,f.q)(r.status,r.msg),p(),be());case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){h&&(ce((0,_.Z)((0,_.Z)({},h),{},{fecha_pago:A()(h.fecha_pago).format("YYYY-MM-DD")})),$(h.trabajadores.map((function(e){return e.nombre}))),pe(h.trabajadores))}),[h]);var be=function(){Z(null),n(),b()};return(0,g.jsx)(S.Z,{open:a,closeModal:h?be:n,title:"Juntar Teletrans",width:800,children:(0,g.jsxs)(w.Z,{form:C,className:"modal-body",onFinish:me,layout:"vertical",children:[(0,g.jsx)(N.Z,{orientation:"left",children:"Datos"}),(0,g.jsxs)(y.Z,{direction:"vertical",style:{width:"100%"},children:[(0,g.jsx)(w.Z.Item,{label:"Seleccione trabajadores",children:(0,g.jsx)(k.Z,{showSearch:!0,mode:"multiple",placeholder:"Seleccione trabajadores",style:{width:"100%"},allowClear:!0,value:Q,onChange:function(e){$(e)},options:X,disabled:!!h,filterOption:function(e,a){return a.label.toLowerCase().indexOf(e.toLowerCase())>=0}})}),(0,g.jsx)(w.Z.Item,{label:"Unidad Producci\xf3n",children:(0,g.jsx)(k.Z,{autoSize:!0,name:"unidad_produccion",dropdownMatchSelectWidth:!1,onChange:function(e){return se(e,"unidad_produccion")},options:[{label:"ANA MAR\xcdAS",value:"ANA MAR\xcdAS"},{label:"SANTA MARIA",value:"SANTA MARIA"},{label:"CORAZ\xd3N DE SAN FRANCISCO",value:"CORAZ\xd3N DE SAN FRANCISCO"},{label:"SAPO DE ORO",value:"SAPO DE ORO"}]})}),(0,g.jsx)(w.Z.Item,{label:"Observaci\xf3n",children:(0,g.jsx)(Y.Z.TextArea,{autoSize:!0,name:"observacion",label:"Observaciones",value:ie.observacion,onChange:se})}),(0,g.jsx)(w.Z.Item,{label:"Fecha",children:(0,g.jsx)(z.ZP,{locale:q.Z,children:(0,g.jsx)(R.Z,{allowClear:!1,value:A()(ie.fecha_pago),name:"fecha_pago",placeholder:"Fecha de Pago",picker:"day",onChange:function(e){return se(e,"fecha_pago")},style:{width:"100%"},format:"YYYY-MM-DD"})})})]}),(0,g.jsx)(N.Z,{orientation:"left",children:"Trabajadores"}),(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:(0,g.jsxs)(I.Z,{style:{width:"100%"},children:[(0,g.jsx)(O.ZP,{itemLayout:"horizontal",dataSource:le,renderItem:function(e){return(0,g.jsx)(O.ZP.Item,{children:(0,g.jsxs)(i.Z,{style:{width:"100%"},children:[(0,g.jsx)(c.Z,{span:18,children:(0,g.jsx)(y.Z,{direction:"vertical",children:e.nombre})}),(0,g.jsx)(c.Z,{span:6,children:(0,g.jsx)(y.Z,{direction:"vertical",children:(0,g.jsx)(Y.Z,{value:e.teletrans,placeholder:"Teletrans",type:"number",min:0,onChange:function(a){return function(e,a){var n=le.findIndex((function(e){return e.contrato_id===a}));le[n]=(0,_.Z)((0,_.Z)({},le[n]),{},{teletrans:parseFloat(e.target.value)}),pe((0,E.Z)(le))}(a,e.contrato_id)},required:!0})})})]},e.contrato_id)})}}),(0,g.jsxs)(y.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end",alignItems:"center",padding:24},children:[(0,g.jsx)(F,{type:fe()%4===0?"success":"danger",children:"TOTAL DE TELETRANS"}),(0,g.jsx)(P.Z,{message:fe(),type:fe()%4===0?"success":"error"})]})]})}),(0,g.jsxs)(y.Z,{direction:"horizontal",style:{width:"100%",marginTop:20,justifyContent:"end"},children:[(0,g.jsx)(D.ZP,{onClick:n,children:"Cancelar"}),(0,g.jsx)(D.ZP,{type:"primary",htmlType:"submit",icon:(0,g.jsx)(u.lFz,{}),loading:!!H,disabled:0===le.length,children:"Registrar"})]})]})})};var B=function(e){var a=e.actualizarTabla,n=e.modal,i=e.setModal,c=w.Z.useForm(),s=(0,r.Z)(c,1)[0],p=(0,d.useContext)(l.s),b=p.createData,h=p.getData,v=p.setDataToEdit,Z=p.dataToEdit,j=p.updateData,F=(0,d.useState)(T.Tc),E=(0,r.Z)(F,2),M=E[0],N=E[1],k=(0,d.useState)(!1),Y=(0,r.Z)(k,2),z=Y[0],R=Y[1],I=(0,d.useState)([]),O=(0,r.Z)(I,2),P=O[0],q=O[1],B=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("incentivo/trabajadores");case 2:a=e.sent,q(a.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){B()}),[]),(0,d.useEffect)((function(){Z?(N((0,_.Z)((0,_.Z)({},Z),{},{unidad_produccion:Z.unidad_produccion,nombre:Z.trabajadores[0].nombre,teletrans:parseFloat(Z.trabajadores[0].teletrans),observacion:Z.observacion,fecha_pago:A()(Z.fecha_pago).format("YYYY-MM-DD")})),s.setFieldsValue((0,_.Z)((0,_.Z)({},Z),{},{unidad_produccion:Z.unidad_produccion,nombre:Z.trabajadores[0].nombre,teletrans:parseFloat(Z.trabajadores[0].teletrans),observacion:Z.observacion,fecha_pago:A()(Z.fecha_pago).format("YYYY-MM-DD")}))):N(T.Tc)}),[Z]);var V=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var n,o,r,i,c;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="pago/programacion/multiple",R(!0),o=[{contrato_id:M.contrato_id||"",teletrans:parseFloat(M.teletrans)||0,trabajador_dni:M.trabajador_dni}],r={unidad_produccion:M.unidad_produccion||"",observacion:M.observacion||"",fecha_pago:A()(M.fecha_pago).format("YYYY-MM-DD")||"",tipo:M.tipo||"incentivo",teletrans:parseFloat(M.teletrans)||0,trabajadores:o},!Z){e.next=11;break}return e.next=7,j(r,Z.pago_id,"pago");case 7:(i=e.sent)&&((0,f.q)(i.status,i.msg),a(),J()),e.next=15;break;case 11:return e.next=13,b(r,n);case 13:(c=e.sent)&&((0,f.q)(c.status,c.msg),a(),J());case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){i(!1),v(null),R(!1),N(T.Tc)},G=(0,C.gG)(M,(function(e,a){if(!a&&e.target){var n=e.target,t=n.name,o=n.value;s.setFieldsValue((0,x.Z)({},t,o)),N((function(e){return(0,_.Z)((0,_.Z)({},e),{},(0,x.Z)({},t,o))}))}else s.setFieldsValue((0,x.Z)({},a,e)),N((function(n){return(0,_.Z)((0,_.Z)({},n),{},(0,x.Z)({},a,e))}))}),P,Z),H=(0,d.useState)(!1),K=(0,r.Z)(H,2),X=K[0],U=K[1];return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(S.Z,{className:"modal-usuario",title:Z?"Editar incentivo":"Registrar incentivo",open:n,width:400,closeModal:J,children:[!Z&&(0,g.jsx)(y.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end"},children:(0,g.jsx)(m.Z,{title:"Juntar Teletrans",onClick:function(){U(!0)},icon:(0,g.jsx)(u.FDz,{})})}),(0,g.jsxs)(w.Z,{form:s,className:"modal-body",onFinish:V,layout:"horizontal",children:[G.map((function(e,a){return(0,g.jsx)(w.Z.Item,{className:e.className,name:e.name,rules:e.rules,style:{marginBottom:"8px"},children:(0,g.jsxs)(g.Fragment,{children:[e.label,e.type]})},a)})),(0,g.jsx)(w.Z.Item,{className:"button-container",children:(0,g.jsx)(D.ZP,{htmlType:"submit",icon:(0,g.jsx)(u.lFz,{}),loading:!!z,children:Z?"Editar":"Registrar"})})]})]}),X&&(0,g.jsx)(L,{open:X,closeModal:function(){U(!1)},trabajadores:P,actualizarTabla:a,closeModalSubmit:J})]})},V=function(){var e=(0,d.useContext)(l.s),a=e.getData,n=e.dataToEdit,_=e.setDataToEdit,v=e.deleteData,Z=(0,d.useState)(!1),x=(0,r.Z)(Z,2),w=x[0],y=x[1],D=(0,d.useState)(!1),T=(0,r.Z)(D,2),S=T[0],C=T[1],F=(0,d.useState)([]),A=(0,r.Z)(F,2),E=A[0],M=A[1],N=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var n,o;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("incentivo");case 2:(n=e.sent)&&(o=n.data.filter((function(e){return null!==e})),M(o),y(!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=(0,d.useState)([]),Y=(0,r.Z)(k,2),z=Y[0],R=Y[1],I=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("incentivo/trabajadores");case 2:n=e.sent,R(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){N(),I()}),[]);var O=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(a){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("pago",a);case 2:(n=e.sent)&&((0,f.q)(n.status,n.msg),N());case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),P=(0,p.Oh)((function(e){e.trabajadores.length>1?H(!0):C(!0),_(e)}),O),q=(0,d.useState)(!1),V=(0,r.Z)(q,2),J=V[0],G=V[1],H=function(){G(!0)};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(h.Z,{text:"Incentivos",ruta:"/planilla"}),(0,g.jsxs)("div",{className:"margenes",children:[(0,g.jsxs)(i.Z,{align:"middle",children:[(0,g.jsx)(c.Z,{span:18}),(0,g.jsx)(c.Z,{span:6,align:"end",children:(0,g.jsx)(m.Z,{title:"Crear incentivo",onClick:function(){return C(!0)},icon:(0,g.jsx)(u.lFz,{})})})]}),(null===E||void 0===E?void 0:E.length)>0?(0,g.jsx)(j,{columns:P,table:E}):(0,g.jsx)(g.Fragment,{children:w?(0,g.jsx)(b.Z,{}):(0,g.jsx)(s.Z,{image:s.Z.PRESENTED_IMAGE_SIMPLE,description:(0,g.jsx)("span",{children:"No hay registros para mostrar."})})})]}),S&&(0,g.jsx)(B,{actualizarTabla:N,modal:S,setModal:C}),J&&(0,g.jsx)(L,{closeModal:function(){G(!1)},open:J,actualizarTabla:N,dataToEdit:n,setDataToEdit:_,trabajadores:z})]})}},16026:function(e,a,n){n.d(a,{Bq:function(){return m},FH:function(){return o},FN:function(){return t},JL:function(){return r},LR:function(){return d},Md:function(){return l},Oj:function(){return i},TT:function(){return h},Tc:function(){return _},XK:function(){return v},bf:function(){return x},cB:function(){return g},d_:function(){return u},eJ:function(){return s},eT:function(){return Z},g5:function(){return c},kb:function(){return f},n4:function(){return j},s:function(){return p},v2:function(){return b}});var t={nombre:"",usuario:"",contrasenia:"",estado:""},o={nombre:""},r={nombre:"",direccion:""},i=function(){return{dni:"",codigo_trabajador:"",fecha_nacimiento:"",telefono:"",nombre:"",apellido_paterno:"",apellido_materno:"",email:"",estado_civil:"",genero:"",direccion:"",asociacion_id:null,eliminar:!1}},c=function(e){return{fecha_evaluacion:"",capacitacion_sso:"",capacitacion_gema:"",evaluacion_laboral:"",presion_arterial:"",temperatura:"",saturacion:"",imc:"",pulso:"",diabetes:"",antecedentes:"",emo:"",trabajador_id:e.dni,aprobado:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",fiscalizador:"",fiscalizador_aprobado:"no",control:"no",topico:"no",seguridad:"no",medio_ambiente:"no",recursos_humanos:"no",topico_observacion:"",control_observacion:"",seguridad_observacion:"",medio_ambiente_observacion:"",recursos_humanos_observacion:"",finalizado:!1,gerencia_id:"",area_id:"",puesto_id:"",campamento_id:""}},s=function(e,a){var n;return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",asociacion_id:e&&(null===e||void 0===e?void 0:e.id),estado:!1,evaluacion_id:a,trabajadores:null===e||void 0===e||null===(n=e.trabajador)||void 0===n?void 0:n.map((function(e){return e.dni})),tareo:""}},d=function(e){return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia:"",area:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto:"",estado:!1,empresa_id:e}},u=function(e){return{sucursal_id:e,fecha:"",movimiento:"",forma_pago:"",encargado:"",area:"",cantidad:"",medida:"",descripcion:"",monto:"",proveedor:"",comprobante:"",dni:"",sucursal_transferencia:"",precio:""}},l={nombre:""},p={nombre:"",codigo:"",descripcion:"",saldo_inicial:""},f={nombre:"",codigo:"",descripcion:""},m=function(e,a){return{codigo:parseInt(a)+1,nombre:"",codigo_interno:"",codigo_barras:"",descripcion:"",categoria_id:"",unidad_id:"",precio:"",fecha:"",observacion:"",almacen_id:"",stock:"0",costo_total:""}},b=function(e){return{codigo:"",motivo:"",fecha:"",encargado:"",codigo_compra:"",boleta:"",codigo_requerimiento:"",producto_id:"",categoria:"",cantidad:"",unidad:"",tipo:e,producto:"",almacen_id:"",codigo_pedido:"",costo:"",dni:"",costo_total:"",area_id:"",personal:"",retornable:""}},h=function(e,a){return{codigo:"",fecha_pedido:"",fecha_entrega:"",solicitante:"",area:"",celular:"",proyecto:"",producto_id:"",cantidad:"",unidad:"",estado:"",producto:"",personal:"",dni:""}},_=function(){return{id:"",nombre:"",contrato_id:"",observacion:"",unidad_produccion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajador_dni:""}},v=function(){return{id:"",unidad_produccion:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajadores:[]}},Z=function(){return{id:"",unidad_produccion:"",razon_social:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"casa"}},g=function(){return{id:"",nombre:"",trabajador_dni:"",observacion:"",fecha_pago:new Date,hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:"",tipo:"extraordinario"}},j=function(){return{id:"",hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:""}},x=function(){return{id:"",unidad_produccion:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"asociacion",contrato_id:"",asociacion:[]}}}}]);
//# sourceMappingURL=5722.858c8d59.chunk.js.map