"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[5722],{69967:function(e,a,t){t(72791);var n=t(49998),o=t(80184);a.Z=function(e){var a=e.className,t=e.title,r=e.open,i=e.width,c=e.closeModal,s=e.children;return(0,o.jsx)(n.Z,{destroyOnClose:!0,className:a,title:t,open:r,centered:!0,onCancel:c,footer:null,width:i,children:s})}},34287:function(e,a,t){t.r(a),t.d(a,{default:function(){return V}});var n=t(74165),o=t(15861),r=t(29439),i=t(66106),c=t(30914),s=t(34664),l=t(72791),d=t(78820),u=t(38411),f=t(53939),p=t(99763),m=t(64941),h=t(76487),b=t(83188),v=t(1413),_=t(70263),Z=t(43513),g=(t(51279),t(80184)),j=function(e){var a=e.columns,t=e.table,n=e.filas,o=a.map((function(e){return{title:e.name,dataIndex:"incentivo"===e.id?"teletrans":e.id,key:"incentivo"===e.id?"teletrans":e.id}})),r=t.map((function(e){var a=!1;return e.trabajadores.length<2&&(a=!0),(0,v.Z)((0,v.Z)({},e),{},{disabled:a})}));return(0,g.jsx)("div",{className:"table-container",children:(0,g.jsx)(Z.ZP,{size:"small",columns:a,data:r,pagination:!0,striped:!0,highlightOnHover:!0,responsive:!0,paginationComponentOptions:{rowsPerPageText:"Filas por p\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!1,selectAllRowsItemText:"Todos"},paginationPerPage:n||8,paginationRowsPerPageOptions:[8,16,24,32,40],expandableRows:!0,expandableRowsComponent:function(e){var a=e.data;return(0,g.jsx)(_.Z,{style:{border:"1px solid #B7EB8F"},size:"small",columns:o.filter((function(e){return"fecha_pago"!==e.key&&"observacion"!==e.key})),dataSource:a.trabajadores.map((function(e,a){return{key:a,Nro:a+1,incentivo:e.teletrans||"---",nombres:e.nombre||"---",teletrans:e.teletrans||"---",telefono:e.telefono||"---",dni:e.dni||"---",cargo:e.cargo||"---",area:e.area||"---"}})),pagination:!1})},expandableRowDisabled:function(e){return e.disabled}})})},x=t(4942),w=t(17615),y=t(83099),D=t(87309),T=t(16026),S=t(69967),C=t(63998),F=t(97892),E=t.n(F),M=t(93433),A=t(53655),N=t(77128),k=t(80458),Y=t(58848),R=t(68588),z=t(36473),I=t(78792),O=t(49389),P=t(2964),q=t(35790);var L=function(e){var a=e.open,t=e.closeModal,s=e.trabajadores,f=e.actualizarTabla,m=e.closeModalSubmit,h=void 0===m?function(){}:m,b=e.dataToEdit,_=e.setDataToEdit,Z=void 0===_?function(){}:_,j=w.Z.useForm(),C=(0,r.Z)(j,1)[0],F=A.Z.Text,L=(0,l.useContext)(u.s),B=L.updateData,V=L.createData,J=(0,l.useState)(!1),G=(0,r.Z)(J,2),H=G[0],K=G[1],X=s.map((function(e){return{value:e.id,label:e.nombre}})),W=(0,l.useState)([]),Q=(0,r.Z)(W,2),U=Q[0],$=Q[1],ee=(0,l.useState)([]),ae=(0,r.Z)(ee,2),te=ae[0],ne=ae[1];(0,l.useEffect)((function(){var e=s.filter((function(e){return U.includes(e.id)}));ne(e)}),[U]);var oe=(0,l.useState)(T.XK),re=(0,r.Z)(oe,2),ie=re[0],ce=re[1],se=function(e,a){if(!a&&e.target){var t=e.target,n=t.name,o=t.value;C.setFieldsValue((0,x.Z)({},n,o)),ce((function(e){return(0,v.Z)((0,v.Z)({},e),{},(0,x.Z)({},n,o))}))}else C.setFieldsValue((0,x.Z)({},a,e)),ce((function(t){return(0,v.Z)((0,v.Z)({},t),{},(0,x.Z)({},a,e))}))},le=(0,l.useState)([]),de=(0,r.Z)(le,2),ue=de[0],fe=de[1];(0,l.useEffect)((function(){var e=te.map((function(e){return{nombre:e.nombre,contrato_id:e.contrato_id,teletrans:e.teletrans||"",trabajador_dni:e.dni}}));fe(b?ie.trabajadores.map((function(e){return(0,v.Z)((0,v.Z)({},e),{},{teletrans:parseFloat(e.teletrans)})})):e)}),[te]);var pe=function(){var e=0;return ue.forEach((function(a){e+=a.teletrans})),e},me=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var a,t,o,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="pago/programacion/multiple",K(!0),t={observacion:ie.observacion,fecha_pago:E()(ie.fecha_pago).format("YYYY-MM-DD")||"",teletrans:pe(),tipo:"incentivo",trabajadores:ue.map((function(e){return{contrato_id:e.contrato_id,teletrans:e.teletrans,trabajador_dni:e.trabajador_dni}}))},!b){e.next=10;break}return e.next=6,B(t,ie.pago_id,"pago/multiple");case 6:(o=e.sent)&&((0,p.q)(o.status,o.msg),f(),he()),e.next=14;break;case 10:return e.next=12,V(t,a);case 12:(r=e.sent)&&((0,p.q)(r.status,r.msg),f(),he());case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){b&&(ce((0,v.Z)((0,v.Z)({},b),{},{fecha_pago:E()(b.fecha_pago).format("YYYY-MM-DD")})),$(b.trabajadores.map((function(e){return e.nombre}))),fe(b.trabajadores))}),[b]);var he=function(){Z(null),t(),h()};return(0,g.jsx)(S.Z,{open:a,closeModal:b?he:t,title:"Juntar Teletrans",width:800,children:(0,g.jsxs)(w.Z,{form:C,className:"modal-body",onFinish:me,layout:"vertical",children:[(0,g.jsx)(N.Z,{orientation:"left",children:"Datos"}),(0,g.jsxs)(y.Z,{direction:"vertical",style:{width:"100%"},children:[(0,g.jsx)(w.Z.Item,{label:"Seleccione trabajadores",children:(0,g.jsx)(k.Z,{showSearch:!0,mode:"multiple",placeholder:"Seleccione trabajadores",style:{width:"100%"},allowClear:!0,value:U,onChange:function(e){$(e)},options:X,disabled:!!b,filterOption:function(e,a){return a.label.toLowerCase().indexOf(e.toLowerCase())>=0}})}),(0,g.jsx)(w.Z.Item,{label:"Observaci\xf3n",children:(0,g.jsx)(k.Z,{autoSize:!0,name:"observacion",dropdownMatchSelectWidth:!1,onChange:function(e){return se(e,"observacion")},options:[{label:"ANA MAR\xcdAS",value:"ANA MAR\xcdAS"},{label:"SANTA MARIA",value:"SANTA MARIA"},{label:"CORAZ\xd3N DE SAN FRANCISCO",value:"CORAZ\xd3N DE SAN FRANCISCO"},{label:"SAPO DE ORO",value:"SAPO DE ORO"}]})}),(0,g.jsx)(w.Z.Item,{label:"Fecha",children:(0,g.jsx)(Y.ZP,{locale:q.Z,children:(0,g.jsx)(R.Z,{allowClear:!1,value:E()(ie.fecha_pago),name:"fecha_pago",placeholder:"Fecha de Pago",picker:"day",onChange:function(e){return se(e,"fecha_pago")},style:{width:"100%"},format:"YYYY-MM-DD"})})})]}),(0,g.jsx)(N.Z,{orientation:"left",children:"Trabajadores"}),(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:(0,g.jsxs)(z.Z,{style:{width:"100%"},children:[(0,g.jsx)(I.ZP,{itemLayout:"horizontal",dataSource:ue,renderItem:function(e){return(0,g.jsx)(I.ZP.Item,{children:(0,g.jsxs)(i.Z,{style:{width:"100%"},children:[(0,g.jsx)(c.Z,{span:18,children:(0,g.jsx)(y.Z,{direction:"vertical",children:e.nombre})}),(0,g.jsx)(c.Z,{span:6,children:(0,g.jsx)(y.Z,{direction:"vertical",children:(0,g.jsx)(O.Z,{value:e.teletrans,placeholder:"Teletrans",type:"number",min:0,onChange:function(a){return function(e,a){var t=ue.findIndex((function(e){return e.contrato_id===a}));ue[t]=(0,v.Z)((0,v.Z)({},ue[t]),{},{teletrans:parseFloat(e.target.value)}),fe((0,M.Z)(ue))}(a,e.contrato_id)},required:!0})})})]},e.contrato_id)})}}),(0,g.jsxs)(y.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end",alignItems:"center",padding:24},children:[(0,g.jsx)(F,{type:pe()%4===0?"success":"danger",children:"TOTAL DE TELETRANS"}),(0,g.jsx)(P.Z,{message:pe(),type:pe()%4===0?"success":"error"})]})]})}),(0,g.jsxs)(y.Z,{direction:"horizontal",style:{width:"100%",marginTop:20,justifyContent:"end"},children:[(0,g.jsx)(D.ZP,{onClick:t,children:"Cancelar"}),(0,g.jsx)(D.ZP,{type:"primary",htmlType:"submit",icon:(0,g.jsx)(d.lFz,{}),loading:!!H,disabled:0===ue.length,children:"Registrar"})]})]})})};var B=function(e){var a=e.actualizarTabla,t=e.modal,i=e.setModal,c=w.Z.useForm(),s=(0,r.Z)(c,1)[0],f=(0,l.useContext)(u.s),h=f.createData,b=f.getData,_=f.setDataToEdit,Z=f.dataToEdit,j=f.updateData,F=(0,l.useState)(T.Tc),M=(0,r.Z)(F,2),A=M[0],N=M[1],k=(0,l.useState)(!1),Y=(0,r.Z)(k,2),R=Y[0],z=Y[1],I=(0,l.useState)([]),O=(0,r.Z)(I,2),P=O[0],q=O[1],B=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("incentivo/trabajadores");case 2:a=e.sent,q(a.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){B()}),[]),(0,l.useEffect)((function(){Z?(N((0,v.Z)((0,v.Z)({},Z),{},{nombre:Z.trabajadores[0].nombre,teletrans:parseFloat(Z.trabajadores[0].teletrans),observacion:Z.observacion,fecha_pago:E()(Z.fecha_pago).format("YYYY-MM-DD")})),s.setFieldsValue((0,v.Z)((0,v.Z)({},Z),{},{nombre:Z.trabajadores[0].nombre,teletrans:parseFloat(Z.trabajadores[0].teletrans),observacion:Z.observacion,fecha_pago:E()(Z.fecha_pago).format("YYYY-MM-DD")}))):N(T.Tc)}),[Z]);var V=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var t,o,r,i,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="pago/programacion/multiple",z(!0),o=[{contrato_id:A.contrato_id||"",teletrans:parseFloat(A.teletrans)||0,trabajador_dni:A.trabajador_dni}],r={observacion:A.observacion||"",fecha_pago:E()(A.fecha_pago).format("YYYY-MM-DD")||"",tipo:A.tipo||"incentivo",teletrans:parseFloat(A.teletrans)||0,trabajadores:o},!Z){e.next=11;break}return e.next=7,j(r,Z.pago_id,"pago");case 7:(i=e.sent)&&((0,p.q)(i.status,i.msg),a(),J()),e.next=15;break;case 11:return e.next=13,h(r,t);case 13:(c=e.sent)&&((0,p.q)(c.status,c.msg),a(),J());case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){i(!1),_(null),z(!1),N(T.Tc)},G=(0,C.gG)(A,(function(e,a){if(!a&&e.target){var t=e.target,n=t.name,o=t.value;s.setFieldsValue((0,x.Z)({},n,o)),N((function(e){return(0,v.Z)((0,v.Z)({},e),{},(0,x.Z)({},n,o))}))}else s.setFieldsValue((0,x.Z)({},a,e)),N((function(t){return(0,v.Z)((0,v.Z)({},t),{},(0,x.Z)({},a,e))}))}),P,Z),H=(0,l.useState)(!1),K=(0,r.Z)(H,2),X=K[0],W=K[1];return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(S.Z,{className:"modal-usuario",title:Z?"Editar incentivo":"Registrar incentivo",open:t,width:400,closeModal:J,children:[!Z&&(0,g.jsx)(y.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end"},children:(0,g.jsx)(m.Z,{title:"Juntar Teletrans",onClick:function(){W(!0)},icon:(0,g.jsx)(d.FDz,{})})}),(0,g.jsxs)(w.Z,{form:s,className:"modal-body",onFinish:V,layout:"horizontal",children:[G.map((function(e,a){return(0,g.jsx)(w.Z.Item,{className:e.className,name:e.name,rules:e.rules,style:{marginBottom:"8px"},children:(0,g.jsxs)(g.Fragment,{children:[e.label,e.type]})},a)})),(0,g.jsx)(w.Z.Item,{className:"button-container",children:(0,g.jsx)(D.ZP,{htmlType:"submit",icon:(0,g.jsx)(d.lFz,{}),loading:!!R,children:Z?"Editar":"Registrar"})})]})]}),X&&(0,g.jsx)(L,{open:X,closeModal:function(){W(!1)},trabajadores:P,actualizarTabla:a,closeModalSubmit:J})]})},V=function(){var e=(0,l.useContext)(u.s),a=e.getData,t=e.dataToEdit,v=e.setDataToEdit,_=e.deleteData,Z=(0,l.useState)(!1),x=(0,r.Z)(Z,2),w=x[0],y=x[1],D=(0,l.useState)(!1),T=(0,r.Z)(D,2),S=T[0],C=T[1],F=(0,l.useState)([]),E=(0,r.Z)(F,2),M=E[0],A=E[1],N=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var t,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("incentivo");case 2:(t=e.sent)&&(o=t.data.filter((function(e){return null!==e})),A(o),y(!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=(0,l.useState)([]),Y=(0,r.Z)(k,2),R=Y[0],z=Y[1],I=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("incentivo/trabajadores");case 2:t=e.sent,z(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){N(),I()}),[]);var O=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(a){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("pago",a);case 2:(t=e.sent)&&((0,p.q)(t.status,t.msg),N());case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),P=(0,f.Oh)((function(e){e.trabajadores.length>1?H(!0):C(!0),v(e)}),O),q=(0,l.useState)(!1),V=(0,r.Z)(q,2),J=V[0],G=V[1],H=function(){G(!0)};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(b.Z,{text:"Incentivos",ruta:"/planilla"}),(0,g.jsxs)("div",{className:"margenes",children:[(0,g.jsxs)(i.Z,{align:"middle",children:[(0,g.jsx)(c.Z,{span:18}),(0,g.jsx)(c.Z,{span:6,align:"end",children:(0,g.jsx)(m.Z,{title:"Crear incentivo",onClick:function(){return C(!0)},icon:(0,g.jsx)(d.lFz,{})})})]}),(null===M||void 0===M?void 0:M.length)>0?(0,g.jsx)(j,{columns:P,table:M}):(0,g.jsx)(g.Fragment,{children:w?(0,g.jsx)(h.Z,{}):(0,g.jsx)(s.Z,{image:s.Z.PRESENTED_IMAGE_SIMPLE,description:(0,g.jsx)("span",{children:"No hay registros para mostrar."})})})]}),S&&(0,g.jsx)(B,{actualizarTabla:N,modal:S,setModal:C}),J&&(0,g.jsx)(L,{closeModal:function(){G(!1)},open:J,actualizarTabla:N,dataToEdit:t,setDataToEdit:v,trabajadores:R})]})}},16026:function(e,a,t){t.d(a,{Bq:function(){return m},FH:function(){return o},FN:function(){return n},JL:function(){return r},LR:function(){return l},Md:function(){return u},Oj:function(){return i},TT:function(){return b},Tc:function(){return v},XK:function(){return _},bf:function(){return x},cB:function(){return g},d_:function(){return d},eJ:function(){return s},eT:function(){return Z},g5:function(){return c},kb:function(){return p},n4:function(){return j},s:function(){return f},v2:function(){return h}});var n={nombre:"",usuario:"",contrasenia:"",estado:""},o={nombre:""},r={nombre:"",direccion:""},i=function(){return{dni:"",codigo_trabajador:"",fecha_nacimiento:"",telefono:"",nombre:"",apellido_paterno:"",apellido_materno:"",email:"",estado_civil:"",genero:"",direccion:"",asociacion_id:null,eliminar:!1}},c=function(e){return{fecha_evaluacion:"",capacitacion_sso:"",capacitacion_gema:"",evaluacion_laboral:"",presion_arterial:"",temperatura:"",saturacion:"",imc:"",pulso:"",diabetes:"",antecedentes:"",emo:"",trabajador_id:e.dni,aprobado:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",fiscalizador:"",fiscalizador_aprobado:"no",control:"no",topico:"no",seguridad:"no",medio_ambiente:"no",recursos_humanos:"no",topico_observacion:"",control_observacion:"",seguridad_observacion:"",medio_ambiente_observacion:"",recursos_humanos_observacion:"",finalizado:!1,gerencia_id:"",area_id:"",puesto_id:"",campamento_id:""}},s=function(e,a){var t;return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",asociacion_id:e&&(null===e||void 0===e?void 0:e.id),estado:!1,evaluacion_id:a,trabajadores:null===e||void 0===e||null===(t=e.trabajador)||void 0===t?void 0:t.map((function(e){return e.dni})),tareo:""}},l=function(e){return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia:"",area:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto:"",estado:!1,empresa_id:e}},d=function(e){return{sucursal_id:e,fecha:"",movimiento:"",forma_pago:"",encargado:"",area:"",cantidad:"",medida:"",descripcion:"",monto:"",proveedor:"",comprobante:"",dni:"",sucursal_transferencia:"",precio:""}},u={nombre:""},f={nombre:"",codigo:"",descripcion:"",saldo_inicial:""},p={nombre:"",codigo:"",descripcion:""},m=function(e,a){return{codigo:parseInt(a)+1,nombre:"",codigo_interno:"",codigo_barras:"",descripcion:"",categoria_id:"",unidad_id:"",precio:"",fecha:"",observacion:"",almacen_id:"",stock:"0",costo_total:""}},h=function(e){return{codigo:"",motivo:"",fecha:"",encargado:"",codigo_compra:"",boleta:"",codigo_requerimiento:"",producto_id:"",categoria:"",cantidad:"",unidad:"",tipo:e,producto:"",almacen_id:"",codigo_pedido:"",costo:"",dni:"",costo_total:"",area_id:"",personal:"",retornable:""}},b=function(e,a){return{codigo:"",fecha_pedido:"",fecha_entrega:"",solicitante:"",area:"",celular:"",proyecto:"",producto_id:"",cantidad:"",unidad:"",estado:"",producto:"",personal:"",dni:""}},v=function(){return{id:"",nombre:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajador_dni:""}},_=function(){return{id:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajadores:[]}},Z=function(){return{id:"",razon_social:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"casa"}},g=function(){return{id:"",nombre:"",trabajador_dni:"",observacion:"",fecha_pago:new Date,hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:"",tipo:"extraordinario"}},j=function(){return{id:"",hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:""}},x=function(){return{id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"asociacion",contrato_id:"",asociacion:[]}}}}]);
//# sourceMappingURL=5722.30f13b54.chunk.js.map