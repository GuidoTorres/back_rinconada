"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[8886],{21798:function(e,o,n){n(72791);var i=n(78820),t=(n(38411),n(49389)),a=n(87690),d=n(80184),r=t.Z.Search;o.Z=function(e){var o=e.abrirModal,n=(e.modal,e.filterText);return(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,d.jsx)(r,{placeholder:"Ingresa un producto aqui",onChange:function(e){return n(e.target.value)},style:{width:300}}),(0,d.jsx)("div",{className:"button-container",children:(0,d.jsx)(a.Z,{text:"Registrar",state:o,icon:(0,d.jsx)(i.lFz,{})})})]})}},5745:function(e,o,n){n.r(o),n.d(o,{default:function(){return P}});var i=n(74165),t=n(15861),a=n(29439),d=n(72791),r=n(38411),l=n(53939),u=n(83188),c=n(4808),s=(n(28938),n(49389)),v=n(78820),p=n(39126),f=n(87690),m=n(80184),g=s.Z.Search,h=function(e){var o=e.abrirModal,n=e.abrirEntrada,i=e.abrirSalida,t=e.abrirRequerimiento,a=(0,d.useContext)(r.s),l=a.setFilterText,u=(a.filterText,a.getDataById,a.setTipo,a.tipo);return(0,d.useEffect)((function(){"entrada"===u&&n(!0),"salida"===u&&i(!0)}),[u]),(0,m.jsxs)("div",{className:"buscador-inventario",children:[(0,m.jsx)(g,{placeholder:"Ingresa un producto aqui",onChange:function(e){return l(e.target.value)},style:{width:300}}),(0,m.jsxs)("div",{children:[(0,m.jsx)(f.Z,{text:"Registrar Producto",state:o,icon:(0,m.jsx)(v.lFz,{})}),(0,m.jsx)(f.Z,{text:"Entradas",state:n,icon:(0,m.jsx)(p.S9U,{}),tipo:"entrada"}),(0,m.jsx)(f.Z,{text:"Salidas",state:i,icon:(0,m.jsx)(p.mXI,{}),tipo:"salida"}),(0,m.jsx)(f.Z,{text:"Requerimientos",state:t,icon:(0,m.jsx)(v.lFz,{})})]})]})},x=n(4942),Z=n(1413),b=n(16026),_=n(8034),j=n(17615),C=n(49998),q=n(87309),w=n(63998),S=n(99763),k=function(e){var o=e.actualizarTabla,n=e.id,l=e.modal,u=e.setModal,c=j.Z.useForm(),s=(0,a.Z)(c,1)[0],p=(0,d.useContext)(r.s),f=p.dataToEdit,g=(p.createData,p.setDataToEdit),h=(p.updateData,p.getData),k=p.cargando,F=(p.setCargando,(0,d.useState)([])),E=(0,a.Z)(F,2),y=E[0],I=E[1],N=(0,d.useState)([]),D=(0,a.Z)(N,2),L=D[0],M=D[1],T=(0,d.useState)(""),P=(0,a.Z)(T,2),z=P[0],O=P[1],R=(0,d.useState)([]),V=(0,a.Z)(R,2),B=V[0],U=V[1],A=(0,d.useState)(null),H=(0,a.Z)(A,2),G=H[0],W=H[1],X=(0,b.Bq)(n,z),K=(0,d.useState)(X),J=(0,a.Z)(K,2),Q=J[0],Y=J[1],$=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(){var o,n,t,a,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"unidad",o="producto",n="categoria",e.next=5,h("unidad");case 5:return t=e.sent,e.next=8,h(o);case 8:return a=e.sent,e.next=11,h(n);case 11:d=e.sent,I(t.data),M(a.data),U(d.data);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){$()}),[]),(0,d.useEffect)((function(){Y((function(e){return(0,Z.Z)((0,Z.Z)({},e),{},{almacen_id:n})}))}),[n]),(0,d.useEffect)((function(){if(0!==L.length){var e=L.at(-1).id;O(e)}else O(0)}),[L]);var ee=function(){u(!1),g(null),Y(X),W(null),s.setFieldsValue({})};(0,d.useEffect)((function(){null!==f?(Y(f),s.setFieldsValue(f)):Y(X)}),[f]);var oe=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(t){var a,d,r,l,u,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==f){e.next=25;break}return(a=new FormData).set("almacen_id",Q.almacen_id||n),a.set("categoria_id",Q.categoria_id||""),a.set("codigo",parseInt(z)+1||""),a.set("codigo_barras",Q.codigo_barras||""),a.set("codigo_interno",Q.codigo_interno||""),a.set("costo_total",Q.costo_total||""),a.set("descripcion",Q.descripcion||""),a.set("fecha",Q.fecha||""),a.set("nombre",Q.nombre||""),a.set("observacion",Q.observacion||""),a.set("precio",Q.precio||""),a.set("stock",Q.stock||""),a.set("unidad_id",Q.unidad_id||""),(null===G||void 0===G?void 0:G.file)&&a.set("image",G.file||""),e.next=18,fetch("".concat("http://13.58.131.42:3000/api/v1","/producto"),{method:"POST",body:a});case 18:return d=e.sent,e.next=21,d.json();case 21:(r=e.sent)&&((0,S.q)(r.status,r.msg),ee(),o()),e.next=48;break;case 25:return(l=new FormData).append("almacen_id",Q.almacen_id||n),l.append("categoria_id",Q.categoria_id||""),l.append("codigo",parseInt(z)+1||""),l.append("codigo_barras",Q.codigo_barras||""),l.append("codigo_interno",Q.codigo_interno||""),l.append("costo_total",Q.costo_total||""),l.append("descripcion",Q.descripcion||""),l.append("fecha",Q.fecha||""),l.append("nombre",Q.nombre||""),l.append("observacion",Q.observacion||""),l.append("precio",Q.precio||""),l.append("stock",Q.stock||""),l.append("unidad_id",Q.unidad_id||""),l.set("foto",Q.foto||""),(null===G||void 0===G?void 0:G.file)&&l.set("image",G.file||""),e.next=43,fetch("".concat("http://13.58.131.42:3000/api/v1","/producto/").concat(f.id),{method:"PUT",body:l});case 43:return u=e.sent,e.next=46,u.json();case 46:(c=e.sent)&&((0,S.q)(c.status,c.msg),ee(),o());case 48:case"end":return e.stop()}}),e)})));return function(o){return e.apply(this,arguments)}}(),ne=(0,w.qZ)(Q,(function(e,o){if(!o&&e.target){var n=e.target,i=n.name,t=n.value;s.setFieldsValue((0,x.Z)({},i,t)),Y((function(e){return(0,Z.Z)((0,Z.Z)({},e),{},(0,x.Z)({},i,t))}))}else s.setFieldsValue((0,x.Z)({},o,e)),Y((function(n){return(0,Z.Z)((0,Z.Z)({},n),{},(0,x.Z)({},o,e))}))}),z,B,y);return(0,m.jsx)(C.Z,{className:"modal-producto",title:f?"Editar producto":"Registrar producto",open:l,centered:!0,onCancel:ee,footer:!1,width:800,children:(0,m.jsxs)(j.Z,{form:s,className:"modal-body",onFinish:oe,layout:"horizontal",children:[(0,m.jsxs)("section",{children:[(0,m.jsx)("div",{className:"inputs",children:ne.map((function(e,o){return(0,m.jsx)(j.Z.Item,{className:"item",name:e.name,rules:e.rules,style:{marginBottom:"8px"},children:(0,m.jsxs)(m.Fragment,{children:[e.label,e.type]})},o)}))}),(0,m.jsx)("div",{className:"image",children:(0,m.jsx)(_.Z,{avatar:G,setAvatar:W,selected:f})})]}),(0,m.jsx)(j.Z.Item,{className:"button-container",children:(0,m.jsx)(q.ZP,{onClick:oe,icon:(0,m.jsx)(v.lFz,{}),loading:!!k,children:f?"Editar":"Registrar"})})]})})},F=n(96972),E=n(95579),y=n(80458),I=n(21798),N=n(93433),D=(n(97892),function(e){var o,n=e.almacen_id,u=e.actualizarTabla,p=e.productos,f=e.actualizarProductos,g=e.modal2,h=e.setModal2,_=j.Z.useForm(),w=(0,a.Z)(_,1)[0],F=(0,d.useContext)(r.s),E=F.getData,I=F.dataToEdit,D=F.setDataToEdit,L=F.tipo,M=F.setCargando,T=F.data1,P=F.setData1,z=F.cargando,O=F.updateData,R=F.createData,V=(0,b.v2)(L,n),B=(0,d.useState)(V),U=(0,a.Z)(B,2),A=U[0],H=U[1],G=(0,d.useState)([]),W=(0,a.Z)(G,2),X=W[0],K=W[1],J=(0,d.useState)([]),Q=(0,a.Z)(J,2),Y=(Q[0],Q[1]),$=(0,d.useState)([]),ee=(0,a.Z)($,2),oe=ee[0],ne=ee[1],ie=(0,d.useState)(""),te=(0,a.Z)(ie,2),ae=te[0],de=te[1],re=(0,d.useState)([]),le=(0,a.Z)(re,2),ue=le[0],ce=le[1],se=(0,d.useState)([]),ve=(0,a.Z)(se,2),pe=ve[0],fe=ve[1],me=(0,d.useState)([]),ge=(0,a.Z)(me,2),he=ge[0],xe=ge[1],Ze=(0,d.useState)([]),be=(0,a.Z)(Ze,2),_e=(be[0],be[1]),je=(0,d.useState)([]),Ce=(0,a.Z)(je,2),qe=Ce[0],we=Ce[1],Se=(0,d.useState)(""),ke=(0,a.Z)(Se,2),Fe=(ke[0],ke[1]),Ee=(0,d.useState)([]),ye=(0,a.Z)(Ee,2),Ie=ye[0],Ne=ye[1],De=(0,d.useState)(!1),Le=(0,a.Z)(De,2),Me=Le[0],Te=Le[1],Pe=function(){h(!1),D(null),H(V),K([]),M(!1)},ze=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(){var o,t,a,d,r,l,u,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"area","entrada","requerimiento/trabajador","pedido/id","pedido/entrada","requerimiento",o=E("area"),t=E("entrada"),a=E("requerimiento/trabajador"),d=E("pedido/id"),r=E("pedido/entrada"),l=E("almacen/producto/".concat(n)),u=E("requerimiento"),e.next=15,Promise.all([o,t,a,d,r,l,u]);case 15:c=e.sent,Y(c[0].data),ne(c[1].data),ce(c[2].data),fe(c[3].data),xe(c[4].data),_e(c[5].data),Ne(c[6].data);case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(){var o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E("almacen/producto/".concat(n));case 2:o=e.sent,P(o.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){Oe()}),[]),(0,d.useEffect)((function(){ze()}),[]),(0,d.useEffect)((function(){var e;if((null===A||void 0===A||null===(e=A.dni)||void 0===e?void 0:e.length)>7){var o,n,i=null===ue||void 0===ue?void 0:ue.filter((function(e){return e.dni===A.dni})).flat();if(i.length>0)H((function(e){var o,n;return(0,Z.Z)((0,Z.Z)({},e),{},{encargado:null===i||void 0===i||null===(o=i.at(0))||void 0===o?void 0:o.nombre,area:null===i||void 0===i||null===(n=i.at(0))||void 0===n?void 0:n.area})})),w.setFieldsValue({encargado:null===i||void 0===i||null===(o=i.at(0))||void 0===o?void 0:o.nombre,area:null===i||void 0===i||null===(n=i.at(0))||void 0===n?void 0:n.area})}}),[A.dni,ue]),(0,d.useEffect)((function(){var e=pe.map((function(e){return{estado_pedido:e.estado_pedido,id:e.id,requerimiento_pedidos:e.requerimiento_pedidos.filter((function(e){return e.almacen_id===n&&null===e.estado}))}})).flat().filter((function(e){return e.requerimiento_pedidos.length>0}));we(e)}),[pe,n]),(0,d.useEffect)((function(){if(""!==A.codigo_pedido&&"-1"!==A.codigo_pedido&&""===A.producto&&null===I){var e=he.filter((function(e){return e.id===A.codigo_pedido&&e.requerimiento_pedidos.map((function(e){return e.requerimiento})).filter((function(e){return e.almacen_id===n}))})),o=e.length>0&&e.map((function(e){var o;return null===e||void 0===e||null===(o=e.requerimiento_pedidos)||void 0===o?void 0:o.filter((function(e){return e.requerimiento.almacen_id===n}))})).flat().map((function(e){return e.requerimiento_id})).toString(),i=e.length>0&&e.map((function(e){return null===e||void 0===e?void 0:e.requerimiento_pedidos})).flat().map((function(e){var o;return null===e||void 0===e||null===(o=e.requerimiento)||void 0===o?void 0:o.requerimiento_productos})).flat().map((function(o){var n,i,t,a,d,r,l,u,c,s,v;return{cantidad:parseInt(null===o||void 0===o?void 0:o.cantidad),almacen_id:null===o||void 0===o||null===(n=o.producto)||void 0===n?void 0:n.almacen_id,categoria:null===o||void 0===o||null===(i=o.producto)||void 0===i?void 0:i.categoria,id:null===o||void 0===o?void 0:o.producto_id,codigo_barras:null===o||void 0===o||null===(t=o.producto)||void 0===t?void 0:t.codigo_barras,codigo_interno:null===o||void 0===o||null===(a=o.producto)||void 0===a?void 0:a.codigo_interno,descripcion:null===o||void 0===o||null===(d=o.producto)||void 0===d?void 0:d.descripcion,fecha:null===o||void 0===o||null===(r=o.producto)||void 0===r?void 0:r.fecha,producto_id:null===o||void 0===o?void 0:o.producto_id,nombre:null===o||void 0===o||null===(l=o.producto)||void 0===l?void 0:l.nombre,precio:null===o||void 0===o||null===(u=o.producto)||void 0===u?void 0:u.precio,stock:null===o||void 0===o||null===(c=o.producto)||void 0===c?void 0:c.stock,unidad:null===o||void 0===o||null===(s=o.producto)||void 0===s||null===(v=s.unidad)||void 0===v?void 0:v.nombre,encargado:null===e||void 0===e?void 0:e.map((function(e){var o,n,i;return null===e||void 0===e||null===(o=e.requerimiento_pedidos)||void 0===o||null===(n=o.at(-1))||void 0===n||null===(i=n.requerimiento)||void 0===i?void 0:i.solicitante})).flat().toString(),dni:null===e||void 0===e?void 0:e.map((function(e){var o,n,i;return null===e||void 0===e||null===(o=e.requerimiento_pedidos)||void 0===o||null===(n=o.at(-1))||void 0===n||null===(i=n.requerimiento)||void 0===i?void 0:i.dni})).flat().toString()}})),t=i.length>0&&i.reduce((function(e,o){var n=e.find((function(e){return e.producto_id==o.producto_id}));return n?(n.cantidad+=o.cantidad,Object.assign(n)):e.push(o),e}),[]),a=t.length>0&&t.map((function(e){return{cantidad:null===e||void 0===e?void 0:e.cantidad,almacen_id:null===e||void 0===e?void 0:e.almacen_id,categoria:null===e||void 0===e?void 0:e.categoria,id:null===e||void 0===e?void 0:e.id,codigo_barras:null===e||void 0===e?void 0:e.codigo_barras,codigo_interno:null===e||void 0===e?void 0:e.codigo_interno,descripcion:null===e||void 0===e?void 0:e.descripcion,fecha:null===A||void 0===A?void 0:A.fecha,producto_id:null===e||void 0===e?void 0:e.producto_id,nombre:null===e||void 0===e?void 0:e.nombre,precio:null===e||void 0===e?void 0:e.precio,stock:null===e||void 0===e?void 0:e.stock,unidad:null===e||void 0===e?void 0:e.unidad,costo:parseInt(null===e||void 0===e?void 0:e.cantidad)*parseFloat(null===e||void 0===e?void 0:e.precio).toFixed(2),tipo:null===A||void 0===A?void 0:A.tipo,codigo:null===A||void 0===A?void 0:A.codigo,motivo:null===A||void 0===A?void 0:A.motivo,encargado:null===A||void 0===A?void 0:A.encargado,codigo_compra:null===A||void 0===A?void 0:A.codigo_compra,boleta:null===A||void 0===A?void 0:A.boleta,codigo_requerimiento:o,dni:A.dni,codigo_pedido:A.codigo_pedido}})).filter((function(e){return e.almacen_id===n}));a.length>0&&(H((function(e){return(0,Z.Z)((0,Z.Z)({},e),{},{codigo_requerimiento:o})})),K(a))}}),[A.producto,A.fecha,A.tipo,A.codigo,A.motivo,A.encargado,A.codigo_compra,A.dni,A.codigo_pedido,A.costo_total,I,A.boleta,he,n,L]),(0,d.useEffect)((function(){if(A.producto){var e=(null===T||void 0===T?void 0:T.filter((function(e){return e.id===A.producto}))).map((function(e){var o,i;return{id:null===e||void 0===e?void 0:e.id,codigo_producto:null===e||void 0===e?void 0:e.id,nombre:null===e||void 0===e?void 0:e.nombre,unidad:null===e||void 0===e?void 0:e.unidad,codigo:parseInt(null===(o=oe[(null===oe||void 0===oe?void 0:oe.length)-1])||void 0===o?void 0:o.id)+1,producto_id:null===e||void 0===e?void 0:e.id,tipo:"entrada",almacen_id:n,stock:parseInt(null===e||void 0===e?void 0:e.stock),nuevo_stock:parseInt(null===e||void 0===e?void 0:e.stock)+parseInt(null===A||void 0===A?void 0:A.cantidad),costo_inicial:parseFloat(null===e||void 0===e?void 0:e.precio),costo:null===(i=parseFloat(null===e||void 0===e?void 0:e.precio))||void 0===i?void 0:i.toFixed(2)}}));0===(null===X||void 0===X?void 0:X.filter((function(o){var n=e.find((function(e){return e.codigo_producto===o.codigo_producto}));return n?o:n}))).length&&K((function(o){return[].concat((0,N.Z)(o),[e.at(-1)])}))}}),[A]),(0,d.useEffect)((function(){if(I){var e;H(I),w.setFieldsValue(I);var o=null===I||void 0===I||null===(e=I.producto_entrada_salidas)||void 0===e?void 0:e.map((function(e){var o,n,i,t,a,d,r,l,u;return{cantidad:parseInt(null===e||void 0===e?void 0:e.cantidad),costo:null===e||void 0===e||null===(o=e.producto)||void 0===o?void 0:o.precio,nombre:null===e||void 0===e||null===(n=e.producto)||void 0===n?void 0:n.nombre,unidad:null===e||void 0===e||null===(i=e.producto)||void 0===i||null===(t=i.unidad)||void 0===t?void 0:t.nombre,id:null===e||void 0===e||null===(a=e.producto)||void 0===a?void 0:a.id,codigo_producto:null===e||void 0===e||null===(d=e.producto)||void 0===d?void 0:d.id,codigo:null===e||void 0===e||null===(r=e.producto)||void 0===r?void 0:r.codigo,producto_id:null===e||void 0===e||null===(l=e.producto)||void 0===l?void 0:l.id,stock:null===e||void 0===e||null===(u=e.producto)||void 0===u?void 0:u.stock}}));K(o)}}),[I]),(0,d.useEffect)((function(){var e=X.length>=0&&(null===X||void 0===X?void 0:X.reduce((function(e,o){return parseFloat(e)+parseFloat(o.costo)}),0));H((function(o){return(0,Z.Z)((0,Z.Z)({},o),{},{costo_total:e})}))}),[X]),(0,d.useEffect)((function(){""!==ae&&0!==X.length&&void 0!==ae&&K((function(e){return e.map((function(e,o){return o===ae?(0,Z.Z)((0,Z.Z)({},e),{},{cantidad:A.cantidad,costo:""!==A.cantidad?parseFloat(e.costo_inicial)*parseFloat(A.cantidad):e.costo_inicial}):e}))}))}),[ae,A.cantidad]);var Re=function(e,o,n){if(void 0!==o&&de(o),!n&&e.target){var i=e.target,t=i.name,a=i.value;H((function(e){return(0,Z.Z)((0,Z.Z)({},e),{},(0,x.Z)({},t,a))})),w.setFieldsValue((0,x.Z)({},t,a))}else H((function(o){return(0,Z.Z)((0,Z.Z)({},o),{},(0,x.Z)({},n,e))})),w.setFieldsValue((0,x.Z)({},n,e))},Ve=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(o){var t,a,d,r,l,c,s,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="entrada",d={motivo:A.motivo,fecha:A.fecha,dni:A.dni,encargado:A.encargado,codigo_compra:A.codigo_compra,boleta:A.boleta,codigo_pedido:A.codigo_pedido,codigo_requerimiento:A.codigo_requerimiento,almacen_id:n,productos:X,codigo:(null===(t=oe.at(-1))||void 0===t?void 0:t.id)+1||1},r=null===X||void 0===X?void 0:X.filter((function(e){return e.cantidad<=0})),l=null===X||void 0===X?void 0:X.filter((function(e){return""!==e.cantidad})).length,c=X.length,l!==c){e.next=25;break}if(0!==r.length){e.next=22;break}if(null!==I){e.next=15;break}return M(!0),e.next=11,R(d,a);case 11:(s=e.sent)&&((0,S.q)(s.status,s.msg),Pe(),u(),M(!1),f(),ze()),e.next=20;break;case 15:return M(!0),e.next=18,O(d,I.id,a);case 18:(v=e.sent)&&((0,S.q)(v.status,v.msg),Pe(),u(),M(!1),f(),ze());case 20:e.next=23;break;case 22:(0,S.q)(500,"La cantidad debe ser mayor a 0.");case 23:e.next=26;break;case 25:(0,S.q)(500,"Debe completar el campo cantidad, para todos los productos seleccionados.");case 26:case"end":return e.stop()}}),e)})));return function(o){return e.apply(this,arguments)}}(),Be=(0,l.OH)(Re,(function(e){K((function(o){return o.filter((function(o){return o.id!==e.id}))})),H((function(e){return(0,Z.Z)((0,Z.Z)({},e),{},{producto:"",codigo_pedido:"",codigo_requerimiento:""})}))}),A.cantidad,I,null===A||void 0===A?void 0:A.codigo_pedido,null===X||void 0===X?void 0:X.cantidad,A.codigo_requerimiento,L);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(C.Z,{destroyOnClose:!0,className:"modal-registrar-entrada",title:I?"Editar entrada":"Registrar entrada",open:g,centered:!0,onCancel:Pe,footer:null,width:950,children:(0,m.jsxs)(j.Z,{form:w,onFinish:Ve,children:[(0,m.jsxs)("section",{className:"modal-body",children:[(0,m.jsxs)(j.Z.Item,{className:"container",children:[(0,m.jsx)("label",{children:"C\xf3digo"}),(0,m.jsx)(s.Z,{value:null===I?parseInt(null===(o=oe.at(-1))||void 0===o?void 0:o.id)+1||1:A.codigo,type:"text",name:"codigo",disabled:!0,onChange:Re})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"motivo",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,m.jsx)("label",{children:"Motivo de entrada *"}),(0,m.jsx)(s.Z,{disabled:!!I,placeholder:"Motivo de entrada",value:A.motivo,type:"text",name:"motivo",onChange:Re})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"fecha",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,m.jsx)("label",{children:"Fecha de entrada"}),(0,m.jsx)(s.Z,{disabled:!!I,type:"date",placeholder:"Fecha ",className:"fecha",name:"fecha",value:A.fecha,onChange:Re})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"dni",rules:[{required:!0,message:"Campo obligatorio!"},{min:8,message:"El dni tiene menos de 8 d\xedgitos."},{max:8,message:"El dni tiene m\xe1s de 8 d\xedgitos."}],children:[(0,m.jsx)("label",{children:"Dni"}),(0,m.jsx)(s.Z,{disabled:!!I,placeholder:"Dni",type:"number",name:"dni",value:A.dni,onChange:Re})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"encargado",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,m.jsx)("label",{children:"Encargado"}),(0,m.jsx)(s.Z,{disabled:!!I,placeholder:"Encargado",type:"text",name:"encargado",value:A.encargado,onChange:Re})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"codigo_compra",rules:[{required:!1}],children:[(0,m.jsx)("label",{children:"C\xf3digo orden de compra"}),(0,m.jsx)(s.Z,{disabled:!!I,placeholder:"C\xf3digo orden de compra",type:"text",name:"codigo_compra",value:A.codigo_compra,onChange:Re})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"boleta",rules:[{required:!1}],children:[(0,m.jsx)("label",{children:"Boleta/Factura"}),(0,m.jsx)(s.Z,{disabled:!!I,placeholder:"Boleta/Factura",type:"text",name:"boleta",value:A.boleta,onChange:Re})]}),(0,m.jsxs)(j.Z.Item,{className:"container",children:[(0,m.jsx)("label",{children:"C\xf3digo de pedido"}),(0,m.jsxs)(y.Z,{disabled:!!I,placeholder:"Codigo de pedido",name:"codigo_pedido",value:A.codigo_pedido?A.codigo_pedido:void 0,onChange:function(e){return Re(e,null,"codigo_pedido")},children:[(0,m.jsx)(y.Z.Option,{value:"-1",children:"Ninguno"}),null===qe||void 0===qe?void 0:qe.map((function(e,o){return(0,m.jsx)(y.Z.Option,{value:e.id,children:e.id})}))]})]}),(0,m.jsxs)(j.Z.Item,{className:"container",children:[(0,m.jsx)("label",{children:"C\xf3digo de requerimiento"}),(0,m.jsxs)(y.Z,{disabled:!0,placeholder:"C\xf3digo de requerimiento",name:"codigo_requerimiento",value:A.codigo_requerimiento?A.codigo_requerimiento:void 0,onChange:function(e){return Re(e,null,"codigo_requerimiento")},children:[(0,m.jsx)(y.Z.Option,{value:"-1",children:"Ninguno"}),null===Ie||void 0===Ie?void 0:Ie.filter((function(e){return e.almacen_id===n&&"Entregado"!==e.estado})).map((function(e,o){return(0,m.jsx)(y.Z.Option,{value:e.id,children:e.id})}))]})]}),(0,m.jsxs)(j.Z.Item,{className:"container",children:[(0,m.jsx)("label",{children:"Productos"}),(0,m.jsx)(y.Z,{placeholder:"Seleccione un producto",showSearch:!0,optionFilterProp:"children",name:"producto",disabled:""!==A.codigo_requerimiento||""!==A.codigo_pedido&&"-1"!==A.codigo_pedido,dropdownMatchSelectWidth:!1,value:A.producto?A.producto:void 0,onSearch:function(e){return Fe(e)},filterOption:function(e,o){var n;return(null!==(n=null===o||void 0===o?void 0:o.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())},onChange:function(e){return Re(e,null,"producto")},options:p.map((function(e,o){return{value:e.id,label:e.nombre}}))})]}),I?"":(0,m.jsx)("div",{className:"agregar",children:(0,m.jsx)(q.ZP,{onClick:function(){return Te(!0)},children:"+"})})]}),(0,m.jsx)("div",{className:"tabla_salida",children:(0,m.jsx)(c.Z,{columns:Be,table:X,filas:5})}),(0,m.jsx)("div",{className:"button-container",children:X.length>0?(0,m.jsxs)("div",{className:"footer",children:[(0,m.jsxs)("label",{htmlFor:"",children:[(0,m.jsx)("strong",{children:"Costo total:"})," ",A.costo_total]}),X&&0!==(null===X||void 0===X?void 0:X.length)&&!I?(0,m.jsx)(q.ZP,{htmlType:"submit",icon:(0,m.jsx)(v.lFz,{}),loading:!!z,children:"Guardar"}):""]}):""})]})}),Me&&(0,m.jsx)(k,{id:n,modal:Me,setModal:Te,actualizarTabla:Oe})]})}),L=function(e){var o=e.modal,n=e.setModal,u=e.id,s=e.data,v=e.actualizarProductos,p=(0,d.useContext)(r.s),f=(p.setModal1,p.modal1,p.setModal2,p.tipo),g=p.setTipo,h=(p.deleteData,p.getData),x=p.setDataToEdit,Z=(p.updateData,p.createData),b=(0,d.useState)([]),_=(0,a.Z)(b,2),j=_[0],q=_[1],w=(0,d.useState)([]),k=(0,a.Z)(w,2),F=k[0],E=k[1],y=(0,d.useState)(!1),N=(0,a.Z)(y,2),L=N[0],M=N[1],T=(0,d.useState)(""),P=(0,a.Z)(T,2),z=P[0],O=P[1],R=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(){var o,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="entrada/".concat(u,"?tipo=entrada"),e.next=3,h(o);case 3:n=e.sent,q(n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){R()}),[f]);var V=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(o){var n,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="entrada/eliminar/".concat(o.id),e.next=3,Z(o,n);case 3:200===(t=e.sent).status&&((0,S.q)(t.status,t.msg),R(),v());case 5:case"end":return e.stop()}}),e)})));return function(o){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){var e=null===j||void 0===j?void 0:j.filter((function(e){var o,n,i,t,a,d,r,l,u,c,s;return(null===e||void 0===e||null===(o=e.id)||void 0===o||null===(n=o.toString())||void 0===n||null===(i=n.toLowerCase())||void 0===i?void 0:i.includes(null===z||void 0===z?void 0:z.toLowerCase()))||(null===e||void 0===e||null===(t=e.encargado)||void 0===t||null===(a=t.toLowerCase())||void 0===a?void 0:a.includes(null===z||void 0===z?void 0:z.toLowerCase()))||(null===e||void 0===e||null===(d=e.codigo_compra)||void 0===d||null===(r=d.toLowerCase())||void 0===r?void 0:r.includes(null===z||void 0===z?void 0:z.toLowerCase()))||(null===e||void 0===e||null===(l=e.codigo_factura)||void 0===l||null===(u=l.toLowerCase())||void 0===u?void 0:u.includes(null===z||void 0===z?void 0:z.toLowerCase()))||(null===e||void 0===e||null===(c=e.fecha)||void 0===c||null===(s=c.toLowerCase())||void 0===s?void 0:s.includes(null===z||void 0===z?void 0:z.toLowerCase()))}));E(z?e:j)}),[z,j,f]);var B=(0,l.wR)((function(e){x(e),M(!0)}),V);return(0,m.jsxs)(C.Z,{className:"modal-entradas",title:"Historial de entradas",open:o,centered:!0,onCancel:function(){n(!1),g("")},footer:null,width:1020,children:[(0,m.jsx)(I.Z,{abrirModal:M,modal:!0,filterText:O}),(0,m.jsx)("br",{}),(0,m.jsx)(c.Z,{columns:B,table:F,filas:8}),L&&(0,m.jsx)(D,{almacen_id:u,actualizarTabla:R,productos:s,tipo:f,actualizarProductos:v,modal2:L,setModal2:M})]})},M=function(e){var o,n=e.almacen_id,u=e.actualizarTabla,p=e.productos,f=e.actualizarProductos,g=e.modal2,h=e.setModal2,_=j.Z.useForm(),w=(0,a.Z)(_,1)[0],F=(0,d.useContext)(r.s),E=F.getData,I=F.dataToEdit,D=F.setDataToEdit,L=F.tipo,M=F.setCargando,T=F.data1,P=(F.setData1,F.cargando),z=F.updateData,O=F.createData,R=(0,b.v2)(L,n),V=(0,d.useState)(R),B=(0,a.Z)(V,2),U=B[0],A=B[1],H=(0,d.useState)([]),G=(0,a.Z)(H,2),W=G[0],X=G[1],K=(0,d.useState)([]),J=(0,a.Z)(K,2),Q=J[0],Y=J[1],$=(0,d.useState)([]),ee=(0,a.Z)($,2),oe=ee[0],ne=ee[1],ie=(0,d.useState)(""),te=(0,a.Z)(ie,2),ae=te[0],de=te[1],re=(0,d.useState)([]),le=(0,a.Z)(re,2),ue=le[0],ce=le[1],se=(0,d.useState)([]),ve=(0,a.Z)(se,2),pe=(ve[0],ve[1]),fe=(0,d.useState)([]),me=(0,a.Z)(fe,2),ge=(me[0],me[1]),he=(0,d.useState)([]),xe=(0,a.Z)(he,2),Ze=(xe[0],xe[1]),be=(0,d.useState)(""),_e=(0,a.Z)(be,2),je=(_e[0],_e[1]),Ce=(0,d.useState)([]),qe=(0,a.Z)(Ce,2),we=qe[0],Se=qe[1],ke=(0,d.useState)(!1),Fe=(0,a.Z)(ke,2),Ee=Fe[0],ye=Fe[1],Ie=function(){h(!1),D(null),A(b.v2),X([]),M(!1)},Ne=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(){var o,t,a,d,r,l,u,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"area","entrada","requerimiento/trabajador","pedido/id","pedido/entrada","requerimiento",o=E("area"),t=E("entrada"),a=E("requerimiento/trabajador"),d=E("pedido/id"),r=E("pedido/entrada"),l=E("almacen/producto/".concat(n)),u=E("requerimiento"),e.next=15,Promise.all([o,t,a,d,r,l,u]);case 15:c=e.sent,Y(c[0].data),ne(c[1].data),ce(c[2].data),pe(c[3].data),ge(c[4].data),Ze(c[5].data),Se(c[6].data);case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){Ne()}),[]),(0,d.useEffect)((function(){var e;if((null===U||void 0===U||null===(e=U.dni)||void 0===e?void 0:e.length)>7){var o=null===ue||void 0===ue?void 0:ue.filter((function(e){return e.dni===U.dni}));if(o.length>0){var n,i;null===o||void 0===o||o.at(-1);A((function(e){var n,i;return(0,Z.Z)((0,Z.Z)({},e),{},{encargado:null===o||void 0===o||null===(n=o.at(0))||void 0===n?void 0:n.nombre,area_id:null===o||void 0===o||null===(i=o.at(0))||void 0===i?void 0:i.area})})),w.setFieldsValue({encargado:null===o||void 0===o||null===(n=o.at(0))||void 0===n?void 0:n.nombre,area_id:null===o||void 0===o||null===(i=o.at(0))||void 0===i?void 0:i.area})}}}),[U.dni,ue]),(0,d.useEffect)((function(){var e=W.length>=0&&(null===W||void 0===W?void 0:W.reduce((function(e,o){return parseFloat(e)+parseFloat(o.costo)}),0));A((function(o){return(0,Z.Z)((0,Z.Z)({},o),{},{costo_total:e})}))}),[W]),(0,d.useEffect)((function(){if(null===I&&U.codigo_requerimiento&&""===U.producto){var e,o,i,t,a,d=we.filter((function(e){return e.id===U.codigo_requerimiento}));A((function(e){var o,n,i,t;return(0,Z.Z)((0,Z.Z)({},e),{},{encargado:null===d||void 0===d||null===(o=d.at(-1))||void 0===o?void 0:o.solicitante,dni:null===d||void 0===d||null===(n=d.at(-1))||void 0===n?void 0:n.dni,area_id:null===d||void 0===d||null===(i=d.at(-1))||void 0===i?void 0:i.area_id,codigo_pedido:null===d||void 0===d||null===(t=d.at(-1))||void 0===t?void 0:t.pedido_id})})),w.setFieldsValue({encargado:null===d||void 0===d||null===(e=d.at(-1))||void 0===e?void 0:e.solicitante,dni:null===d||void 0===d||null===(o=d.at(-1))||void 0===o?void 0:o.dni,area_id:null===d||void 0===d||null===(i=d.at(-1))||void 0===i?void 0:i.area_id});var r=null===d||void 0===d||null===(t=d.at(-1))||void 0===t||null===(a=t.requerimiento_productos)||void 0===a?void 0:a.map((function(e){var o,i,t,a;return{id:null===e||void 0===e?void 0:e.producto_id,cantidad:null===e||void 0===e?void 0:e.cantidad,nombre:null===e||void 0===e||null===(o=e.producto)||void 0===o?void 0:o.nombre,unidad:null===e||void 0===e||null===(i=e.unidad)||void 0===i?void 0:i.nombre,stock:null===e||void 0===e||null===(t=e.producto)||void 0===t?void 0:t.stock,costo:parseInt(null===e||void 0===e?void 0:e.cantidad)*parseInt(null===e||void 0===e||null===(a=e.producto)||void 0===a?void 0:a.precio),producto_id:e.producto_id,almacen_id:n,codigo:""}}));(null===r||void 0===r?void 0:r.length)>0&&X(r)}}),[I,U.codigo_requerimiento,U.producto,w]),(0,d.useEffect)((function(){if(U.producto){var e=(null===T||void 0===T?void 0:T.filter((function(e){return e.id===U.producto}))).map((function(e){var o,i;return{id:null===e||void 0===e?void 0:e.id,codigo_producto:null===e||void 0===e?void 0:e.id,nombre:null===e||void 0===e?void 0:e.nombre,unidad:null===e||void 0===e?void 0:e.unidad,codigo:parseInt(null===(o=oe[(null===oe||void 0===oe?void 0:oe.length)-1])||void 0===o?void 0:o.id)+1,producto_id:null===e||void 0===e?void 0:e.id,tipo:"entrada",almacen_id:n,stock:parseInt(null===e||void 0===e?void 0:e.stock),nuevo_stock:parseInt(null===e||void 0===e?void 0:e.stock)+parseInt(null===U||void 0===U?void 0:U.cantidad),costo_inicial:parseFloat(null===e||void 0===e?void 0:e.precio),costo:null===(i=parseFloat(null===e||void 0===e?void 0:e.precio))||void 0===i?void 0:i.toFixed(2)}}));0===(null===W||void 0===W?void 0:W.filter((function(o){var n=e.find((function(e){return e.codigo_producto===o.codigo_producto}));return n?o:n}))).length&&X((function(o){return[].concat((0,N.Z)(o),[e.at(-1)])}))}}),[U]),(0,d.useEffect)((function(){""!==ae&&0!==W.length&&void 0!==ae&&X((function(e){return e.map((function(e,o){return o===ae?(0,Z.Z)((0,Z.Z)({},e),{},{cantidad:U.cantidad,costo:""!==U.cantidad?parseFloat(e.costo_inicial)*parseFloat(U.cantidad):e.costo_inicial}):e}))}))}),[ae,U.cantidad]),(0,d.useEffect)((function(){if(I){var e;A(I),w.setFieldsValue(I);var o=null===I||void 0===I||null===(e=I.producto_entrada_salidas)||void 0===e?void 0:e.map((function(e){var o,n,i,t,a,d,r,l;return{cantidad:parseInt(null===e||void 0===e?void 0:e.cantidad),costo:null===e||void 0===e?void 0:e.costo,nombre:null===e||void 0===e||null===(o=e.producto)||void 0===o?void 0:o.nombre,unidad:null===e||void 0===e||null===(n=e.producto)||void 0===n||null===(i=n.unidad)||void 0===i?void 0:i.nombre,id:null===e||void 0===e||null===(t=e.producto)||void 0===t?void 0:t.id,codigo_producto:null===e||void 0===e||null===(a=e.producto)||void 0===a?void 0:a.id,codigo:null===e||void 0===e||null===(d=e.producto)||void 0===d?void 0:d.codigo,producto_id:null===e||void 0===e||null===(r=e.producto)||void 0===r?void 0:r.id,stock:null===e||void 0===e||null===(l=e.producto)||void 0===l?void 0:l.stock}}));X(o)}}),[I]);var De=function(e,o,n){if(void 0!==o&&de(o),!n&&e.target){var i=e.target,t=i.name,a=i.value;w.setFieldsValue((0,x.Z)({},t,a)),A((function(e){return(0,Z.Z)((0,Z.Z)({},e),{},(0,x.Z)({},t,a))}))}else w.setFieldsValue((0,x.Z)({},n,e)),A((function(o){return(0,Z.Z)((0,Z.Z)({},o),{},(0,x.Z)({},n,e))}))},Le=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(o){var t,a,d,r,l,c,s,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="entrada/salida",a={codigo:U.codigo,retornable:U.retornable,motivo:U.motivo,fecha:U.fecha,dni:U.dni,encargado:U.encargado,area_id:U.area_id,codigo_requerimiento:U.codigo_requerimiento,costo_total:U.costo_total,almacen_id:n,codigo_pedido:U.codigo_pedido,productos:W},d=null===W||void 0===W?void 0:W.filter((function(e){return e.cantidad<=0})),r=null===W||void 0===W?void 0:W.filter((function(e){return""!==e.cantidad})).length,l=W.length,c=W.filter((function(e){return parseInt(e.stock)<parseInt(e.cantidad)})),r!==l){e.next=30;break}if(0!==d.length){e.next=27;break}if(!(c.length>0)){e.next=12;break}return e.abrupt("return",(0,S.q)(500,"No se puede realizar la salida, stock insuficiente."));case 12:if(null!==I){e.next=20;break}return M(!0),e.next=16,O(a,t);case 16:(s=e.sent)&&((0,S.q)(s.status,s.msg),Ie(),u(),M(!1),f(),Ne()),e.next=25;break;case 20:return M(!0),e.next=23,z(a,I.id,t);case 23:(v=e.sent)&&((0,S.q)(v.status,v.msg),Ie(),u(),M(!1),f(),Ne());case 25:e.next=28;break;case 27:return e.abrupt("return",(0,S.q)(500,"La cantidad debe ser mayor a 0."));case 28:e.next=31;break;case 30:return e.abrupt("return",(0,S.q)(500,"Debe completar el campo cantidad, para todos los productos seleccionados."));case 31:case"end":return e.stop()}}),e)})));return function(o){return e.apply(this,arguments)}}(),Me=(0,l.OH)(De,(function(e){X((function(o){return o.filter((function(o){return o.id!==e.id}))})),A((function(e){return(0,Z.Z)((0,Z.Z)({},e),{},{producto:"",codigo_pedido:"",codigo_requerimiento:""})}))}),U.cantidad,I,null===U||void 0===U?void 0:U.codigo_pedido,null===W||void 0===W?void 0:W.cantidad,U.codigo_requerimiento,L);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(C.Z,{destroyOnClose:!0,className:"modal-registrar-entrada",title:I?"Editar salida":"Registrar salida",open:g,centered:!0,onCancel:Ie,footer:null,width:950,children:(0,m.jsxs)(j.Z,{form:w,onFinish:Le,children:[(0,m.jsxs)("section",{className:"modal-body",children:[(0,m.jsxs)(j.Z.Item,{className:"container",children:[(0,m.jsx)("label",{children:"C\xf3digo"}),(0,m.jsx)(s.Z,{value:null===I?parseInt(null===(o=oe.at(-1))||void 0===o?void 0:o.id)+1||1:U.id,type:"text",name:"codigo",disabled:!0,onChange:De})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"retornable",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,m.jsx)("label",{children:"Retornable"}),(0,m.jsx)(y.Z,{disabled:!!I,placeholder:"Retornable",name:"retornable",value:U.retornable?U.retornable:void 0,onChange:function(e){return De(e,null,"retornable")},options:[{label:"Si",value:!0},{label:"No",value:!1}]})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"motivo",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,m.jsx)("label",{children:"Motivo de salida"}),(0,m.jsx)(s.Z,{disabled:!!I,placeholder:"Motivo de salida",value:U.motivo,type:"text",name:"motivo",onChange:De})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"fecha",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,m.jsx)("label",{children:"Fecha de salida"}),(0,m.jsx)(s.Z,{disabled:!!I,type:"date",placeholder:"Fecha ",className:"fecha",name:"fecha",value:U.fecha,onChange:De})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"dni",rules:[{required:!0,message:"Campo obligatorio!"},{min:8,message:"El dni tiene menos de 8 d\xedgitos."},{max:8,message:"El dni tiene m\xe1s de 8 d\xedgitos."}],children:[(0,m.jsx)("label",{children:"Dni"}),(0,m.jsx)(s.Z,{disabled:!!I,placeholder:"Dni",type:"number",name:"dni",value:U.dni,onChange:De})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"encargado",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,m.jsx)("label",{children:"Personal"}),(0,m.jsx)(s.Z,{disabled:!!I,placeholder:"Personal",type:"text",name:"encargado",value:U.encargado,onChange:De})]}),(0,m.jsxs)(j.Z.Item,{className:"container",name:"area_id",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,m.jsx)("label",{children:"\xc1rea"}),(0,m.jsx)(y.Z,{disabled:!!I,placeholder:"\xc1rea",name:"area_id",dropdownMatchSelectWidth:!1,value:U.area_id?U.area_id:void 0,onChange:function(e){return De(e,null,"area_id")},showSearch:!0,optionFilterProp:"children",filterOption:function(e,o){var n;return(null!==(n=null===o||void 0===o?void 0:o.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())},options:Q.map((function(e,o){return{label:e.nombre,value:e.id}}))})]}),(0,m.jsxs)(j.Z.Item,{className:"container",children:[(0,m.jsx)("label",{children:"C\xf3digo de requerimiento"}),(0,m.jsxs)(y.Z,{disabled:!!I,placeholder:"C\xf3digo de requerimiento",name:"codigo_requerimiento",value:U.codigo_requerimiento?U.codigo_requerimiento:void 0,onChange:function(e){return De(e,null,"codigo_requerimiento")},children:[(0,m.jsx)(y.Z.Option,{value:"-1",children:"Ninguno"}),null===we||void 0===we?void 0:we.filter((function(e){return e.almacen_id===n&&"En almac\xe9n"===e.estado})).map((function(e,o){return(0,m.jsx)(y.Z.Option,{value:e.id,children:e.id})}))]})]}),(0,m.jsxs)(j.Z.Item,{className:"container",children:[(0,m.jsx)("label",{children:"Productos"}),(0,m.jsx)(y.Z,{placeholder:"Ingrese un producto",showSearch:!0,optionFilterProp:"children",name:"producto",disabled:""!==U.codigo_requerimiento||""!==U.codigo_pedido&&"-1"!==U.codigo_pedido,onSearch:function(e){return je(e)},filterOption:function(e,o){var n;return(null!==(n=null===o||void 0===o?void 0:o.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())},onChange:function(e){return De(e,null,"producto")},options:p.map((function(e,o){return{value:e.id,label:e.nombre}}))})]})]}),(0,m.jsx)("div",{className:"tabla_salida",children:(0,m.jsx)(c.Z,{columns:Me,table:W,filas:5})}),W.length>0?(0,m.jsxs)("div",{className:"footer",children:[(0,m.jsxs)("label",{htmlFor:"",children:[(0,m.jsx)("strong",{children:"Costo total:"})," ",U.costo_total]}),W&&0!==(null===W||void 0===W?void 0:W.length)&&!I?(0,m.jsx)(q.ZP,{htmlType:"submit",icon:(0,m.jsx)(v.lFz,{}),loading:!!P,children:"Guardar"}):""]}):""]})}),Ee&&(0,m.jsx)(k,{id:n,modal:Ee,setModal:ye,actualizarTabla:Ne})]})},T=function(e){var o=e.id,n=e.data,u=e.actualizarProductos,s=e.modal,v=e.setModal,p=(0,d.useContext)(r.s),f=(p.setModal2,p.tipo),g=p.setTipo,h=p.getData,x=p.setDataToEdit,Z=p.createData,b=(0,d.useState)([]),_=(0,a.Z)(b,2),j=_[0],q=_[1],w=(0,d.useState)([]),k=(0,a.Z)(w,2),F=k[0],E=k[1],y=(0,d.useState)(""),N=(0,a.Z)(y,2),D=N[0],L=N[1],T=(0,d.useState)(!1),P=(0,a.Z)(T,2),z=P[0],O=P[1],R=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(){var n,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="entrada/".concat(o,"?tipo=salida"),e.next=3,h(n);case 3:t=e.sent,q(t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){R()}),[f]);(0,d.useEffect)((function(){var e=null===j||void 0===j?void 0:j.filter((function(e){var o,n,i,t,a,d,r,l,u,c,s,v,p,f;return(null===e||void 0===e||null===(o=e.id)||void 0===o||null===(n=o.toString())||void 0===n||null===(i=n.toLowerCase())||void 0===i?void 0:i.includes(null===D||void 0===D?void 0:D.toLowerCase()))||(null===e||void 0===e||null===(t=e.encargado)||void 0===t||null===(a=t.toLowerCase())||void 0===a?void 0:a.includes(null===D||void 0===D?void 0:D.toLowerCase()))||(null===e||void 0===e||null===(d=e.codigo_compra)||void 0===d||null===(r=d.toLowerCase())||void 0===r?void 0:r.includes(null===D||void 0===D?void 0:D.toLowerCase()))||(null===e||void 0===e||null===(l=e.codigo_factura)||void 0===l||null===(u=l.toLowerCase())||void 0===u?void 0:u.includes(null===D||void 0===D?void 0:D.toLowerCase()))||(null===e||void 0===e||null===(c=e.area)||void 0===c||null===(s=c.nombre)||void 0===s||null===(v=s.toLowerCase())||void 0===v?void 0:v.includes(null===D||void 0===D?void 0:D.toLowerCase()))||(null===e||void 0===e||null===(p=e.motivo)||void 0===p||null===(f=p.toLowerCase())||void 0===f?void 0:f.includes(null===D||void 0===D?void 0:D.toLowerCase()))}));E(D?e:j)}),[D,j,f]);var V=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(o){var n,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="entrada/eliminar/".concat(o.id),e.next=3,Z(o,n);case 3:200===(t=e.sent).status&&((0,S.q)(t.status,t.msg),R(),u());case 5:case"end":return e.stop()}}),e)})));return function(o){return e.apply(this,arguments)}}(),B=(0,l.br)((function(e){x(e),O(!0)}),V);return(0,m.jsxs)(C.Z,{className:"modal-entradas",title:"Historial de salidas",open:s,centered:!0,onCancel:function(){v(!1),g("")},footer:null,width:1020,children:[(0,m.jsx)(I.Z,{abrirModal:O,modal:!0,filterText:L}),(0,m.jsx)("br",{}),(0,m.jsx)(c.Z,{columns:B,table:F,filas:8}),z&&(0,m.jsx)(M,{almacen_id:o,actualizarTabla:R,productos:n,tipo:f,actualizarProductos:u,modal2:z,setModal2:O})]})},P=function(){var e=(0,d.useContext)(r.s),o=e.getData,n=e.setData,s=e.data,v=e.data1,p=e.setData1,f=(e.modal,e.setModal,e.setDataToEdit),g=(e.modal1,e.setModal1,e.deleteData),x=(e.setModal3,e.modal3,e.tipo,(0,d.useState)("")),Z=(0,a.Z)(x,2),b=Z[0],_=Z[1],j=(0,d.useState)(!1),C=(0,a.Z)(j,2),q=C[0],w=C[1],I=(0,d.useState)([]),N=(0,a.Z)(I,2),D=(N[0],N[1],(0,d.useState)(!1)),M=(0,a.Z)(D,2),P=M[0],z=M[1],O=(0,d.useState)(!1),R=(0,a.Z)(O,2),V=R[0],B=R[1],U=(0,d.useState)(!1),A=(0,a.Z)(U,2),H=A[0],G=A[1],W=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("almacen");case 2:t=e.sent,n(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=(0,E.Z)(v).result,K=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("almacen/producto/".concat(b));case 2:n=e.sent,p(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){K()}),[b]),(0,d.useEffect)((function(){W()}),[]);var J=function(){var e=(0,t.Z)((0,i.Z)().mark((function e(o){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"producto",e.next=3,g("producto",o.id);case 3:(n=e.sent)&&((0,S.q)(n.status,n.msg),K());case 5:case"end":return e.stop()}}),e)})));return function(o){return e.apply(this,arguments)}}(),Q=(0,l.XB)((function(e){f(e),w(!0)}),J);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(u.Z,{text:"Inventario",user:"Usuario",ruta:"/logistica"}),(0,m.jsx)("div",{className:"selector",style:{padding:"30px 20px"},children:(0,m.jsx)(y.Z,{placeholder:"Seleccione un almac\xe9n",style:{width:300},name:"almacen",onChange:function(e){return _(e)},options:s.map((function(e,o){return{value:e.id,label:e.nombre}}))})}),""!==b&&"-1"!==b?(0,m.jsxs)("div",{style:{padding:"0px 20px 20px 20px"},children:[(0,m.jsx)(h,{abrirModal:w,abrirEntrada:z,abrirSalida:B,abrirRequerimiento:G}),(0,m.jsx)("br",{}),(0,m.jsx)(c.Z,{columns:Q,table:X,filas:10})]}):"",(0,m.jsx)(k,{modal:q,setModal:w,actualizarTabla:K,id:b,data:v}),P&&(0,m.jsx)(L,{modal:P,setModal:z,id:b,data:v,actualizarProductos:K}),V&&(0,m.jsx)(T,{modal:V,setModal:B,id:b,data:v,actualizarProductos:K}),H&&(0,m.jsx)(F.Z,{id:b,data:v,modal3:H,setModal3:G})]})}},8034:function(e,o,n){var i=n(1413),t=n(72791),a=n(18267),d=(n(77457),n(80184));o.Z=function(e){var o=e.setAvatar,n=e.avatar,r=e.selected,l=(0,t.useCallback)((function(e){var n=e[0];o({file:n,preview:URL.createObjectURL(n)})}),[o]),u=(0,a.uI)({accept:{"image/png":[".png"],"image/jpg":[".jpg"],"image/jpeg":[".jpeg"]},noKeyboard:!0,onDrop:l}),c=u.getRootProps,s=u.getInputProps,v=u.isDragActive;return(0,d.jsxs)("div",(0,i.Z)((0,i.Z)({},c()),{},{className:"drag",children:[(0,d.jsx)("input",(0,i.Z)({},s())),v?(0,d.jsx)("p",{children:"Coloca la imagen aqui..."}):null!==r&&void 0!==r&&r.foto||null!==n&&void 0!==n&&n.preview?(0,d.jsx)("img",{src:(null===n||void 0===n?void 0:n.preview)||(null===r||void 0===r?void 0:r.foto),alt:""}):(0,d.jsx)("p",{children:"Arrastra la imagen aqui, o has click para seleccionar la imagen."})]}))}},87690:function(e,o,n){n.d(o,{Z:function(){return a}});n(72791);var i=n(87309),t=n(80184),a=function(e){var o=e.text,n=e.state,a=(e.cargando,e.icon);e.tipo;return(0,t.jsx)(i.ZP,{className:"button-registrar",onClick:function(){return n(!0)},icon:a,children:o})}},95579:function(e,o,n){var i=n(72791),t=n(38411);o.Z=function(e){var o=(0,i.useContext)(t.s),n=o.filterText,a=(o.filterTextModal,o.result),d=o.setResult;return(0,i.useEffect)((function(){if(""!==n){var o=e.filter((function(e){return Object.values(e).join("").toLowerCase().includes(n.toLowerCase())}));d(o)}else d(e)}),[n,e]),{result:a}}},28938:function(){},77457:function(){}}]);
//# sourceMappingURL=8886.f71b10a5.chunk.js.map