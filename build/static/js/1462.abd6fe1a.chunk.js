"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[1462],{69967:function(e,n,a){a(72791);var o=a(49998),t=a(80184);n.Z=function(e){var n=e.className,a=e.title,r=e.open,i=e.width,c=e.closeModal,s=e.children;return(0,t.jsx)(o.Z,{destroyOnClose:!0,className:n,title:a,open:r,centered:!0,onCancel:c,footer:null,width:i,children:s})}},28181:function(e,n,a){var o=a(74165),t=a(15861),r=a(29439),i=a(49389),c=a(87309),s=a(72791),d=a(38411),l=a(99763),u=a(69967),p=a(80184);n.Z=function(e){var n=e.modal,a=e.setModal,f=(e.getPlanilla,e.data),m=e.observacion,v=e.boton,h=e.actualizarTabla,b=(0,s.useContext)(d.s).updateData,_=(0,s.useState)(""),g=(0,r.Z)(_,2),Z=g[0],x=g[1],j=function(){a(!1)},y=function(){var e=(0,t.Z)((0,o.Z)().mark((function e(){var n,a,t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={observaciones:Z},e.next=3,b(a,null!==(n=f.aprobacion_id)&&void 0!==n?n:f.id,"aprobacion/observacion");case 3:(t=e.sent)&&((0,l.q)(t.status,t.msg),j(),h());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,p.jsxs)(u.Z,{className:"modal-usuario",title:v?"Agregar Observaci\xf3n":"Observaci\xf3n RRHH",open:n,width:400,closeModal:j,children:[(0,p.jsx)(i.Z.TextArea,{showCount:!0,maxLength:255,defaultValue:null!==f&&void 0!==f&&f.observaciones?null===f||void 0===f?void 0:f.observaciones:m||"",style:{height:120,marginBottom:24,marginTop:15},onChange:function(e){x(e.target.value)},placeholder:"Observaci\xf3n"}),(0,p.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingTop:"10px"},children:v&&(0,p.jsx)(c.ZP,{onClick:y,children:"Guardar"})})]})}},48615:function(e,n,a){a.r(n),a.d(n,{default:function(){return H}});var o=a(74165),t=a(15861),r=a(29439),i=a(34664),c=a(72791),s=a(38411),d=a(53939),l=a(99763),u=(a(64941),a(76487)),p=a(83188),f=a(1413),m=a(70263),v=a(82339),h=a(43513),b=(a(51279),a(80184)),_=function(e){var n=e.columns,a=e.table,o=e.filas,t=n.filter((function(e){return"Nro"===e.id||"asociacion"===e.id||"fecha_inicio"===e.id||"fecha_fin"===e.id||"pago"===e.id||"saldo"===e.id||"tipo_asociacion"===e.id||"observacion"===e.id||"acciones"===e.id})),r=n.map((function(e){return{title:e.name,dataIndex:e.id,key:e.id}}));return(0,b.jsx)("div",{className:"table-container",children:(0,b.jsx)(h.ZP,{size:"small",columns:t,data:a,pagination:!0,striped:!0,highlightOnHover:!0,responsive:!0,paginationComponentOptions:{rowsPerPageText:"Filas por p\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!1,selectAllRowsItemText:"Todos"},paginationPerPage:o||8,paginationRowsPerPageOptions:[8,16,24,32,40],expandableRows:!0,expandableRowsComponent:function(e){var n,a,o=e.data;return(0,b.jsx)(m.Z,{size:"small",columns:r.filter((function(e){return"Nro"===e.key||"nombre"===e.key||"dni"===e.key||"telefono"===e.key||"teletrans"===e.key||"estado"===e.key})),pagination:!1,dataSource:null===(n=o.pagos)||void 0===n||null===(a=n.trabajadores)||void 0===a?void 0:a.map((function(e,n){return(0,f.Z)({key:n,Nro:n+1,nombres:e.nombre,dni:e.dni,telefono:e.telefono,teletrans:e.teletrans||0,estado:e.programado?(0,b.jsx)(v.Z,{color:"green",children:"Programado"}):(0,b.jsx)(v.Z,{color:"red",children:"No programado"})},e)}))})}})})},g=a(28181),Z=a(93433),x=a(4942),j=a(17615),y=a(53655),w=a(80458),S=a(49389),T=a(58848),A=a(68588),C=a(77128),D=a(83099),q=a(36473),E=a(78792),M=a(66106),N=a(30914),k=a(2964),O=a(87309),R=a(97892),P=a.n(R),I=a(35790),F=a(16026),Y=a(69967),z=a(78820);var L=function(e){var n=e.asociacionTemp,a=e.open,i=e.closeModal,d=e.actualizarTabla,u=e.closeModalSubmit,p=void 0===u?function(){}:u,m=e.dataToEdit,v=void 0===m?{}:m,h=e.setDataToEdit,_=void 0===h?function(){}:h,g=j.Z.useForm(),R=(0,r.Z)(g,1)[0],L=y.Z.Text,H=(0,c.useContext)(s.s),V=H.updateData,B=H.createData,G=(0,c.useState)(!1),J=(0,r.Z)(G,2),K=J[0],U=(J[1],(0,c.useState)([])),W=(0,r.Z)(U,2),X=W[0],Q=W[1];(0,c.useEffect)((function(){Q(null===n||void 0===n?void 0:n.pagos.trabajadores)}),[n]),console.log("===================================="),console.log(n),console.log("====================================");var $=null===X||void 0===X?void 0:X.map((function(e){return{value:e.dni,label:e.nombre}})),ee=(0,c.useState)([]),ne=(0,r.Z)(ee,2),ae=ne[0],oe=ne[1],te=(0,c.useState)([]),re=(0,r.Z)(te,2),ie=re[0],ce=re[1];(0,c.useEffect)((function(){if(ae.length>0){var e=X.filter((function(e){return ae.includes(e.dni)}));ce(e)}}),[ae]);var se=(0,c.useState)(F.bf),de=(0,r.Z)(se,2),le=de[0],ue=de[1],pe=function(e,n){if(!n&&e.target){var a=e.target,o=a.name,t=a.value;R.setFieldsValue((0,x.Z)({},o,t)),ue((function(e){return(0,f.Z)((0,f.Z)({},e),{},(0,x.Z)({},o,t))}))}else R.setFieldsValue((0,x.Z)({},n,e)),ue((function(a){return(0,f.Z)((0,f.Z)({},a),{},(0,x.Z)({},n,e))}))},fe=(0,c.useState)([]),me=(0,r.Z)(fe,2),ve=me[0],he=me[1];(0,c.useEffect)((function(){if(ie.length>0){var e=ie.map((function(e){return{nombre:e.nombre,dni:e.dni,teletrans:e.teletrans||""}}));he(v?le.trabajadores.map((function(e){return(0,f.Z)((0,f.Z)({},e),{},{teletrans:parseFloat(e.teletrans)})})):e)}}),[ie]);var be=function(){var e=0;return ve.forEach((function(n){e+=n.teletrans})),e},_e=function(){return le.volquetes?le.volquetes:be()/4},ge=function(){var e=(0,t.Z)((0,o.Z)().mark((function e(){var a,t,r,i,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="pago/programacion/multiple",!(4*_e()>n.total_modificado)){e.next=5;break}return(0,l.q)(500,"El monto a pagar es mayor a lo adeudado."),e.abrupt("return");case 5:if(t={unidad_produccion:le.unidad_produccion,observacion:le.observacion,contrato_id:n.contrato_id,fecha_pago:P()(le.fecha_pago).format("YYYY-MM-DD")||"",volquetes:_e(),teletrans:be(),tipo:"asociacion",quincena:n.quincena,asociacion:ve.map((function(e){return{volquetes:_e(),trabajador_dni:e.dni,teletrans:e.teletrans||0,contrato_id:n.contrato_id||"",quincena:n.quincena||""}}))},r={unidad_produccion:le.unidad_produccion,observacion:le.observacion,contrato_id:n.contrato_id,fecha_pago:P()(le.fecha_pago).format("YYYY-MM-DD")||"",volquetes:_e(),teletrans:be(),trabajadores:ve.map((function(e){return{volquetes:_e(),trabajador_dni:e.dni,teletrans:e.teletrans,contrato_id:n.contrato_id||"",quincena:n.quincena||""}}))},!v){e.next=14;break}return e.next=10,V(r,v.id,"planilla/asociacion");case 10:(i=e.sent)&&((0,l.q)(i.status,i.msg),d(),ye()),e.next=18;break;case 14:return e.next=16,B(t,a);case 16:(c=e.sent)&&((0,l.q)(c.status,c.msg),d(),ye());case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ze=(0,c.useState)([]),xe=(0,r.Z)(Ze,2),je=(xe[0],xe[1]);(0,c.useEffect)((function(){v&&(ue((0,f.Z)((0,f.Z)({},v),{},{fecha_pago:P()(v.fecha_pago).format("YYYY-MM-DD")})),oe(v.trabajadores.map((function(e){return e.dni}))),je(v.trabajadores.map((function(e){return e.nombre}))),he(v.trabajadores))}),[v]);var ye=function(){_(null),i(),p(),oe([]),Q([]),ce([]),he([]),ue(F.bf)};return(0,b.jsx)(Y.Z,{open:a,closeModal:ye,title:"Registrar pago Asociaci\xf3n: "+(null===n||void 0===n?void 0:n.nombre),width:800,children:(0,b.jsxs)(j.Z,{form:R,className:"modal-body",onFinish:ge,layout:"vertical",children:[(0,b.jsx)(j.Z.Item,{label:"Unidad Producci\xf3n",children:(0,b.jsx)(w.Z,{autoSize:!0,name:"unidad_produccion",dropdownMatchSelectWidth:!1,onChange:function(e){return pe(e,"unidad_produccion")},options:[{label:"ANA MAR\xcdAS",value:"ANA MAR\xcdAS"},{label:"SANTA MARIA",value:"SANTA MARIA"},{label:"CORAZ\xd3N DE SAN FRANCISCO",value:"CORAZ\xd3N DE SAN FRANCISCO"},{label:"SAPO DE ORO",value:"SAPO DE ORO"}]})}),(0,b.jsx)(j.Z.Item,{label:"Observacion",children:(0,b.jsx)(S.Z.TextArea,{name:"observacion",label:"Observaci\xf3n",value:le.observacion,onChange:pe,autoSize:!0})}),(0,b.jsx)(j.Z.Item,{label:"Fecha",children:(0,b.jsx)(T.ZP,{locale:I.Z,children:(0,b.jsx)(A.Z,{allowClear:!1,value:P()(le.fecha_pago),name:"fecha_pago",placeholder:"Fecha de Pago",picker:"day",onChange:function(e){return pe(e,"fecha_pago")},style:{width:"100%"},format:"YYYY-MM-DD"})})}),(0,b.jsx)(C.Z,{orientation:"left",children:"Trabajadores"}),(0,b.jsxs)(D.Z,{direction:"vertical",style:{width:"100%"},children:[(0,b.jsx)(j.Z.Item,{label:"Seleccione trabajadores",children:(0,b.jsx)(w.Z,{showSearch:!0,mode:"multiple",placeholder:"Seleccione trabajadores",style:{width:"100%"},allowClear:!0,value:ae,onChange:function(e){oe(e)},options:$,disabled:!!v,filterOption:function(e,n){return n.label.toLowerCase().indexOf(e.toLowerCase())>=0}})}),(0,b.jsx)(j.Z.Item,{label:"Volquetes",children:(0,b.jsx)(S.Z,{value:le.volquetes,placeholder:"Volquetes",name:"volquetes",type:"number",min:0,onChange:function(e){return pe(e)}})})]}),(0,b.jsx)(C.Z,{orientation:"left",children:"Teletrans por trabajador"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,b.jsxs)(q.Z,{style:{width:"100%"},children:[(0,b.jsx)(E.ZP,{itemLayout:"horizontal",dataSource:ve,renderItem:function(e){return(0,b.jsx)(E.ZP.Item,{children:(0,b.jsxs)(M.Z,{style:{width:"100%"},children:[(0,b.jsx)(N.Z,{span:18,children:(0,b.jsx)(D.Z,{direction:"vertical",children:e.nombre})}),(0,b.jsx)(N.Z,{span:6,children:(0,b.jsx)(D.Z,{direction:"vertical",children:(0,b.jsx)(S.Z,{value:e.teletrans,placeholder:"Teletrans",type:"number",min:0,onChange:function(n){return function(e,n){var a=ve.findIndex((function(e){return e.dni===n}));ve[a]=(0,f.Z)((0,f.Z)({},ve[a]),{},{teletrans:parseFloat(e.target.value)}),he((0,Z.Z)(ve))}(n,e.dni)}})})})]},e.dni)})}}),(0,b.jsxs)(D.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"end",alignItems:"center",padding:24},children:[(0,b.jsx)(L,{type:be()%4===0?"success":"danger",children:"TOTAL DE TELETRANS"}),(0,b.jsx)(k.Z,{message:be(),type:be()%4===0?"success":"error"})]})]}),be()>4&&(0,b.jsx)(k.Z,{message:"Total de pago no debe exceder a 4 teletrans",type:"error"})]}),(0,b.jsxs)(D.Z,{direction:"horizontal",style:{width:"100%",marginTop:20,justifyContent:"end"},children:[(0,b.jsx)(O.ZP,{onClick:i,children:"Cancelar"}),(0,b.jsx)(O.ZP,{type:"primary",htmlType:"submit",icon:(0,b.jsx)(z.lFz,{}),loading:!!K,children:"Registrar"})]})]})})},H=function(){var e=(0,c.useContext)(s.s),n=e.getData,a=e.dataToEdit,l=e.setDataToEdit,f=(e.deleteData,(0,c.useState)(!1)),m=(0,r.Z)(f,2),v=m[0],h=m[1],Z=(0,c.useState)(!1),x=(0,r.Z)(Z,2),j=x[0],y=x[1],w=(0,c.useState)({}),S=(0,r.Z)(w,2),T=S[0],A=S[1],C=(0,c.useState)(!1),D=(0,r.Z)(C,2),q=D[0],E=D[1],M=(0,c.useState)(""),N=(0,r.Z)(M,2),k=N[0],O=N[1],R=(0,c.useState)([]),P=(0,r.Z)(R,2),I=P[0],F=P[1],Y=function(){var e=(0,t.Z)((0,o.Z)().mark((function e(){var a,t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n("planilla/pagos/lista");case 2:(a=e.sent)&&(t=a.data.filter((function(e){return null!==e})),F(t),h(!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){Y()}),[]);var z=(0,d.Hg)((function(e){y(!0),A(e)}),(function(e){O(null===e||void 0===e?void 0:e.aprobacion),E(!0)}));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Z,{text:"Asociacion",ruta:"/planilla"}),(0,b.jsx)("div",{className:"margenes",children:(null===I||void 0===I?void 0:I.length)>0?(0,b.jsx)(_,{columns:z,table:I}):(0,b.jsx)(b.Fragment,{children:v?(0,b.jsx)(u.Z,{}):(0,b.jsx)(i.Z,{image:i.Z.PRESENTED_IMAGE_SIMPLE,description:(0,b.jsx)("span",{children:"No hay registros para mostrar."})})})}),j&&(0,b.jsx)(L,{asociacionTemp:T,actualizarTabla:Y,open:j,closeModal:function(){y(!1),l(null)},dataToEdit:a}),q&&(0,b.jsx)(g.Z,{setModal:E,modal:q,data:k,observacion:"",boton:!0})]})}},16026:function(e,n,a){a.d(n,{Bq:function(){return m},FH:function(){return t},FN:function(){return o},JL:function(){return r},LR:function(){return d},Md:function(){return u},Oj:function(){return i},TT:function(){return h},Tc:function(){return b},XK:function(){return _},bf:function(){return j},cB:function(){return Z},d_:function(){return l},eJ:function(){return s},eT:function(){return g},g5:function(){return c},kb:function(){return f},n4:function(){return x},s:function(){return p},v2:function(){return v}});var o={nombre:"",usuario:"",contrasenia:"",estado:""},t={nombre:""},r={nombre:"",direccion:""},i=function(){return{dni:"",codigo_trabajador:"",fecha_nacimiento:"",telefono:"",nombre:"",apellido_paterno:"",apellido_materno:"",email:"",estado_civil:"",genero:"",direccion:"",asociacion_id:null,eliminar:!1}},c=function(e){return{fecha_evaluacion:"",capacitacion_sso:"",capacitacion_gema:"",evaluacion_laboral:"",presion_arterial:"",temperatura:"",saturacion:"",imc:"",pulso:"",diabetes:"",antecedentes:"",emo:"",trabajador_id:e.dni,aprobado:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",fiscalizador:"",fiscalizador_aprobado:"no",control:"no",topico:"no",seguridad:"no",medio_ambiente:"no",recursos_humanos:"no",topico_observacion:"",control_observacion:"",seguridad_observacion:"",medio_ambiente_observacion:"",recursos_humanos_observacion:"",finalizado:!1,gerencia_id:"",area_id:"",puesto_id:"",campamento_id:""}},s=function(e,n){var a;return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",asociacion_id:e&&(null===e||void 0===e?void 0:e.id),estado:!1,evaluacion_id:n,trabajadores:null===e||void 0===e||null===(a=e.trabajador)||void 0===a?void 0:a.map((function(e){return e.dni})),tareo:""}},d=function(e){return{fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia:"",area:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto:"",estado:!1,empresa_id:e}},l=function(e){return{sucursal_id:e,fecha:"",movimiento:"",forma_pago:"",encargado:"",area:"",cantidad:"",medida:"",descripcion:"",monto:"",proveedor:"",comprobante:"",dni:"",sucursal_transferencia:"",precio:""}},u={nombre:""},p={nombre:"",codigo:"",descripcion:"",saldo_inicial:""},f={nombre:"",codigo:"",descripcion:""},m=function(e,n){return{codigo:parseInt(n)+1,nombre:"",codigo_interno:"",codigo_barras:"",descripcion:"",categoria_id:"",unidad_id:"",precio:"",fecha:"",observacion:"",almacen_id:"",stock:"0",costo_total:""}},v=function(e){return{codigo:"",motivo:"",fecha:"",encargado:"",codigo_compra:"",boleta:"",codigo_requerimiento:"",producto_id:"",categoria:"",cantidad:"",unidad:"",tipo:e,producto:"",almacen_id:"",codigo_pedido:"",costo:"",dni:"",costo_total:"",area_id:"",personal:"",retornable:""}},h=function(e,n){return{codigo:"",fecha_pedido:"",fecha_entrega:"",solicitante:"",area:"",celular:"",proyecto:"",producto_id:"",cantidad:"",unidad:"",estado:"",producto:"",personal:"",dni:""}},b=function(){return{id:"",nombre:"",contrato_id:"",observacion:"",unidad_produccion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajador_dni:""}},_=function(){return{id:"",unidad_produccion:"",observacion:"",fecha_pago:new Date,teletrans:"",tipo:"incentivo",trabajadores:[]}},g=function(){return{id:"",unidad_produccion:"",razon_social:"",contrato_id:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"casa"}},Z=function(){return{id:"",nombre:"",trabajador_dni:"",observacion:"",fecha_pago:new Date,hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:"",tipo:"extraordinario"}},x=function(){return{id:"",hora:new Date,placa:"",propietario:"",trapiche:"",volquetes:"",teletrans:""}},j=function(){return{id:"",unidad_produccion:"",observacion:"",fecha_pago:new Date,teletrans:"",volquetes:"",tipo:"asociacion",contrato_id:"",asociacion:[]}}}}]);
//# sourceMappingURL=1462.abd6fe1a.chunk.js.map