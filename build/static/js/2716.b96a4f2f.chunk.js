"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[2716],{24271:function(a,e,t){t.r(e),t.d(e,{default:function(){return S}});var n=t(74165),r=t(15861),s=t(29439),o=t(72791),i=t(38411),u=t(4942),c=t(1413),l=t(16026),d=t(69967),m=t(17615),f=t(87309),v=t(63998),p=t(99763),Z=t(78820),x=t(8034),g=t(80184),h=function(a){var e=a.actualizarTabla,t=m.Z.useForm(),h=(0,s.Z)(t,1)[0],j=(0,o.useContext)(i.s),b=(j.createData,j.updateData,j.modal),y=j.setModal,w=j.setDataToEdit,N=j.dataToEdit,F=j.getData,E=j.cargando,k=j.setCargando,C=(0,o.useState)(l.FN),D=(0,s.Z)(C,2),S=D[0],T=D[1],P=(0,o.useState)([]),_=(0,s.Z)(P,2),q=_[0],I=_[1],M=(0,o.useState)([]),z=(0,s.Z)(M,2),R=z[0],A=z[1],U=(0,o.useState)(null),O=(0,s.Z)(U,2),L=O[0],V=O[1],B=(0,o.useState)([]),J=(0,s.Z)(B,2),G=J[0],K=J[1],H=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(){var e,t,r,s;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,F("rol");case 2:return e=a.sent,a.next=5,F("cargo");case 5:return t=a.sent,a.next=8,F("sucursal");case 8:return r=a.sent,a.next=11,Promise.all([e,t,r]);case 11:s=a.sent,I(s[0].data),A(s[1].data),K(s[2].data);case 15:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();(0,o.useEffect)((function(){H()}),[]),(0,o.useEffect)((function(){if(N){var a=(0,c.Z)({},N);if(""!==a.caja&&null!==a.caja)try{a.caja=JSON.parse(a.caja)}catch(e){console.error("Error parsing caja: ",e)}else a.caja=[];T(a),h.setFieldsValue(a)}else T(l.FN)}),[N]);var Q=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(t){var r,s,o,i,u,c;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(null!==N){a.next=19;break}return k(!0),(r=new FormData).set("nombre",S.nombre||""),r.set("usuario",S.usuario||""),r.set("contrasenia",S.contrasenia||""),r.set("estado",S.estado||""),r.set("rol_id",S.rol_id||""),r.set("cargo_id",S.cargo_id||""),r.set("foto",S.foto||""),r.set("caja",JSON.stringify(S.caja)||""),(null===L||void 0===L?void 0:L.file)&&r.set("image",L.file||""),a.next=14,fetch("".concat("http://13.58.131.42:3000/api/v1","/usuario"),{method:"POST",body:r});case 14:return s=a.sent,a.next=17,s.json();case 17:(o=a.sent)&&((0,p.q)(o.status,o.msg),e(),W(),k(!1));case 19:if(!N){a.next=37;break}return(i=new FormData).set("nombre",S.nombre||""),i.set("usuario",S.usuario||""),i.set("contrasenia",S.contrasenia||""),i.set("estado",S.estado||""),i.set("rol_id",S.rol_id||""),i.set("cargo_id",S.cargo_id||""),i.set("foto",S.foto||""),i.set("caja",JSON.stringify(null===S||void 0===S?void 0:S.caja)||""),(null===L||void 0===L?void 0:L.file)&&i.set("image",L.file||""),a.next=32,fetch("".concat("http://13.58.131.42:3000/api/v1","/usuario/").concat(N.id),{method:"PUT",body:i});case 32:return u=a.sent,a.next=35,u.json();case 35:(c=a.sent)&&((0,p.q)(c.status,c.msg),e(),W(),k(!1));case 37:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();function W(){y(!1),w(null),T(l.FN),k(!1)}var X=(0,v.pc)(S,(function(a,e){if(!e&&a.target){var t=a.target,n=t.name,r=t.value;h.setFieldsValue((0,u.Z)({},n,r)),T((function(a){return(0,c.Z)((0,c.Z)({},a),{},(0,u.Z)({},n,r))}))}else h.setFieldsValue((0,u.Z)({},e,a)),T((function(t){return(0,c.Z)((0,c.Z)({},t),{},(0,u.Z)({},e,a))}))}),q,R,N,G);return(0,g.jsx)(d.Z,{className:"modal-usuario",title:N?"Editar usuario":"Registrar usuario",open:b,width:400,closeModal:W,children:(0,g.jsxs)(m.Z,{form:h,className:"modal-body",onFinish:Q,layout:"horizontal",children:[X.map((function(a,e){return(0,g.jsx)(m.Z.Item,{className:a.className,name:a.name,rules:a.rules,style:{marginBottom:"8px"},children:(0,g.jsxs)(g.Fragment,{children:[a.label,a.type]})},e)})),(0,g.jsx)("p",{children:"Firma"}),(0,g.jsx)("div",{className:"avatar",children:(0,g.jsx)(x.Z,{avatar:L,setAvatar:V,selected:N})}),(0,g.jsx)(m.Z.Item,{className:"button-container",children:(0,g.jsx)(f.ZP,{htmlType:"submit",icon:(0,g.jsx)(Z.lFz,{}),loading:!!E,children:N?" Editar":" Registrar"})})]})})},j=t(83188),b=t(4808),y=t(3066),w=t(53939),N=t(95579),F=t(85126),E=t(34664),k=t(76487),C=t(49389),D=function(a){var e=a.modal,t=a.setModal,l=m.Z.useForm(),v=(0,s.Z)(l,1)[0],x=(0,o.useContext)(i.s),h=x.dataToEdit,j=x.updateData,b=x.setDataToEdit,y=(0,o.useState)({nueva:"",nueva2:""}),w=(0,s.Z)(y,2),N=w[0],F=w[1],E=function(){t(!1),b(null)},k=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(){var e,t;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(N.nueva!==N.nueva2){a.next=9;break}return e={contrasenia:N.nueva},"usuario/contrasenia",a.next=5,j(e,h.id,"usuario/contrasenia");case 5:(t=a.sent)&&((0,p.q)(t.status,t.msg),E()),a.next=10;break;case 9:(0,p.q)(500,"Las contrase\xf1as no coinciden.");case 10:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),D=function(a){var e=a.target,t=e.name,n=e.value;v.setFieldsValue((0,u.Z)({},t,n)),F((function(a){return(0,c.Z)((0,c.Z)({},a),{},(0,u.Z)({},t,n))}))};return(0,g.jsx)(d.Z,{className:"modal-usuario",title:"Cambiar contrase\xf1a",open:e,width:400,closeModal:E,children:(0,g.jsxs)(m.Z,{form:v,className:"modal-body",onFinish:k,layout:"horizontal",children:[(0,g.jsxs)(m.Z.Item,{style:{marginBottom:"8px"},name:"nueva",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,g.jsx)("label",{htmlFor:"",children:"Nueva contrase\xf1a"}),(0,g.jsx)(C.Z.Password,{value:N.nueva,name:"nueva",onChange:D})]}),(0,g.jsxs)(m.Z.Item,{style:{marginBottom:"8px"},name:"nueva2",rules:[{required:!0,message:"Campo obligatorio!"}],children:[(0,g.jsx)("label",{htmlFor:"",children:"Confirme nueva contrase\xf1a"}),(0,g.jsx)(C.Z.Password,{value:N.nueva2,name:"nueva2",onChange:D})]}),(0,g.jsx)(m.Z.Item,{className:"button-container",children:(0,g.jsx)(f.ZP,{htmlType:"submit",icon:(0,g.jsx)(Z.lFz,{}),children:"Actualizar"})})]})})},S=function(){var a=(0,o.useContext)(i.s),e=a.getData,t=a.deleteData,u=a.modal,c=a.setModal,l=a.setDataToEdit,d=a.modal1,m=a.cargando,f=a.setCargando,v=(0,o.useState)([]),Z=(0,s.Z)(v,2),x=Z[0],C=Z[1],S=(0,N.Z)(x).result,T=(0,o.useState)(!1),P=(0,s.Z)(T,2),_=P[0],q=P[1],I=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(){var t;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return f(!0),a.next=3,e("usuario");case 3:(t=a.sent)&&(f(!1),C(t.data));case 5:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),M=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(e){var r;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t("usuario",e);case 2:(r=a.sent)&&((0,p.q)(r.status,r.msg),I());case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();(0,o.useEffect)((function(){I()}),[]);var z=(0,w.UR)((function(a){l(a),c(!0)}),M,(function(a){l(a),q(!0)}));return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(j.Z,{text:"Usuarios",user:"Usuario",ruta:"/administracion"}),(0,g.jsxs)("div",{className:"margenes",children:[(0,g.jsx)(y.Z,{abrirModal:c}),x.length>0?(0,g.jsx)(b.Z,{columns:z,table:S}):(0,g.jsx)("div",{className:"noData",children:m?(0,g.jsx)(k.Z,{}):(0,g.jsx)(E.Z,{image:E.Z.PRESENTED_IMAGE_SIMPLE,description:(0,g.jsx)("span",{children:"No hay registros para mostrar."})})})]}),_&&(0,g.jsx)(D,{modal:_,setModal:q}),u&&(0,g.jsx)(h,{actualizarTabla:I}),d&&(0,g.jsx)(F.Z,{actualizar:I})]})}},8034:function(a,e,t){var n=t(1413),r=t(72791),s=t(18267),o=(t(77457),t(80184));e.Z=function(a){var e=a.setAvatar,t=a.avatar,i=a.selected,u=(0,r.useCallback)((function(a){var t=a[0];e({file:t,preview:URL.createObjectURL(t)})}),[e]),c=(0,s.uI)({accept:{"image/png":[".png"],"image/jpg":[".jpg"],"image/jpeg":[".jpeg"]},noKeyboard:!0,onDrop:u}),l=c.getRootProps,d=c.getInputProps,m=c.isDragActive;return(0,o.jsxs)("div",(0,n.Z)((0,n.Z)({},l()),{},{className:"drag",children:[(0,o.jsx)("input",(0,n.Z)({},d())),m?(0,o.jsx)("p",{children:"Coloca la imagen aqui..."}):null!==i&&void 0!==i&&i.foto||null!==t&&void 0!==t&&t.preview?(0,o.jsx)("img",{src:(null===t||void 0===t?void 0:t.preview)||(null===i||void 0===i?void 0:i.foto),alt:""}):(0,o.jsx)("p",{children:"Arrastra la imagen aqui, o has click para seleccionar la imagen."})]}))}},77457:function(){}}]);
//# sourceMappingURL=2716.b96a4f2f.chunk.js.map