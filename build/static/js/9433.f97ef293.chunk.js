"use strict";(self.webpackChunkrinconada=self.webpackChunkrinconada||[]).push([[9433],{3396:function(a,t,e){e.r(t),e.d(t,{default:function(){return M}});var n=e(74165),r=e(15861),o=e(29439),i=e(72791),s=e(38411),c=e(83188),u=e(4808),l=e(22552),d=e(45180),f=e(4942),v=e(1413),p=e(69967),m=e(99763),Z=e(17615),x=e(87309),h=e(78820),j=e(63998),b=e(86281),g=(e(138),e(80184)),_=function(a){var t=a.actualizarTrabajadores,e=a.actualizarTabla,c=a.selected,u=a.trabajadorDni,l=a.data,d=Z.Z.useForm(),_=(0,o.Z)(d,1)[0],w="contrato",C=(0,i.useContext)(s.s),E=C.createData,T=C.updateData,S=C.getData,y=C.setDataToEdit,L=C.dataToEdit,M=C.modal3,D=C.setModal3,N=C.cargando,k=C.setCargando,z=(0,i.useState)([]),F=(0,o.Z)(z,2),I=F[0],q=F[1],P=(0,i.useState)([]),R=(0,o.Z)(P,2),B=R[0],V=R[1],A=(0,i.useState)([]),G=(0,o.Z)(A,2),H=G[0],O=G[1],U=(0,i.useState)([]),J=(0,o.Z)(U,2),K=J[0],Q=J[1],W=(0,i.useState)([]),X=(0,o.Z)(W,2),Y=(X[0],X[1],(0,i.useState)([])),$=(0,o.Z)(Y,2),aa=($[0],$[1]),ta=(0,i.useState)(""),ea=(0,o.Z)(ta,2),na=ea[0],ra=ea[1],oa=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(){var t,e,r,o,i,s,c;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=S("cargo"),e=S("campamento"),r=S("gerencia"),o=S("area"),i=S("socio"),s=S("contrato/last/".concat(u)),a.next=8,Promise.all([t,e,r,o,i,s]);case 8:c=a.sent,q(c[0].data),V(c[1].data),O(c[2].data),Q(c[3].data),aa(c[4].data),ra(c[5].data);case 15:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),ia={fecha_inicio:"",codigo_contrato:"",tipo_contrato:"",recomendado_por:"",cooperativa:"",condicion_cooperativa:"",periodo_trabajo:"",fecha_fin:"",gerencia_id:"",area_id:"",jefe_directo:"",base:"",termino_contrato:"",campamento_id:"",nota_contrato:"",puesto_id:"",estado:!1,volquete:"",teletran:"",suspendido:!1,finalizado:!1,tareo:"",trabajador_id:u},sa=(0,i.useState)(ia),ca=(0,o.Z)(sa,2),ua=ca[0],la=ca[1];(0,i.useEffect)((function(){null===L&&la((function(a){return(0,v.Z)((0,v.Z)({},a),{},{codigo_contrato:na})}))}),[na,L]),(0,i.useEffect)((function(){L?(la(L),_.setFieldsValue(L)):la(ia)}),[L]),(0,i.useEffect)((function(){null===L&&l.evaluacion.length>0&&la((function(a){return(0,v.Z)((0,v.Z)({},a),{},{gerencia_id:l.evaluacion.at(0).gerencia_id,area_id:l.evaluacion.at(0).area_id,puesto_id:l.evaluacion.at(0).puesto_id,campamento_id:l.evaluacion.at(0).campamento_id})}))}),[l,L]),(0,i.useEffect)((function(){oa()}),[]),(0,i.useEffect)((function(){if(""!==ua.fecha_inicio&&""!==ua.periodo_trabajo){var a=ua.fecha_inicio,t=(0,b.E)(a,ua.periodo_trabajo,ua.tareo);la((function(a){return(0,v.Z)((0,v.Z)({},a),{},{fecha_fin:t})}))}else la((function(a){return(0,v.Z)((0,v.Z)({},a),{},{fecha_fin:""})}))}),[ua.fecha_inicio,ua.periodo_trabajo,ua.tareo]);var da=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(){var r,o;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(null!==L){a.next=6;break}return k(!0),a.next=4,E(ua,w);case 4:(r=a.sent)&&((0,m.q)(r.status,r.msg),fa(),e(),t(),k(!1));case 6:if(!L){a.next=12;break}return k(!0),a.next=10,T(ua,c.id,w);case 10:(o=a.sent)&&((0,m.q)(o.status,o.msg),fa(),e(),t(),k(!1));case 12:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),fa=function(){D(!1),y(null),la(ia),k(!1)},va=(0,j.fp)(ua,(function(a,t){if(!t&&a.target){var e=a.target,n=e.name,r=e.value;_.setFieldsValue((0,f.Z)({},n,r)),la((function(a){return(0,v.Z)((0,v.Z)({},a),{},(0,f.Z)({},n,r))}))}else _.setFieldsValue((0,f.Z)({},t,a)),la((function(e){return(0,v.Z)((0,v.Z)({},e),{},(0,f.Z)({},t,a))}))}),I,B,H,K,na,L);return(0,g.jsx)(p.Z,{className:"modal-contrato-empresa",title:L?"Editar contrato":"Registrar contrato",open:M,width:920,closeModal:fa,children:(0,g.jsxs)(Z.Z,{form:_,className:"modal-body",onFinish:da,layout:"horizontal",children:[(0,g.jsx)("div",{className:"contrato",children:va.splice(0,13).map((function(a,t){return(0,g.jsx)(Z.Z.Item,{className:"item",name:a.name,rules:a.rules,style:{marginBottom:"8px"},children:(0,g.jsxs)(g.Fragment,{children:[a.label,a.type]})},t)}))}),(0,g.jsx)("div",{className:"finalizacion",children:va.map((function(a,t){return(0,g.jsx)(Z.Z.Item,{name:a.name,rules:a.rules,style:{marginBottom:"8px"},children:(0,g.jsxs)(g.Fragment,{children:[a.label,a.type]})},t)}))}),(0,g.jsx)(Z.Z.Item,{className:"button-container",children:(0,g.jsx)(x.ZP,{htmlType:"submit",icon:(0,g.jsx)(h.lFz,{}),loading:!!N,children:L?" Editar":" Registrar"})})]})})},w=e(53939),C=e(49389),E=(e(97434),C.Z.Search),T=function(a){var t=a.abrirModal,e=(a.registrar,a.data,a.setFilterText);return(0,g.jsxs)("div",{className:"personal-buscador",children:[(0,g.jsx)(E,{placeholder:"Ingresa un termino aqui...",onChange:function(a){return e(a.target.value)},style:{width:300}}),(0,g.jsx)("div",{className:"button-container",children:(0,g.jsx)(x.ZP,{onClick:function(){return t(!0)},children:"+ Registrar"})})]})},S=(e(95579),e(34664)),y=(e(81837),e(76487),function(a){var t=a.selected,e=a.actualizarTrabajadores,c=a.trabajador,l=a.data,d=(0,i.useContext)(s.s),f=d.getDataById,v=d.deleteData,Z=d.data1,x=d.setData1,h=d.setDataToEdit,j=d.modal2,b=d.setModal2,C=d.modal3,E=d.setModal3,y=(d.cargando,d.setCargando,(0,i.useState)([])),L=(0,o.Z)(y,2),M=L[0],D=L[1],N=(0,i.useState)(""),k=(0,o.Z)(N,2),z=k[0],F=k[1],I=(0,i.useState)(""),q=(0,o.Z)(I,2),P=q[0],R=q[1],B=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(){var e,r,o;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return"contrato",a.next=3,f("contrato",t);case 3:(e=a.sent)&&(o=null===(r=e.data)||void 0===r?void 0:r.map((function(a){return a.contratos})).flat(),x(o));case 5:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();(0,i.useEffect)((function(){var a=Z&&Z.filter((function(a){var t,e,n,r,o,i,s,c;return(null===a||void 0===a||null===(t=a.fecha_inicio)||void 0===t||null===(e=t.split("T")[0])||void 0===e||null===(n=e.toLowerCase())||void 0===n?void 0:n.includes(z.toLowerCase()))||(null===a||void 0===a||null===(r=a.fecha_fin)||void 0===r||null===(o=r.split("T")[0])||void 0===o||null===(i=o.toLowerCase())||void 0===i?void 0:i.includes(z.toLowerCase()))||(null===a||void 0===a||null===(s=a.tipo_contrato)||void 0===s||null===(c=s.toLowerCase())||void 0===c?void 0:c.includes(z.toLowerCase()))})).flat();D(a)}),[z,Z]);var V=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(t){var r;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v("contrato",t.id);case 2:(r=a.sent)&&((0,m.q)(r.status,r.msg),A(),e());case 4:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}(),A=function(){b(!1),x([])};(0,i.useEffect)((function(){B()}),[]);var G=(0,w.lc)((function(a){h(a),E(!0),R(a)}),V);return(0,g.jsxs)(p.Z,{className:"modal-historial-evaluacion",title:"Historial de contratos",open:j,width:900,closeModal:A,children:[(0,g.jsx)("section",{className:"buscador",children:(0,g.jsx)(T,{abrirModal:E,registrar:!0,tipo:"contrato",data:l,setFilterText:F})}),Z.length>0?(0,g.jsx)(u.Z,{columns:G,table:M}):(0,g.jsx)(S.Z,{image:S.Z.PRESENTED_IMAGE_SIMPLE,description:(0,g.jsx)("span",{children:"No hay registros para mostrar."})}),C&&(0,g.jsx)(_,{actualizarTabla:B,selected:P,trabajadorDni:l.dni,actualizarTrabajadores:e,trabajador:c,idContrato:Z,data:l})]})}),L=e(1333),M=function(){var a=(0,i.useContext)(s.s),t=a.getData,e=a.deleteData,f=(a.data,a.setData,a.updateData),v=a.setDataToEdit,p=(a.modal,a.setModal,a.modal1,a.setModal1,a.modal2),Z=a.setModal2,x=(a.cargando,a.setCargando,a.filterText),h=a.setFilterText,j=(0,i.useState)(""),b=(0,o.Z)(j,2),_=b[0],C=b[1],E=(0,i.useState)([]),T=(0,o.Z)(E,2),M=T[0],D=T[1],N=(0,i.useState)([]),k=(0,o.Z)(N,2),z=k[0],F=k[1],I=(0,i.useState)([]),q=(0,o.Z)(I,2),P=q[0],R=q[1],B=(0,i.useState)([]),V=(0,o.Z)(B,2),A=V[0],G=V[1],H=(0,i.useState)(!1),O=(0,o.Z)(H,2),U=O[0],J=O[1],K=(0,i.useState)(!1),Q=(0,o.Z)(K,2),W=Q[0],X=Q[1],Y=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(){var e;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t("trabajador");case 2:(e=a.sent)&&R(e.data);case 4:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),$=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(t){var r;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return"trabajador",a.next=3,e("trabajador",t);case 3:(r=a.sent)&&((0,m.q)(r.status,r.msg),Y());case 5:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}();(0,i.useEffect)((function(){var a=P&&P.filter((function(a){var t,e,n,r,o,i,s,c;return(null===a||void 0===a||null===(t=a.codigo_trabajador)||void 0===t||null===(e=t.toLowerCase())||void 0===e?void 0:e.includes(x.toLowerCase()))||(null===(n="".concat(null===a||void 0===a?void 0:a.nombre," ").concat(null===a||void 0===a?void 0:a.apellido_paterno," ").concat(null===a||void 0===a?void 0:a.apellido_materno))||void 0===n||null===(r=n.toLowerCase())||void 0===r?void 0:r.includes(x.toLowerCase()))||(null===a||void 0===a||null===(o=a.dni)||void 0===o||null===(i=o.toLowerCase())||void 0===i?void 0:i.includes(x.toLowerCase()))||(null===a||void 0===a||null===(s=a.campamento)||void 0===s||null===(c=s.toLowerCase())||void 0===c?void 0:c.includes(x.toLowerCase()))}));G(a)}),[x,P]),(0,i.useEffect)((function(){return function(){G([]),h("")}}),[]);var aa=function(){var a=(0,r.Z)((0,n.Z)().mark((function a(t){var e;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return"trabajador",a.next=3,f({deshabilitado:t.deshabilitado},t.dni,"trabajador");case 3:(e=a.sent)&&((0,m.q)(e.status,e.msg),Y());case 5:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}();(0,i.useEffect)((function(){Y()}),[]);var ta=(0,w.qC)((function(a){X(!0),C(a),D(a.evaluacion)}),(function(a){Z(!0),C(a.dni),F(a)}),aa,(function(a){v(a),J(!0)}),$);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.Z,{text:"Trabajadores",user:"Usuario",ruta:"/personal"}),(0,g.jsxs)("div",{className:"margenes",children:[(0,g.jsx)(l.Z,{abrirModal:J,importar:!0,registrar:!0,actualizarTrabajadores:Y,setFilterText:h}),(null===P||void 0===P?void 0:P.length)>0?(0,g.jsx)(u.Z,{columns:ta,table:A}):(0,g.jsx)(S.Z,{image:S.Z.PRESENTED_IMAGE_SIMPLE,description:(0,g.jsx)("span",{children:"No hay registros para mostrar."})})]}),U&&(0,g.jsx)(d.Z,{actualizarTabla:Y,data:P,modal:U,setModal:J}),W&&(0,g.jsx)(L.Z,{selected:_,actualizarTrabajador:Y,data:M,modal1:W,setModal1:X}),p&&(0,g.jsx)(y,{selected:_,actualizarTrabajadores:Y,data:z})]})}},95579:function(a,t,e){var n=e(72791),r=e(38411);t.Z=function(a){var t=(0,n.useContext)(r.s),e=t.filterText,o=(t.filterTextModal,t.result),i=t.setResult;return(0,n.useEffect)((function(){if(""!==e){var t=a.filter((function(a){return Object.values(a).join("").toLowerCase().includes(e.toLowerCase())}));i(t)}else i(a)}),[e,a]),{result:o}}}}]);
//# sourceMappingURL=9433.f97ef293.chunk.js.map